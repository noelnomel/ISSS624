<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-12-05">

<title>Noel’s ISSS624 Learning Journey - Take-home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Noel’s ISSS624 Learning Journey</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex01/Hands_on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex02/Hands_on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex03/Hands_on_Ex03.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In_class_Ex01/In_class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In_class_Ex02/In_class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In_class_Ex03/In_class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In_class_Ex04/In_class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In_class_Ex05/In_class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take_home_Ex/Take_home_Ex01/Take_home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_home_Ex/Take_home_Ex02/Take_home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">2. The Data</a>
  <ul class="collapse">
  <li><a href="#loading-relevant-r-packages" id="toc-loading-relevant-r-packages" class="nav-link" data-scroll-target="#loading-relevant-r-packages">2.1. Loading Relevant R Packages</a></li>
  <li><a href="#loading-and-checking-data-sets" id="toc-loading-and-checking-data-sets" class="nav-link" data-scroll-target="#loading-and-checking-data-sets">2.2. Loading and Checking Data Sets</a></li>
  <li><a href="#extract-study-data" id="toc-extract-study-data" class="nav-link" data-scroll-target="#extract-study-data">2.3. Extract Study Data</a></li>
  </ul></li>
  <li><a href="#create-hexagon-layer" id="toc-create-hexagon-layer" class="nav-link" data-scroll-target="#create-hexagon-layer">3. Create Hexagon Layer</a></li>
  <li><a href="#origin-destination-flow" id="toc-origin-destination-flow" class="nav-link" data-scroll-target="#origin-destination-flow">4. Origin-Destination Flow</a>
  <ul class="collapse">
  <li><a href="#create-origin-destination-matrix" id="toc-create-origin-destination-matrix" class="nav-link" data-scroll-target="#create-origin-destination-matrix">4.1. Create Origin-Destination Matrix</a></li>
  <li><a href="#visualising-origin-destination-flows" id="toc-visualising-origin-destination-flows" class="nav-link" data-scroll-target="#visualising-origin-destination-flows">4.2. Visualising Origin-Destination Flows</a></li>
  </ul></li>
  <li><a href="#prepare-inter-zone-flow-data-for-modelling" id="toc-prepare-inter-zone-flow-data-for-modelling" class="nav-link" data-scroll-target="#prepare-inter-zone-flow-data-for-modelling">5. Prepare Inter-zone Flow Data for Modelling</a>
  <ul class="collapse">
  <li><a href="#compute-distance-matrix" id="toc-compute-distance-matrix" class="nav-link" data-scroll-target="#compute-distance-matrix">5.1. Compute Distance Matrix</a></li>
  <li><a href="#preparing-propulsive-and-attractiveness-attributes" id="toc-preparing-propulsive-and-attractiveness-attributes" class="nav-link" data-scroll-target="#preparing-propulsive-and-attractiveness-attributes">5.2. Preparing Propulsive and Attractiveness Attributes</a>
  <ul class="collapse">
  <li><a href="#import-existing-data" id="toc-import-existing-data" class="nav-link" data-scroll-target="#import-existing-data">5.2.1. Import Existing Data</a></li>
  <li><a href="#geocode-hdb-information" id="toc-geocode-hdb-information" class="nav-link" data-scroll-target="#geocode-hdb-information">5.2.2. Geocode HDB Information</a></li>
  </ul></li>
  <li><a href="#creating-propulsiveness-origin-variables-by-origin-hexagon-grid" id="toc-creating-propulsiveness-origin-variables-by-origin-hexagon-grid" class="nav-link" data-scroll-target="#creating-propulsiveness-origin-variables-by-origin-hexagon-grid">5.3. Creating Propulsiveness (Origin) Variables by Origin Hexagon Grid</a>
  <ul class="collapse">
  <li><a href="#businesses-as-a-propulsiveness-variable" id="toc-businesses-as-a-propulsiveness-variable" class="nav-link" data-scroll-target="#businesses-as-a-propulsiveness-variable">5.3.1. Businesses as a Propulsiveness Variable</a></li>
  <li><a href="#financial-service-centres-as-a-propulsiveness-variable" id="toc-financial-service-centres-as-a-propulsiveness-variable" class="nav-link" data-scroll-target="#financial-service-centres-as-a-propulsiveness-variable">5.3.2. Financial Service Centres as a Propulsiveness Variable</a></li>
  <li><a href="#train-station-as-a-propulsiveness-variable" id="toc-train-station-as-a-propulsiveness-variable" class="nav-link" data-scroll-target="#train-station-as-a-propulsiveness-variable">5.3.3. Train Station as a Propulsiveness Variable</a></li>
  </ul></li>
  <li><a href="#creating-attractiveness-destination-variables-by-destination-hexagon-grid" id="toc-creating-attractiveness-destination-variables-by-destination-hexagon-grid" class="nav-link" data-scroll-target="#creating-attractiveness-destination-variables-by-destination-hexagon-grid">5.4. Creating Attractiveness (Destination) Variables by Destination Hexagon Grid</a>
  <ul class="collapse">
  <li><a href="#hdbs-as-an-attractiveness-variable" id="toc-hdbs-as-an-attractiveness-variable" class="nav-link" data-scroll-target="#hdbs-as-an-attractiveness-variable">5.4.1. HDBs as an Attractiveness Variable</a></li>
  <li><a href="#food-as-an-attractiveness-variable" id="toc-food-as-an-attractiveness-variable" class="nav-link" data-scroll-target="#food-as-an-attractiveness-variable">5.4.2. Food as an Attractiveness Variable</a></li>
  <li><a href="#leisure-as-an-attractiveness-variable" id="toc-leisure-as-an-attractiveness-variable" class="nav-link" data-scroll-target="#leisure-as-an-attractiveness-variable">5.4.3. Leisure as an Attractiveness Variable</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#spatial-interaction-models" id="toc-spatial-interaction-models" class="nav-link" data-scroll-target="#spatial-interaction-models">6. Spatial Interaction Models</a>
  <ul class="collapse">
  <li><a href="#r-squared-function" id="toc-r-squared-function" class="nav-link" data-scroll-target="#r-squared-function">6.1. R-squared Function</a></li>
  <li><a href="#unconstrained-spatial-interaction-model" id="toc-unconstrained-spatial-interaction-model" class="nav-link" data-scroll-target="#unconstrained-spatial-interaction-model">6.2. Unconstrained Spatial Interaction Model</a></li>
  <li><a href="#origin-constrained-sim" id="toc-origin-constrained-sim" class="nav-link" data-scroll-target="#origin-constrained-sim">6.3. Origin Constrained SIM</a></li>
  <li><a href="#destination-constrained" id="toc-destination-constrained" class="nav-link" data-scroll-target="#destination-constrained">6.4. Destination Constrained</a></li>
  <li><a href="#doubly-constrained" id="toc-doubly-constrained" class="nav-link" data-scroll-target="#doubly-constrained">6.5. Doubly Constrained</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">6.6. Model Comparison</a></li>
  <li><a href="#visuslising-fitted-values" id="toc-visuslising-fitted-values" class="nav-link" data-scroll-target="#visuslising-fitted-values">6.7. Visuslising Fitted Values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 5, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 17, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1. Overview</h1>
<p>In this take-home exercise, a case study using bus ridership in Singapore will be conducted to demonstrate the value of Geospatial Data Science and Analysis. Factors affecting urban mobility patterns of public bus transit will be determined through this analysis. To achieve this, publicly available data from different sources will be integrated to build spatial interaction models.</p>
</section>
<section id="the-data" class="level1">
<h1>2. The Data</h1>
<p>We will use the following data sets for this exercise:</p>
<table class="table">
<thead>
<tr class="header">
<th>S/N</th>
<th>Name of Data Set</th>
<th>File type</th>
<th>Source</th>
<th>Extracted to (file directory)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Master Plan 2019 Subzone Boundary (Web)</td>
<td>SHP</td>
<td><a href="https://data.gov.sg/">data.gov.sg</a></td>
<td>/data/geospatial</td>
</tr>
<tr class="even">
<td>2</td>
<td>HDB Property Information</td>
<td>CSV</td>
<td><a href="https://data.gov.sg/">data.gov.sg</a></td>
<td>/data/aspatial</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Bus Stop Location</td>
<td>SHP</td>
<td><a href="https://www.mytransport.sg/content/mytransport/home/dataMall.html">LTA DataMall</a></td>
<td>/data/geospatial</td>
</tr>
<tr class="even">
<td>4</td>
<td>Train Station Exit Point</td>
<td>SHP</td>
<td><a href="https://www.mytransport.sg/content/mytransport/home/dataMall.html">LTA DataMall</a></td>
<td>/data/geospatial</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Passenger Volume by Origin Destination Bus Stops (202310)</td>
<td>CSV</td>
<td><a href="https://www.mytransport.sg/content/mytransport/home/dataMall.html">LTA DataMall</a></td>
<td>/data/aspatial</td>
</tr>
<tr class="even">
<td>6</td>
<td>Businesses, financial services, food and beverage, and leisure and recreation</td>
<td>SHP</td>
<td>Assembled by Course Instructor</td>
<td>/data/geospatial</td>
</tr>
</tbody>
</table>
<section id="loading-relevant-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-relevant-r-packages">2.1. Loading Relevant R Packages</h2>
<p>We will first load the following packages into R using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sp, tmap, stplanr,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               tidyverse, reshape2,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               httr, performance, ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These packages will serve the following purpose:</p>
<ul>
<li><p><code>sf</code>: for geospatial data handling</p></li>
<li><p><code>sp</code>: classes and methods for spatial data</p></li>
<li><p><code>tmap</code>: for thematic mapping</p></li>
<li><p><code>stplanr</code>: for transport planning using spatial transport data</p></li>
<li><p><code>tidyverse</code>: for non-spatial data handling</p></li>
<li><p><code>reshape2</code>: for transforming data between wide and long formats</p></li>
<li><p><code>httr</code>: for working with URLs and HTTP</p></li>
<li><p><code>performance</code>: to compute model comparison matrices</p></li>
<li><p><code>ggpubr</code>: for creating statistical graphics</p></li>
</ul>
</section>
<section id="loading-and-checking-data-sets" class="level2">
<h2 class="anchored" data-anchor-id="loading-and-checking-data-sets">2.2. Loading and Checking Data Sets</h2>
<p>The first data set we will import is the <em>origin_destination_bus_202310</em> CSV data. We will import it into R as <code>odbus</code> using <code>read_csv()</code> from the <code>readr</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>odbus <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_bus_202310.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(odbus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,694,297
Columns: 7
$ YEAR_MONTH          &lt;chr&gt; "2023-10", "2023-10", "2023-10", "2023-10", "2023-…
$ DAY_TYPE            &lt;chr&gt; "WEEKENDS/HOLIDAY", "WEEKDAY", "WEEKENDS/HOLIDAY",…
$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 7, 14, 14, 10, 20, 20,…
$ PT_TYPE             &lt;chr&gt; "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "…
$ ORIGIN_PT_CODE      &lt;chr&gt; "04168", "04168", "80119", "80119", "44069", "2028…
$ DESTINATION_PT_CODE &lt;chr&gt; "10051", "10051", "90079", "90079", "17229", "2014…
$ TOTAL_TRIPS         &lt;dbl&gt; 3, 5, 3, 5, 4, 1, 24, 2, 1, 7, 3, 2, 5, 1, 1, 1, 1…</code></pre>
</div>
</div>
<p>It is observed that <code>ORIGIN_PT_CODE</code> and <code>DESTINATION_PT_CODE</code> are both recognised as integers. Since these are bus stop identifiers, they should be converted to factor type using <code>as.factor</code> from base R as shown in the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>odbus<span class="sc">$</span>ORIGIN_PT_CODE <span class="ot">&lt;-</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(odbus<span class="sc">$</span>ORIGIN_PT_CODE) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>odbus<span class="sc">$</span>DESTINATION_PT_CODE <span class="ot">&lt;-</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(odbus<span class="sc">$</span>DESTINATION_PT_CODE)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(odbus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,694,297
Columns: 7
$ YEAR_MONTH          &lt;chr&gt; "2023-10", "2023-10", "2023-10", "2023-10", "2023-…
$ DAY_TYPE            &lt;chr&gt; "WEEKENDS/HOLIDAY", "WEEKDAY", "WEEKENDS/HOLIDAY",…
$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 7, 14, 14, 10, 20, 20,…
$ PT_TYPE             &lt;chr&gt; "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "BUS", "…
$ ORIGIN_PT_CODE      &lt;fct&gt; 04168, 04168, 80119, 80119, 44069, 20281, 20281, 1…
$ DESTINATION_PT_CODE &lt;fct&gt; 10051, 10051, 90079, 90079, 17229, 20141, 20141, 1…
$ TOTAL_TRIPS         &lt;dbl&gt; 3, 5, 3, 5, 4, 1, 24, 2, 1, 7, 3, 2, 5, 1, 1, 1, 1…</code></pre>
</div>
</div>
<p>The second data set we will import is the <em>BusStop</em> SHP file. This file will be imported into R as <code>busstop</code> using the <code>st_read()</code> function from the <code>sf</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>busstop <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"BusStop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `C:\Users\noel1\Documents\School\02. Special Sem 1\ISSS624 Geospatial Analysis\noelnomel\ISSS624\Take_home_Ex\Take_home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5161 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(busstop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,161
Columns: 4
$ BUS_STOP_N &lt;chr&gt; "22069", "32071", "44331", "96081", "11561", "66191", "2338…
$ BUS_ROOF_N &lt;chr&gt; "B06", "B23", "B01", "B05", "B05", "B03", "B02A", "B02", "B…
$ LOC_DESC   &lt;chr&gt; "OPP CEVA LOGISTICS", "AFT TRACK 13", "BLK 239", "GRACE IND…
$ geometry   &lt;POINT [m]&gt; POINT (13576.31 32883.65), POINT (13228.59 44206.38),…</code></pre>
</div>
</div>
<p>Lastly, we will import the <em>Master Plan 2019 Subzone Boundary</em> SHP file. This file will be imported into R as <code>mpsz2019</code> using the <code>st_read()</code> function from the <code>sf</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mpsz2019 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `C:\Users\noel1\Documents\School\02. Special Sem 1\ISSS624 Geospatial Analysis\noelnomel\ISSS624\Take_home_Ex\Take_home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mpsz2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 332
Columns: 7
$ SUBZONE_N  &lt;chr&gt; "MARINA EAST", "INSTITUTION HILL", "ROBERTSON QUAY", "JURON…
$ SUBZONE_C  &lt;chr&gt; "MESZ01", "RVSZ05", "SRSZ01", "WISZ01", "MUSZ02", "MPSZ05",…
$ PLN_AREA_N &lt;chr&gt; "MARINA EAST", "RIVER VALLEY", "SINGAPORE RIVER", "WESTERN …
$ PLN_AREA_C &lt;chr&gt; "ME", "RV", "SR", "WI", "MU", "MP", "WI", "WI", "SI", "SI",…
$ REGION_N   &lt;chr&gt; "CENTRAL REGION", "CENTRAL REGION", "CENTRAL REGION", "WEST…
$ REGION_C   &lt;chr&gt; "CR", "CR", "CR", "WR", "CR", "CR", "WR", "WR", "CR", "CR",…
$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((33222.98 29..., MULTIPOLYGON (…</code></pre>
</div>
</div>
</section>
<section id="extract-study-data" class="level2">
<h2 class="anchored" data-anchor-id="extract-study-data">2.3. Extract Study Data</h2>
<p>For this exercise, we will explore the commuter flow on weekday afternoon peak (17:00 to 20:00 hrs) periods. Besides returning home at the end of the workday, commuters could travel out from their workplace in search of food, or leisure activities. First, we will extract trip details from the <code>odbus</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>od_WD_PM <span class="ot">&lt;-</span> odbus <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract all WEEKDAY data</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">'WEEKDAY'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract data between 17 and 20 hours</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">17</span> <span class="sc">&amp;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>          TIME_PER_HOUR <span class="sc">&lt;=</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group the number of trips by origin and destination</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_PT_CODE, DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sum the trips taken on weekdays between 17 and 20 hrs by origin and destination</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="create-hexagon-layer" class="level1">
<h1>3. Create Hexagon Layer</h1>
<p>Next, we will create a hexagon tessellation layer using <code>mpsz2019</code>. A hexagon layer is created to replace the irregular planning subzone polygons to reduce sampling bias. We will use the following code to generate the hexagon layer based on a perpendicular distance from the center of to edge of hexagon of 375m.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cell size = 2 x edge length (regular hexagons are made of equilateral triangles)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># apothem = perpendicular distance from center to any edge</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># edge length = (2 x apothem) / sqrt(3) </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cell size = (4 x apothem) / sqrt(3)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> (<span class="dv">4</span> <span class="sc">*</span> <span class="dv">375</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">3</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make hexagonal tesellation and add grid ID</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>mpsz2019_grid <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(mpsz2019, <span class="fu">c</span>(cs,cs), <span class="at">square =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>mpsz2019_grid<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mpsz2019_grid<span class="sc">$</span>id)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># determine centroid for each hexagon</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>cent <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(mpsz2019_grid)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># determine the intersection of centroids with mpsz2019</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>mpsz2019_map <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(cent, mpsz2019)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>cent_no_geom <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(mpsz2019_map)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># create hexagon layer, drop_na() to suppress cells outside the country</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>hexagon <span class="ot">&lt;-</span> <span class="fu">left_join</span>(mpsz2019_grid, cent_no_geom) <span class="sc">%&gt;%</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(hexagon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="origin-destination-flow" class="level1">
<h1>4. Origin-Destination Flow</h1>
<p>Next, we will examine the flow of commuters between origin hexagon grids to destination hexagon grids.</p>
<section id="create-origin-destination-matrix" class="level2">
<h2 class="anchored" data-anchor-id="create-origin-destination-matrix">4.1. Create Origin-Destination Matrix</h2>
<p>To examine the flow of commuters, we first compute a origin-destination matrix indicating the total number of trips taken from each origin-destination grid pair.</p>
<p>First, we will populate the hexagon grid id from the <code>hexagon</code> sf data.frame to <code>busstop</code> sf data.frame. The bus stop will be assigned the corresponding grid id in which it is found.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>bs_hexagon <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(busstop, hexagon) <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BUS_STOP_N, id) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>st_intersection()</code> is used to perform point (bus stop locations) and polygon (hexagon grid) overlay. The output is in point sf object, following the format of the busstop data.frame. As the polygon layer is created using <code>mpsz2019</code>, five bus stops are dropped as they are outside Singapore’s planning boundaries.</p>
<p>Next, we will bring in data on trips taken from the <code>od_WD_PM</code> data set by appending it to the bs_hexagon data.frame that includes bus stop number and the corresponding grid id the bus stop lies in. This step has to be done with the origin bus stop and the destination bus stop. First, we will join the two data sets by origin bus stop and we will use <code>glimpse</code> to check that the <code>left_join()</code> was done correctly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(od_WD_PM, bs_hexagon,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_PT_CODE"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_BS =</span> DESTINATION_PT_CODE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we will check for duplicates using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  ungroup</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,162
Columns: 4
$ ORIGIN_BS &lt;chr&gt; "11009", "11009", "11009", "11009", "11009", "11009", "11009…
$ DESTIN_BS &lt;fct&gt; 01411, 01411, 01421, 01421, 01521, 01521, 01611, 01611, 0162…
$ TRIPS     &lt;dbl&gt; 6, 6, 5, 5, 1, 1, 1, 1, 2, 2, 8, 8, 1, 1, 20, 20, 2, 2, 2, 2…
$ id        &lt;fct&gt; 1164, 1164, 1164, 1164, 1164, 1164, 1164, 1164, 1164, 1164, …</code></pre>
</div>
</div>
<p>It can be observed that there are 1,162 records of duplicates found in the data.frame. We will use the following code to retain only the unique records:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">unique</span>(od_data)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(od_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 264,203
Columns: 4
Groups: ORIGIN_BS [5,039]
$ ORIGIN_BS &lt;chr&gt; "01012", "01012", "01012", "01012", "01012", "01012", "01012…
$ DESTIN_BS &lt;fct&gt; 01112, 01113, 01121, 01211, 01311, 01549, 01559, 04142, 0737…
$ TRIPS     &lt;dbl&gt; 540, 516, 303, 363, 630, 6, 6, 1, 42, 48, 23, 260, 76, 34, 1…
$ id        &lt;fct&gt; 1571, 1571, 1571, 1571, 1571, 1571, 1571, 1571, 1571, 1571, …</code></pre>
</div>
</div>
<p>We can observe that the number of rows reduced by 581, which is half the number of duplicate records found.</p>
<p>Next, we join the two data sets together by destination bus stop:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(od_data, bs_hexagon,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DESTIN_BS"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, we will check for duplicates using the same code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  ungroup</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,502
Columns: 5
$ ORIGIN_BS &lt;chr&gt; "01013", "01013", "01112", "01112", "01112", "01112", "01112…
$ DESTIN_BS &lt;chr&gt; "51071", "51071", "51071", "51071", "53041", "53041", "82221…
$ TRIPS     &lt;dbl&gt; 3, 3, 26, 26, 128, 128, 2, 2, 3, 3, 1, 1, 11, 11, 1, 1, 6, 6…
$ id.x      &lt;fct&gt; 1571, 1571, 1595, 1595, 1595, 1595, 1595, 1595, 1595, 1595, …
$ id.y      &lt;fct&gt; 1454, 1454, 1454, 1454, 1455, 1455, 1836, 1836, 1454, 1454, …</code></pre>
</div>
</div>
<p>It can be observed that there are 1,502 records of duplicates found in the data.frame. We will use the following code to retain only the unique records:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">unique</span>(od_data)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(od_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 264,509
Columns: 5
Groups: ORIGIN_BS [5,039]
$ ORIGIN_BS &lt;chr&gt; "01012", "01012", "01012", "01012", "01012", "01012", "01012…
$ DESTIN_BS &lt;chr&gt; "01112", "01113", "01121", "01211", "01311", "01549", "01559…
$ TRIPS     &lt;dbl&gt; 540, 516, 303, 363, 630, 6, 6, 1, 42, 48, 23, 260, 76, 34, 1…
$ id.x      &lt;fct&gt; 1571, 1571, 1571, 1571, 1571, 1571, 1571, 1571, 1571, 1571, …
$ id.y      &lt;fct&gt; 1595, 1595, 1595, 1620, 1620, 1595, 1595, 1523, 1620, 1644, …</code></pre>
</div>
</div>
<p>We can observe that the number of rows reduced by 751, which is half the number of duplicate records found.</p>
<p>Next, we will create the origin-destination matrix (<code>od_matrix</code>) using the <code>od_data</code> obtained from the steps above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>od_matrix <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we rename id.x and id.y to make it more intuitive</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">origin_id =</span> id.x,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">destin_id =</span> id.y) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop bus stop with no trips recorded</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group the number of trips by origin and destination hexagon grids</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin_id, destin_id) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sum the trips taken by origin and destination</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">trips =</span> <span class="fu">sum</span>(TRIPS))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>od_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50,408 × 3
# Groups:   origin_id [636]
   origin_id destin_id trips
   &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;
 1 105       153           3
 2 105       179          34
 3 105       201         183
 4 105       229          18
 5 105       230           1
 6 105       253         145
 7 105       254           6
 8 131       230          16
 9 131       254         250
10 131       493          23
# ℹ 50,398 more rows</code></pre>
</div>
</div>
</section>
<section id="visualising-origin-destination-flows" class="level2">
<h2 class="anchored" data-anchor-id="visualising-origin-destination-flows">4.2. Visualising Origin-Destination Flows</h2>
<p>Next, we will visualise commuter flows at the analytical hexagon layer.</p>
<p>Firstly, We will exclude intra-zonal flows, or flows that originate and end in the same hexagon grid:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only take values where origin_id is not the same as destin_id</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>interzone_flow <span class="ot">&lt;-</span> od_matrix[od_matrix<span class="sc">$</span>origin_id <span class="sc">!=</span> od_matrix<span class="sc">$</span>destin_id,]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(interzone_flow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   origin_id [1]
  origin_id destin_id trips
  &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;
1 105       153           3
2 105       179          34
3 105       201         183
4 105       229          18
5 105       230           1
6 105       253         145</code></pre>
</div>
</div>
<p>Next, we will use <code>od2line()</code> from the <code>stplanr</code> package to create desire lines between the origin and destination points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>flow_line <span class="ot">&lt;-</span> <span class="fu">od2line</span>(<span class="at">flow =</span> interzone_flow ,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">zones =</span> hexagon,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">zone_code =</span> <span class="st">"id"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flow_line)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 3 fields
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: 3966.576 ymin: 28498.72 xmax: 6564.652 ymax: 35248.72
Projected CRS: SVY21 / Singapore TM
  origin_id destin_id trips                       geometry
1       105       153     3 LINESTRING (3966.576 28498....
2       105       179    34 LINESTRING (3966.576 28498....
3       105       201   183 LINESTRING (3966.576 28498....
4       105       229    18 LINESTRING (3966.576 28498....
5       105       230     1 LINESTRING (3966.576 28498....
6       105       253   145 LINESTRING (3966.576 28498....</code></pre>
</div>
</div>
<p>We can observe that <code>flow_line</code> is now sf data.frame containing linestring geometry type.</p>
<p>We use the following code to visualise the desire lines:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hexagon) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz2019) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>flow_line<span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"trips"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">10</span>),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Flow Lines of Bus Trips During Weekday PM Peak (Oct 2023)"</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>However, there is a large number of records found in <code>flow_line</code> (49,890), resulting in many overlapping lines on the map. This makes visualising the commuter flow difficult as patterns cannot be observed.</p>
<p>To discover patterns in the commuter flows, we will first focus on visualising flow lines different number of trips recorded:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flow_line<span class="sc">$</span>trips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    1.0    10.0    46.0   455.1   214.0 79210.0 </code></pre>
</div>
</div>
<p>From the summary above, it can be observed that the data is highly skewed as the highest observations are made on flow lines with lower number of trips recorded (from 1 to 10 trips, median is found at 46 trips) and less observations are made on flow lines with high number of trips recorded (from 214 to 79,210 trips).</p>
<p>We will create two additional layers to visualise the hexagon grids with origin bus stops and hexagon bus stops using the following codes below. These two layers will also be used in Section 5 to create propulsiveness and attractiveness attributes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>hex_ori <span class="ot">&lt;-</span> <span class="fu">right_join</span>(hexagon, interzone_flow,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"origin_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">origin_id =</span> id)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>hex_ori <span class="ot">&lt;-</span> <span class="fu">unique</span>(hex_ori)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>hex_des <span class="ot">&lt;-</span> interzone_flow <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>hex_des <span class="ot">&lt;-</span> <span class="fu">right_join</span>(hexagon, hex_des,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'id'</span> <span class="ot">=</span> <span class="st">'destin_id'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">destin_id =</span> id)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>hex_des <span class="ot">&lt;-</span> <span class="fu">unique</span>(hex_des)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, we will visualise the flow lines with 1 to 10 trips recorded:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot hexagon layer</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hexagon) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with origin bus stops in blue</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_ori) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with destination bus stops in red</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_des) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot mpsz2019 polygon outlines for easier reading of the map</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz2019) <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot flow lines</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>flow_line <span class="sc">%&gt;%</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># where trips are between 1 to 10</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trips <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> trips <span class="sc">&lt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"trips"</span>,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">10</span>),</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">'trips'</span>) <span class="sc">+</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Flow Lines of Bus Trips During Weekday PM Peak (Oct 2023) 1 to 10 trips"</span>,</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Focusing on flow lines with 1 to 10 trips recorded, not much pattern can be observed from the visualisation as most of the flow lines criss-cross or converge near each other in the southern-central region of Singapore. It appears that there is a lot of randomness in the travel patterns of flow lines with less trips recorded. Perhaps flow lines with low trip numbers recorded are due to trips taken for extra-ordinary reasons that are outside of an individual’s routine or habits.</p>
<p>Next, we will focus on flow lines with only singular trips recorded:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot hexagon layer</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hexagon) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with origin bus stops in blue</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_ori) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with destination bus stops in red</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_des) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot mpsz2019 polygon outlines for easier reading of the map</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz2019) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot flow lines</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>flow_line <span class="sc">%&gt;%</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># where trips are equal to 1</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trips <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"trips"</span>,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Flow Lines of Bus Trips During Weekday PM Peak (Oct 2023) 1 trip"</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can observe more clearly that flow lines with only one trip recorded tend to cross paths or converge at the southern-central region. Higher number of flows are observed between the western, eastern, and central regions of Singapore. Some flow lines are also observed in the outskirt regions of Singapore in Lim Chu Kang and Tuas.</p>
<p>Next, we will visualise flow lines with 11 to 46 trips recorded:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot hexagon layer</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hexagon) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with origin bus stops in blue</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_ori) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with destination bus stops in red</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_des) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot mpsz2019 polygon outlines for easier reading of the map</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz2019) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot flow lines</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>flow_line <span class="sc">%&gt;%</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># where trips are between 11 and 46</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trips <span class="sc">&gt;=</span> <span class="dv">11</span> <span class="sc">&amp;</span> trips <span class="sc">&lt;=</span> <span class="dv">46</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"trips"</span>,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">10</span>),</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"trips"</span>) <span class="sc">+</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Flow Lines of Bus Trips During Weekday PM Peak (Oct 2023) 11 to 46 trips"</span>,</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Next, we will visualise flow lines with 47 to 214 trips recorded:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot hexagon layer</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hexagon) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with origin bus stops in blue</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_ori) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with destination bus stops in red</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_des) <span class="sc">+</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot mpsz2019 polygon outlines for easier reading of the map</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz2019) <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot flow lines</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>flow_line <span class="sc">%&gt;%</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># where trips are between 47 and 214</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trips <span class="sc">&gt;=</span> <span class="dv">47</span> <span class="sc">&amp;</span> trips <span class="sc">&lt;=</span> <span class="dv">214</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"trips"</span>,</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">10</span>),</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"trips"</span>) <span class="sc">+</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Flow Lines of Bus Trips During Weekday PM Peak (Oct 2023) 47 to 214 trips"</span>,</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Not much commuter flow patterns can be deciphered from both visualisations of 10 to 46 trips and 46 to 214 trips. Many of the flow lines were overlapping around the southern-central region. However, some flows can be observed between the northern and central regions, eastern and central regions, and western to central regions of Singapore from both visualisations.</p>
<p>Lastly, we will visualise flow lines with more than 214 trips recorded:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot hexagon layer</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hexagon) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with origin bus stops in blue</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_ori) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot grids with destination bus stops in red</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hex_des) <span class="sc">+</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot mpsz2019 polygon outlines for easier reading of the map</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz2019) <span class="sc">+</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot flow lines</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>flow_line <span class="sc">%&gt;%</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># where trips are greater than 214</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trips <span class="sc">&gt;=</span> <span class="dv">215</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"trips"</span>,</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">15</span>),</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"trips"</span>) <span class="sc">+</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Flow Lines of Bus Trips During Weekday PM Peak (Oct 2023) &gt; 214 trips"</span>,</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">main.title.size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Clearer commuter patterns can be deciphered from this visualisation. It is observed that there are a few nodes where commuter flows converge at. Some of these nodes can be found at Woodlands, Punggol, Tampines, Paya Lebar, Clementi, Jurong East and Jurong West. Based on the map parameters, the largest trip numbers are scaled up by a factor of 15, and these are seen as thicker lines on the map. It can be observed that the thicker flow lines tend to be shorter trips that span the distance of about two to three grids. However, there are two longer-distance flow lines with high trip numbers that can be observed from the map, the first is flows between Woodlands and Punggol, and the second is flows between Punggol and Tampines.</p>
<p>Perhaps it is easier to find commuter patterns from this plot where larger trip numbers are recorded. Larger trip numbers could point to more routine trips taken by commuters where they travel between fixed origins and destinations, such as from their workplace to their home. On the other hand, patterns are harder to find in smaller trip numbers as these trips can happen for a bigger multitude of reasons, leading to more randomness in the travel pattern.</p>
</section>
</section>
<section id="prepare-inter-zone-flow-data-for-modelling" class="level1">
<h1>5. Prepare Inter-zone Flow Data for Modelling</h1>
<p>Next, we will prepare inter-zone data to be used for Spatial Interaction Models in section 6.</p>
<section id="compute-distance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="compute-distance-matrix">5.1. Compute Distance Matrix</h2>
<p>First, we will compute a distance matrix showing the distance between each hexagon grid to every other hexagon grid in the <code>hexagon</code> layer.</p>
<p>To do so, we firstly convert the <code>hexagon</code> layer from a sf tibble data frame to a SpatialPolygonsDataFrame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>hexagon_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(hexagon, <span class="st">"Spatial"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>hexagon_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 1214 
extent      : 2667.538, 56794.13, 16748.72, 49998.72  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 7
names       :   id, SUBZONE_N, SUBZONE_C, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C 
min values  : 1000, ADMIRALTY,    AMSZ01, ANG MO KIO,         AM, CENTRAL REGION,       CR 
max values  :  999,    YUNNAN,    YSSZ09,     YISHUN,         YS,    WEST REGION,       WR </code></pre>
</div>
</div>
<p>Next, we will use <code>spDists()</code> from the <code>sp</code> package to compute the Euclidean distance between centroids of each hexagon grid:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a matrix containing Euclidean distance between centroids of each hexagon grid</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">spDists</span>(hexagon_sp, <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>grid_id <span class="ot">&lt;-</span> hexagon<span class="sc">$</span>id</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># assign corresponding grid_id to each row and column </span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(grid_id)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(grid_id)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist, <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           53        54        55        56        78        79        80
53     0.0000 1500.0000 3000.0000 4500.0000  866.0254 2291.2878 3774.9172
54  1500.0000    0.0000 1500.0000 3000.0000  866.0254  866.0254 2291.2878
55  3000.0000 1500.0000    0.0000 1500.0000 2291.2878  866.0254  866.0254
56  4500.0000 3000.0000 1500.0000    0.0000 3774.9172 2291.2878  866.0254
78   866.0254  866.0254 2291.2878 3774.9172    0.0000 1500.0000 3000.0000
79  2291.2878  866.0254  866.0254 2291.2878 1500.0000    0.0000 1500.0000
80  3774.9172 2291.2878  866.0254  866.0254 3000.0000 1500.0000    0.0000
81  5267.8269 3774.9172 2291.2878  866.0254 4500.0000 3000.0000 1500.0000
101  866.0254 1732.0508 3122.4990 4582.5757  866.0254 2291.2878 3774.9172
102 1732.0508  866.0254 1732.0508 3122.4990  866.0254  866.0254 2291.2878
           81       101       102
53  5267.8269  866.0254 1732.0508
54  3774.9172 1732.0508  866.0254
55  2291.2878 3122.4990 1732.0508
56   866.0254 4582.5757 3122.4990
78  4500.0000  866.0254  866.0254
79  3000.0000 2291.2878  866.0254
80  1500.0000 3774.9172 2291.2878
81     0.0000 5267.8269 3774.9172
101 5267.8269    0.0000 1500.0000
102 3774.9172 1500.0000    0.0000</code></pre>
</div>
</div>
<p><code>longlat = FALSE</code> computes Euclidean distance, <code>TRUE</code> computes Great Circle distance.</p>
<p>We can observe that the intra-zonal distance is 0.</p>
<p>Next, we will pivot the wide <code>dist</code> matrix into a long table by using row and column grid_id:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist) <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> value,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">origin_id =</span> Var1,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">destin_id =</span> Var2)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to change id to factor as it is indicated as integers</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>dist_matrix<span class="sc">$</span>origin_id <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dist_matrix<span class="sc">$</span>origin_id)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>dist_matrix<span class="sc">$</span>destin_id <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dist_matrix<span class="sc">$</span>destin_id)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist_matrix, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   origin_id destin_id      dist
1         53        53    0.0000
2         54        53 1500.0000
3         55        53 3000.0000
4         56        53 4500.0000
5         78        53  866.0254
6         79        53 2291.2878
7         80        53 3774.9172
8         81        53 5267.8269
9        101        53  866.0254
10       102        53 1732.0508</code></pre>
</div>
</div>
<p>As we will be using log on distance in the Spatial Interaction Model, we have to replace the 0 values with a constant value. We can use the smallest distance as the constant value.</p>
<p>To do this, we will determine the minimum value of <code>dist</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   origin_id         destin_id            dist      
 53     :   1213   53     :   1213   Min.   :  866  
 54     :   1213   54     :   1213   1st Qu.: 9987  
 55     :   1213   55     :   1213   Median :16225  
 56     :   1213   56     :   1213   Mean   :17798  
 78     :   1213   78     :   1213   3rd Qu.:23922  
 79     :   1213   79     :   1213   Max.   :56980  
 (Other):1465304   (Other):1465304                  </code></pre>
</div>
</div>
<p>Next, we will add a constant value of 866m to all dist values with 0:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dist_matrix<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dist_matrix<span class="sc">$</span>dist <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">866</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                         dist_matrix<span class="sc">$</span>dist) </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dist_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   origin_id         destin_id            dist      
 53     :   1214   53     :   1214   Min.   :  866  
 54     :   1214   54     :   1214   1st Qu.: 9987  
 55     :   1214   55     :   1214   Median :16225  
 56     :   1214   56     :   1214   Mean   :17784  
 78     :   1214   78     :   1214   3rd Qu.:23922  
 79     :   1214   79     :   1214   Max.   :56980  
 (Other):1466512   (Other):1466512                  </code></pre>
</div>
</div>
<p>Lastly, we will add inter-zone distance to flow_line (includes only inter-zone flow lines) to create the <code>interzone_data</code> sf data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>interzone_data <span class="ot">&lt;-</span> flow_line <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dist_matrix, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"origin_id"</span> <span class="ot">=</span> <span class="st">"origin_id"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"destin_id"</span> <span class="ot">=</span> <span class="st">"destin_id"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-propulsive-and-attractiveness-attributes" class="level2">
<h2 class="anchored" data-anchor-id="preparing-propulsive-and-attractiveness-attributes">5.2. Preparing Propulsive and Attractiveness Attributes</h2>
<p>First, we identify the following propulsive and attractiveness attributes as factors affecting commute flows on weekend PM peak period:</p>
<p>Propulsive: 1. Business: as the origin of the PM peak travels where people leave their workplaces 2. Financial centres: as the origin of the PM peak travels where people leave their workplaces 3. Schools: as the origin of the PM peak travels where students leave their schools after completing school activities</p>
<p>Attractiveness: 1. F&amp;B: as the destination of PM peak travels where people look for dinner options 2. Leisure and recreation: as the destination of PM peak travels where people seek to relax after a day of work 3. HDB: as the destination of PM peak travels where people return home after work or school</p>
<section id="import-existing-data" class="level3">
<h3 class="anchored" data-anchor-id="import-existing-data">5.2.1. Import Existing Data</h3>
<p>Some of the geocoded data sets have been provided by the Course Instructor, and we will import them into the R environment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>business_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"Business"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Business' from data source 
  `C:\Users\noel1\Documents\School\02. Special Sem 1\ISSS624 Geospatial Analysis\noelnomel\ISSS624\Take_home_Ex\Take_home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 6550 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>finserv_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"FinServ"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `FinServ' from data source 
  `C:\Users\noel1\Documents\School\02. Special Sem 1\ISSS624 Geospatial Analysis\noelnomel\ISSS624\Take_home_Ex\Take_home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 3320 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4881.527 ymin: 25171.88 xmax: 46526.16 ymax: 49338.02
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fnb_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"F&amp;B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `F&amp;B' from data source 
  `C:\Users\noel1\Documents\School\02. Special Sem 1\ISSS624 Geospatial Analysis\noelnomel\ISSS624\Take_home_Ex\Take_home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1919 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25343.27 xmax: 45462.43 ymax: 48796.21
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>leisure_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"Liesure&amp;Recreation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Liesure&amp;Recreation' from data source 
  `C:\Users\noel1\Documents\School\02. Special Sem 1\ISSS624 Geospatial Analysis\noelnomel\ISSS624\Take_home_Ex\Take_home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1217 features and 30 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25134.28 xmax: 48439.77 ymax: 50078.88
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
<p>Next, we load the Train_Station_Exit SHP file downloaded from LTA DataMall into R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>train_exit_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"Train_Station_Exit_Layer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Train_Station_Exit_Layer' from data source 
  `C:\Users\noel1\Documents\School\02. Special Sem 1\ISSS624 Geospatial Analysis\noelnomel\ISSS624\Take_home_Ex\Take_home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 565 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92
Projected CRS: SVY21</code></pre>
</div>
</div>
</section>
<section id="geocode-hdb-information" class="level3">
<h3 class="anchored" data-anchor-id="geocode-hdb-information">5.2.2. Geocode HDB Information</h3>
<p>As the HDB property information CSV file downloaded from data.gov.sg includes only postal code and not geospatial data, we will use the Singapore Land Authority API to geocode the address of each HDB property.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://www.onemap.gov.sg/api/common/elastic/search"</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>csv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/hdb_2023.csv"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a list of all postal codes from schools.csv</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>address <span class="ot">&lt;-</span> <span class="fu">paste</span>(csv<span class="sc">$</span><span class="st">"blk_no"</span>, csv<span class="sc">$</span><span class="st">"street"</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>not_found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># pass list of address for geocoding</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(add <span class="cf">in</span> address){</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">'searchVal'</span> <span class="ot">=</span> add, <span class="st">'returnGeom'</span> <span class="ot">=</span> <span class="st">'Y'</span>, </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'getAddrDetails'</span> <span class="ot">=</span> <span class="st">'Y'</span>,<span class="st">'pageNum'</span> <span class="ot">=</span> <span class="st">'1'</span>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(url, <span class="at">query =</span> query)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((<span class="fu">content</span>(res)<span class="sc">$</span>found)<span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    found <span class="ot">&lt;-</span> <span class="fu">rbind</span>(found, <span class="fu">data.frame</span>(<span class="fu">content</span>(res))[<span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>])</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    not_found <span class="ot">=</span> <span class="fu">data.frame</span>(add)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(found)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(not_found)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Looking at <code>not_found</code>, we see that one address cannot be found through the API. To perform a manual update, we will first export the results as a CSV using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(found, <span class="at">file =</span> <span class="st">"data/aspatial/hdb_2023_found.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A quick check of the exported CSV file showed that some addresses were matched wrongly, and hence given the wrong coordinates. Together with the address that could not be found, these wrongly matched addresses are updated on Microsoft Excel and saved as <code>hdb_geocoded.csv</code> in the aspatial folder.</p>
<p>Now, we will import the updated <code>hdb_geocoded</code> CSV file into the R environment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>hdb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/hdb_2023_geocoded.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">latitude =</span> results.LATITUDE,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">longitude =</span> results.LONGITUDE,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">postal_code =</span> results.POSTAL) <span class="sc">%&gt;%</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keep only relevant columns in R</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(residential <span class="sc">==</span> <span class="st">"Y"</span>, commercial <span class="sc">==</span> <span class="st">"N"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total_dwelling_units, postal_code, latitude, longitude)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(hdb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 8,446
Columns: 4
$ total_dwelling_units &lt;dbl&gt; 206, 102, 96, 125, 247, 220, 219, 319, 204, 84, 1…
$ postal_code          &lt;chr&gt; "460001", "461001", "160001", "130001", "400001",…
$ latitude             &lt;dbl&gt; 1.320852, 1.327969, 1.292075, 1.302530, 1.320658,…
$ longitude            &lt;dbl&gt; 103.9337, 103.9227, 103.8286, 103.7833, 103.9025,…</code></pre>
</div>
</div>
<p>We will use total_dwelling_units as a proxy of the number of residents living in that housing block, which will later be aggregated at the hexagon level. First, based on data from the Department of Statistcis, the average household size among resident households is 3.09<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. We will use this to estimate the number of people living in each block:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>hdb<span class="sc">$</span>residents <span class="ot">&lt;-</span> <span class="fu">round</span>((hdb<span class="sc">$</span>total_dwelling_units <span class="sc">*</span> <span class="fl">3.09</span>),<span class="dv">0</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(hdb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 8,446
Columns: 5
$ total_dwelling_units &lt;dbl&gt; 206, 102, 96, 125, 247, 220, 219, 319, 204, 84, 1…
$ postal_code          &lt;chr&gt; "460001", "461001", "160001", "130001", "400001",…
$ latitude             &lt;dbl&gt; 1.320852, 1.327969, 1.292075, 1.302530, 1.320658,…
$ longitude            &lt;dbl&gt; 103.9337, 103.9227, 103.8286, 103.7833, 103.9025,…
$ residents            &lt;dbl&gt; 637, 315, 297, 386, 763, 680, 677, 986, 630, 260,…</code></pre>
</div>
</div>
<p>Next, we will convert it into a simple feature data.frame using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>hdb_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(hdb,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># crs = 4326 is code for wgs84 (longlat)</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geocoding returns wgs84 format and has to be transformed (metres, singapore)</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="creating-propulsiveness-origin-variables-by-origin-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="creating-propulsiveness-origin-variables-by-origin-hexagon-grid">5.3. Creating Propulsiveness (Origin) Variables by Origin Hexagon Grid</h2>
<section id="businesses-as-a-propulsiveness-variable" class="level3">
<h3 class="anchored" data-anchor-id="businesses-as-a-propulsiveness-variable">5.3.1. Businesses as a Propulsiveness Variable</h3>
<p>Using the <code>hex_ori</code> data frame created in Section 4, we will find the number of businesses that lie in the same grid where origin bus stops are found. As log will be used on the variables in the Spatial Interaction Model, we have to replace 0 values with a constant value that is close to 1 to generate a small result from log.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>hex_ori<span class="sc">$</span>ori_business <span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(hex_ori, business_sf))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>hex_ori<span class="sc">$</span>ori_business <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  hex_ori<span class="sc">$</span>ori_business <span class="sc">==</span> <span class="dv">0</span>, <span class="fl">0.99</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  hex_ori<span class="sc">$</span>ori_business)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_ori<span class="sc">$</span>ori_business)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.99    0.99    1.00   10.10   10.00  132.00 </code></pre>
</div>
</div>
</section>
<section id="financial-service-centres-as-a-propulsiveness-variable" class="level3">
<h3 class="anchored" data-anchor-id="financial-service-centres-as-a-propulsiveness-variable">5.3.2. Financial Service Centres as a Propulsiveness Variable</h3>
<p>We repeat the same steps for finance services:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>hex_ori<span class="sc">$</span>ori_finance <span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(hex_ori, finserv_sf))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>hex_ori<span class="sc">$</span>ori_finance <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  hex_ori<span class="sc">$</span>ori_finance <span class="sc">==</span> <span class="dv">0</span>, <span class="fl">0.99</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  hex_ori<span class="sc">$</span>ori_finance)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_ori<span class="sc">$</span>ori_finance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.990   0.990   1.000   5.532   5.000 119.000 </code></pre>
</div>
</div>
</section>
<section id="train-station-as-a-propulsiveness-variable" class="level3">
<h3 class="anchored" data-anchor-id="train-station-as-a-propulsiveness-variable">5.3.3. Train Station as a Propulsiveness Variable</h3>
<p>We repeat the same steps for train exits:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>hex_ori<span class="sc">$</span>ori_train <span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(hex_ori,train_exit_sf))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>hex_ori<span class="sc">$</span>ori_train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  hex_ori<span class="sc">$</span>ori_train <span class="sc">==</span> <span class="dv">0</span>, <span class="fl">0.99</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  hex_ori<span class="sc">$</span>ori_train)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_ori<span class="sc">$</span>ori_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.990   0.990   0.990   1.614   1.000  12.000 </code></pre>
</div>
</div>
<p>Next, we remove the geometry attributes to retain a data frame with origin grid id and the propulsiveness attributes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>hex_ori <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(hex_ori)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we create a data.frame containing <code>interzone_data</code> and the propulsivness variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> interzone_data <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hex_ori,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'origin_id'</span> <span class="ot">=</span> <span class="st">'origin_id'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="creating-attractiveness-destination-variables-by-destination-hexagon-grid" class="level2">
<h2 class="anchored" data-anchor-id="creating-attractiveness-destination-variables-by-destination-hexagon-grid">5.4. Creating Attractiveness (Destination) Variables by Destination Hexagon Grid</h2>
<section id="hdbs-as-an-attractiveness-variable" class="level3">
<h3 class="anchored" data-anchor-id="hdbs-as-an-attractiveness-variable">5.4.1. HDBs as an Attractiveness Variable</h3>
<p>Using the <code>hex_des</code> data frame created in Section 4, we will find the number of HDB blocks that lie in the same grid where destination bus stops are found. Usign estimated residents staying in each block as a proxy for population at each hexagonal grid, we sum the number of residents found in each HDB block to find the total residents at each hexagon grid:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>hdb_des <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(hex_des, hdb_sf) <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(destin_id, residents) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(destin_id) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">des_home =</span> <span class="fu">sum</span>(residents))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we join the estimated population to <code>hex_des</code> by the <code>destin_id</code> and replace NA values with 0.99 for use with log later on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>hex_des <span class="ot">&lt;-</span> hex_des <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hdb_des,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"destin_id"</span> <span class="ot">=</span> <span class="st">"destin_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="fl">0.99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="food-as-an-attractiveness-variable" class="level3">
<h3 class="anchored" data-anchor-id="food-as-an-attractiveness-variable">5.4.2. Food as an Attractiveness Variable</h3>
<p>We repeat the steps used in Section 5.3. to find the count of F&amp;B places that lie in the same grid as destination bus stops, and replace 0 values with 0.99 for use with log in the simulation.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>hex_des<span class="sc">$</span>des_food <span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(hex_des,fnb_sf))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>hex_des<span class="sc">$</span>des_food <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  hex_des<span class="sc">$</span>des_food <span class="sc">==</span> <span class="dv">0</span>, <span class="fl">0.99</span>,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  hex_des<span class="sc">$</span>des_food)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_des<span class="sc">$</span>des_food)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.990   0.990   0.990   3.582   1.000 127.000 </code></pre>
</div>
</div>
</section>
<section id="leisure-as-an-attractiveness-variable" class="level3">
<h3 class="anchored" data-anchor-id="leisure-as-an-attractiveness-variable">5.4.3. Leisure as an Attractiveness Variable</h3>
<p>We repeat the same steps for leisure places:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>hex_des<span class="sc">$</span>des_leisure <span class="ot">&lt;-</span> <span class="fu">lengths</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersects</span>(hex_des,leisure_sf))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>hex_des<span class="sc">$</span>des_leisure <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  hex_des<span class="sc">$</span>des_leisure <span class="sc">==</span> <span class="dv">0</span>, <span class="fl">0.99</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  hex_des<span class="sc">$</span>des_leisure)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex_des<span class="sc">$</span>des_leisure)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.990   0.990   0.990   2.221   2.000  43.000 </code></pre>
</div>
</div>
<p>Next, we remove the geometry attributes to retain a data frame with destination grid id and the attractiveness variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>hex_des <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(hex_des)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(hex_des)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 637
Columns: 4
$ destin_id   &lt;fct&gt; 105, 131, 153, 154, 155, 178, 179, 180, 181, 201, 202, 203…
$ des_home    &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99…
$ des_food    &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99…
$ des_leisure &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99…</code></pre>
</div>
</div>
<p>Lastly, we update the <code>SIM_data</code> with attractiveness variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hex_des,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'destin_id'</span> <span class="ot">=</span> <span class="st">'destin_id'</span>))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 49,890
Columns: 11
$ origin_id    &lt;fct&gt; 105, 105, 105, 105, 105, 105, 105, 131, 131, 131, 153, 15…
$ destin_id    &lt;fct&gt; 153, 179, 201, 229, 230, 253, 254, 230, 254, 493, 154, 17…
$ trips        &lt;dbl&gt; 3, 34, 183, 18, 1, 145, 6, 16, 250, 23, 83, 113, 16, 2, 3…
$ dist         &lt;dbl&gt; 866.0254, 2598.0762, 1732.0508, 5678.9083, 7088.7234, 653…
$ ori_business &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 34, 34, 34, 4, 4, 4, 4, 4, 4, 4, 4, …
$ ori_finance  &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.9…
$ ori_train    &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.9…
$ des_home     &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.9…
$ des_food     &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 2.0…
$ des_leisure  &lt;dbl&gt; 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 0.99, 7.0…
$ geometry     &lt;LINESTRING [m]&gt; LINESTRING (3966.576 28498...., LINESTRING (39…</code></pre>
</div>
</div>
<p>Finally, we run some checks to confirm that there are no NA values and duplicates in <code>SIM_data</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(SIM_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   origin_id    destin_id        trips         dist ori_business  ori_finance 
           0            0            0            0            0            0 
   ori_train     des_home     des_food  des_leisure     geometry 
           0            0            0            0            0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  ungroup</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(duplicates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 0
Columns: 11
$ origin_id    &lt;fct&gt; 
$ destin_id    &lt;fct&gt; 
$ trips        &lt;dbl&gt; 
$ dist         &lt;dbl&gt; 
$ ori_business &lt;dbl&gt; 
$ ori_finance  &lt;dbl&gt; 
$ ori_train    &lt;dbl&gt; 
$ des_home     &lt;dbl&gt; 
$ des_food     &lt;dbl&gt; 
$ des_leisure  &lt;dbl&gt; 
$ geometry     &lt;GEOMETRY [m]&gt; </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="spatial-interaction-models" class="level1">
<h1>6. Spatial Interaction Models</h1>
<p>For the last part of this exercise, we will calibrate Spatial Interaction Models (SIMs). We will use <code>SIM_data</code> to fit into the following four modelling techniques using the Poisson Regression method. Thereafter, we will determine the most suitable model.</p>
<ol type="1">
<li>Unconstrained</li>
<li>Production-constrained</li>
<li>Attraction-constrained</li>
<li>Doubly-constrained</li>
</ol>
<section id="r-squared-function" class="level2">
<h2 class="anchored" data-anchor-id="r-squared-function">6.1. R-squared Function</h2>
<p>Before we begin, we will write a function to calculate R-squared value to measure how much variation of the trips can be accounted by each model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>calc_Rsquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, estimated){</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed, estimated)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="unconstrained-spatial-interaction-model" class="level2">
<h2 class="anchored" data-anchor-id="unconstrained-spatial-interaction-model">6.2. Unconstrained Spatial Interaction Model</h2>
<p>In this section, we will calibrate an unconstrained spatial interaction model using the <code>glm()</code> function from Base Stats. The explanatory variables are businesses, finance services and train station exits at origin, F&amp;B places, leisure places, and public housing blocks at destination, and distance between origin and destination.</p>
<p>We will use the following code to calibrate the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> trips <span class="sc">~</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ori_business) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ori_finance) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ori_train) <span class="sc">+</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(des_food) <span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(des_leisure) <span class="sc">+</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(des_home) <span class="sc">+</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(uncSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = trips ~ log(ori_business) + log(ori_finance) + 
    log(ori_train) + log(des_food) + log(des_leisure) + log(des_home) + 
    log(dist), family = poisson(link = "log"), data = SIM_data, 
    na.action = na.exclude)

Coefficients:
                    Estimate Std. Error  z value Pr(&gt;|z|)    
(Intercept)        1.727e+01  2.129e-03  8110.30   &lt;2e-16 ***
log(ori_business) -4.572e-02  1.653e-04  -276.63   &lt;2e-16 ***
log(ori_finance)   2.922e-01  2.228e-04  1311.48   &lt;2e-16 ***
log(ori_train)     3.047e-01  3.565e-04   854.87   &lt;2e-16 ***
log(des_food)     -1.343e-02  2.480e-04   -54.15   &lt;2e-16 ***
log(des_leisure)  -2.734e-02  3.219e-04   -84.92   &lt;2e-16 ***
log(des_home)      1.619e-01  7.125e-05  2271.78   &lt;2e-16 ***
log(dist)         -1.592e+00  2.712e-04 -5870.40   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 88281028  on 49889  degrees of freedom
Residual deviance: 39811327  on 49882  degrees of freedom
AIC: 40096987

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Next, we will calculate the R-squared of the unconstrained SIM using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calc_Rsquared</span>(uncSIM<span class="sc">$</span>data<span class="sc">$</span>trips, uncSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3100363</code></pre>
</div>
</div>
<p>From the results above, we can observe that all variables included in the simulation are significant at alpha of 0.05. However, three of the variables (ori_business, des_food, des_leisure) have negative estimated values. Furthermore, from the R-squared function, we can see that the model accounts for only about 31% of of the variation of flows in the system.</p>
<p>We should explore other models to see if they can account for a higher percentage of variation of flows in the system.</p>
</section>
<section id="origin-constrained-sim" class="level2">
<h2 class="anchored" data-anchor-id="origin-constrained-sim">6.3. Origin Constrained SIM</h2>
<p>We will fit an origin constrained SIM by using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> trips <span class="sc">~</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                origin_id <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(des_food) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(des_leisure) <span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(des_home) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print=</span><span class="dv">999999</span>)</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = trips ~ origin_id + log(des_food) + log(des_leisure) + 
    log(des_home) + log(dist) - 1, family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                   Estimate Std. Error  z value Pr(&gt;|z|)    
origin_id105      1.613e+01  5.068e-02   318.21   &lt;2e-16 ***
origin_id131      1.821e+01  5.887e-02   309.32   &lt;2e-16 ***
origin_id153      1.752e+01  2.235e-02   784.12   &lt;2e-16 ***
origin_id154      1.751e+01  1.545e-02  1133.11   &lt;2e-16 ***
origin_id155      1.669e+01  2.189e-02   762.53   &lt;2e-16 ***
origin_id178      1.542e+01  5.816e-02   265.21   &lt;2e-16 ***
origin_id179      1.709e+01  1.602e-02  1066.41   &lt;2e-16 ***
origin_id180      1.668e+01  2.463e-02   677.07   &lt;2e-16 ***
origin_id181      1.785e+01  1.929e-02   925.47   &lt;2e-16 ***
origin_id201      1.793e+01  1.820e-02   985.28   &lt;2e-16 ***
origin_id202      1.690e+01  2.777e-02   608.71   &lt;2e-16 ***
origin_id203      1.767e+01  1.519e-02  1163.51   &lt;2e-16 ***
origin_id204      1.751e+01  1.258e-02  1391.53   &lt;2e-16 ***
origin_id205      1.700e+01  2.031e-02   837.12   &lt;2e-16 ***
origin_id226      1.732e+01  3.655e-02   473.86   &lt;2e-16 ***
origin_id227      1.693e+01  3.088e-02   548.24   &lt;2e-16 ***
origin_id228      1.607e+01  3.030e-02   530.34   &lt;2e-16 ***
origin_id229      1.720e+01  1.676e-02  1026.10   &lt;2e-16 ***
origin_id230      1.673e+01  1.714e-02   975.81   &lt;2e-16 ***
origin_id231      1.747e+01  2.524e-02   692.05   &lt;2e-16 ***
origin_id252      1.799e+01  1.449e-02  1241.39   &lt;2e-16 ***
origin_id253      1.743e+01  1.072e-02  1625.67   &lt;2e-16 ***
origin_id254      1.711e+01  1.363e-02  1254.89   &lt;2e-16 ***
origin_id275      1.642e+01  9.328e-02   176.04   &lt;2e-16 ***
origin_id277      1.733e+01  2.089e-02   829.74   &lt;2e-16 ***
origin_id278      1.734e+01  1.218e-02  1424.25   &lt;2e-16 ***
origin_id300      1.530e+01  4.810e-02   318.15   &lt;2e-16 ***
origin_id301      1.767e+01  1.047e-02  1687.87   &lt;2e-16 ***
origin_id302      1.608e+01  5.252e-02   306.17   &lt;2e-16 ***
origin_id324      1.779e+01  1.744e-02  1019.97   &lt;2e-16 ***
origin_id325      1.736e+01  1.102e-02  1575.58   &lt;2e-16 ***
origin_id326      1.672e+01  1.956e-02   854.77   &lt;2e-16 ***
origin_id347      1.866e+01  1.316e-02  1417.75   &lt;2e-16 ***
origin_id348      1.726e+01  1.360e-02  1268.90   &lt;2e-16 ***
origin_id349      1.745e+01  1.300e-02  1341.85   &lt;2e-16 ***
origin_id372      1.779e+01  1.178e-02  1510.15   &lt;2e-16 ***
origin_id373      1.651e+01  1.929e-02   856.15   &lt;2e-16 ***
origin_id395      1.635e+01  3.131e-02   522.14   &lt;2e-16 ***
origin_id396      1.705e+01  2.541e-02   670.97   &lt;2e-16 ***
origin_id397      1.470e+01  1.091e-01   134.67   &lt;2e-16 ***
origin_id419      1.853e+01  1.507e-02  1229.40   &lt;2e-16 ***
origin_id420      1.738e+01  1.347e-02  1290.21   &lt;2e-16 ***
origin_id421      1.782e+01  8.917e-03  1998.21   &lt;2e-16 ***
origin_id444      1.870e+01  1.194e-02  1565.80   &lt;2e-16 ***
origin_id445      1.882e+01  9.910e-03  1899.33   &lt;2e-16 ***
origin_id468      1.780e+01  1.168e-02  1523.42   &lt;2e-16 ***
origin_id469      1.743e+01  1.098e-02  1587.77   &lt;2e-16 ***
origin_id471      1.762e+01  1.110e-02  1586.99   &lt;2e-16 ***
origin_id491      1.746e+01  2.143e-02   814.48   &lt;2e-16 ***
origin_id492      1.838e+01  1.264e-02  1454.23   &lt;2e-16 ***
origin_id493      1.848e+01  4.831e-03  3824.74   &lt;2e-16 ***
origin_id494      1.890e+01  6.061e-03  3117.61   &lt;2e-16 ***
origin_id495      1.681e+01  2.005e-02   838.42   &lt;2e-16 ***
origin_id516      1.619e+01  2.233e-02   724.82   &lt;2e-16 ***
origin_id517      1.797e+01  8.188e-03  2194.52   &lt;2e-16 ***
origin_id519      1.876e+01  5.106e-03  3673.88   &lt;2e-16 ***
origin_id539      1.697e+01  3.249e-02   522.15   &lt;2e-16 ***
origin_id540      1.723e+01  1.454e-02  1184.54   &lt;2e-16 ***
origin_id541      1.720e+01  8.490e-03  2025.49   &lt;2e-16 ***
origin_id542      1.805e+01  5.801e-03  3110.84   &lt;2e-16 ***
origin_id543      1.791e+01  1.039e-02  1724.18   &lt;2e-16 ***
origin_id564      1.646e+01  2.735e-02   601.85   &lt;2e-16 ***
origin_id565      1.698e+01  1.365e-02  1244.04   &lt;2e-16 ***
origin_id566      1.645e+01  1.071e-02  1535.44   &lt;2e-16 ***
origin_id567      1.704e+01  1.041e-02  1636.45   &lt;2e-16 ***
origin_id568      1.526e+01  3.805e-02   401.05   &lt;2e-16 ***
origin_id588      1.848e+01  6.969e-03  2651.63   &lt;2e-16 ***
origin_id589      1.750e+01  7.766e-03  2253.91   &lt;2e-16 ***
origin_id590      1.778e+01  5.021e-03  3540.03   &lt;2e-16 ***
origin_id591      1.745e+01  9.026e-03  1933.01   &lt;2e-16 ***
origin_id592      1.751e+01  1.196e-02  1464.42   &lt;2e-16 ***
origin_id593      1.540e+01  4.926e-02   312.63   &lt;2e-16 ***
origin_id612      1.790e+01  1.145e-02  1563.40   &lt;2e-16 ***
origin_id613      1.733e+01  1.417e-02  1223.07   &lt;2e-16 ***
origin_id614      1.837e+01  4.049e-03  4537.19   &lt;2e-16 ***
origin_id615      1.774e+01  5.313e-03  3338.55   &lt;2e-16 ***
origin_id617      1.681e+01  1.567e-02  1072.71   &lt;2e-16 ***
origin_id618      1.285e+01  3.162e-01    40.62   &lt;2e-16 ***
origin_id619      1.535e+01  5.621e-02   273.05   &lt;2e-16 ***
origin_id620      1.787e+01  1.529e-02  1168.42   &lt;2e-16 ***
origin_id636      1.676e+01  1.867e-02   897.69   &lt;2e-16 ***
origin_id637      1.738e+01  1.244e-02  1397.79   &lt;2e-16 ***
origin_id638      1.965e+01  2.595e-03  7570.57   &lt;2e-16 ***
origin_id639      1.745e+01  6.746e-03  2585.97   &lt;2e-16 ***
origin_id640      1.370e+01  1.016e-01   134.91   &lt;2e-16 ***
origin_id642      1.548e+01  5.169e-02   299.43   &lt;2e-16 ***
origin_id643      1.300e+01  1.000e+00    13.00   &lt;2e-16 ***
origin_id644      1.673e+01  3.960e-02   422.40   &lt;2e-16 ***
origin_id661      1.763e+01  1.189e-02  1482.69   &lt;2e-16 ***
origin_id662      1.689e+01  6.835e-03  2470.79   &lt;2e-16 ***
origin_id663      1.764e+01  4.818e-03  3660.68   &lt;2e-16 ***
origin_id669      1.406e+01  1.644e-01    85.53   &lt;2e-16 ***
origin_id670      1.647e+01  3.738e-02   440.52   &lt;2e-16 ***
origin_id684      1.674e+01  1.367e-02  1224.70   &lt;2e-16 ***
origin_id685      1.759e+01  7.247e-03  2427.27   &lt;2e-16 ***
origin_id686      1.672e+01  6.832e-03  2447.37   &lt;2e-16 ***
origin_id688      1.218e+01  2.000e-01    60.90   &lt;2e-16 ***
origin_id693      1.598e+01  4.944e-02   323.34   &lt;2e-16 ***
origin_id710      1.658e+01  9.513e-03  1743.11   &lt;2e-16 ***
origin_id711      1.785e+01  4.713e-03  3786.83   &lt;2e-16 ***
origin_id713      1.763e+01  1.036e-02  1701.97   &lt;2e-16 ***
origin_id732      1.800e+01  6.881e-03  2615.74   &lt;2e-16 ***
origin_id733      1.734e+01  6.379e-03  2718.95   &lt;2e-16 ***
origin_id734      1.878e+01  3.206e-03  5859.86   &lt;2e-16 ***
origin_id735      1.678e+01  1.195e-02  1404.73   &lt;2e-16 ***
origin_id756      1.765e+01  1.164e-02  1516.01   &lt;2e-16 ***
origin_id757      1.604e+01  1.245e-02  1287.50   &lt;2e-16 ***
origin_id758      1.751e+01  5.416e-03  3233.73   &lt;2e-16 ***
origin_id759      1.800e+01  4.028e-03  4469.47   &lt;2e-16 ***
origin_id761      1.781e+01  8.825e-03  2018.07   &lt;2e-16 ***
origin_id780      1.635e+01  1.581e-02  1034.41   &lt;2e-16 ***
origin_id781      1.764e+01  5.606e-03  3147.44   &lt;2e-16 ***
origin_id782      1.573e+01  1.307e-02  1203.35   &lt;2e-16 ***
origin_id783      1.589e+01  1.920e-02   827.43   &lt;2e-16 ***
origin_id804      1.765e+01  9.706e-03  1818.55   &lt;2e-16 ***
origin_id807      1.760e+01  4.997e-03  3522.60   &lt;2e-16 ***
origin_id809      1.518e+01  2.753e-02   551.36   &lt;2e-16 ***
origin_id828      1.778e+01  7.543e-03  2356.69   &lt;2e-16 ***
origin_id830      1.771e+01  4.397e-03  4027.73   &lt;2e-16 ***
origin_id831      1.694e+01  8.697e-03  1948.39   &lt;2e-16 ***
origin_id837      1.550e+01  4.293e-02   361.15   &lt;2e-16 ***
origin_id852      1.712e+01  1.302e-02  1314.63   &lt;2e-16 ***
origin_id853      1.768e+01  6.845e-03  2582.61   &lt;2e-16 ***
origin_id854      1.866e+01  3.261e-03  5720.64   &lt;2e-16 ***
origin_id855      1.695e+01  6.235e-03  2718.34   &lt;2e-16 ***
origin_id856      1.687e+01  8.938e-03  1887.49   &lt;2e-16 ***
origin_id857      1.803e+01  5.174e-03  3484.38   &lt;2e-16 ***
origin_id858      1.587e+01  2.013e-02   788.32   &lt;2e-16 ***
origin_id875      1.521e+01  4.009e-02   379.35   &lt;2e-16 ***
origin_id877      1.604e+01  1.006e-02  1595.30   &lt;2e-16 ***
origin_id878      1.720e+01  5.646e-03  3046.99   &lt;2e-16 ***
origin_id879      1.734e+01  6.454e-03  2686.42   &lt;2e-16 ***
origin_id880      1.427e+01  3.160e-02   451.46   &lt;2e-16 ***
origin_id881      1.920e+01  2.910e-03  6595.71   &lt;2e-16 ***
origin_id882      1.724e+01  7.764e-03  2220.07   &lt;2e-16 ***
origin_id885      1.609e+01  2.569e-02   626.45   &lt;2e-16 ***
origin_id901      1.762e+01  5.390e-03  3268.49   &lt;2e-16 ***
origin_id902      1.810e+01  4.217e-03  4291.93   &lt;2e-16 ***
origin_id903      1.753e+01  4.590e-03  3819.20   &lt;2e-16 ***
origin_id904      1.691e+01  7.000e-03  2415.95   &lt;2e-16 ***
origin_id905      1.731e+01  6.133e-03  2822.17   &lt;2e-16 ***
origin_id906      1.686e+01  8.353e-03  2017.88   &lt;2e-16 ***
origin_id907      1.705e+01  9.331e-03  1827.13   &lt;2e-16 ***
origin_id909      1.589e+01  2.526e-02   629.00   &lt;2e-16 ***
origin_id923      1.816e+01  8.457e-03  2147.12   &lt;2e-16 ***
origin_id924      1.780e+01  6.014e-03  2959.89   &lt;2e-16 ***
origin_id925      1.786e+01  5.196e-03  3437.16   &lt;2e-16 ***
origin_id926      1.619e+01  1.061e-02  1525.76   &lt;2e-16 ***
origin_id927      1.742e+01  4.821e-03  3612.61   &lt;2e-16 ***
origin_id928      1.688e+01  6.580e-03  2565.29   &lt;2e-16 ***
origin_id929      1.693e+01  6.451e-03  2624.77   &lt;2e-16 ***
origin_id930      1.876e+01  3.939e-03  4763.47   &lt;2e-16 ***
origin_id931      1.490e+01  3.801e-02   391.86   &lt;2e-16 ***
origin_id932      1.664e+01  1.658e-02  1003.75   &lt;2e-16 ***
origin_id933      1.663e+01  1.786e-02   931.15   &lt;2e-16 ***
origin_id948      1.667e+01  1.641e-02  1015.97   &lt;2e-16 ***
origin_id949      1.658e+01  1.051e-02  1577.28   &lt;2e-16 ***
origin_id950      1.844e+01  5.781e-03  3190.23   &lt;2e-16 ***
origin_id951      1.843e+01  3.334e-03  5528.69   &lt;2e-16 ***
origin_id952      1.826e+01  4.564e-03  4001.94   &lt;2e-16 ***
origin_id953      1.705e+01  5.992e-03  2845.86   &lt;2e-16 ***
origin_id954      1.584e+01  1.234e-02  1283.62   &lt;2e-16 ***
origin_id955      1.745e+01  7.047e-03  2475.85   &lt;2e-16 ***
origin_id956      1.637e+01  1.534e-02  1067.60   &lt;2e-16 ***
origin_id957      1.645e+01  1.765e-02   931.91   &lt;2e-16 ***
origin_id972      1.698e+01  6.925e-03  2452.21   &lt;2e-16 ***
origin_id973      1.702e+01  7.305e-03  2330.05   &lt;2e-16 ***
origin_id974      1.800e+01  4.646e-03  3873.37   &lt;2e-16 ***
origin_id975      1.610e+01  1.055e-02  1525.75   &lt;2e-16 ***
origin_id976      1.647e+01  1.752e-02   939.70   &lt;2e-16 ***
origin_id977      1.752e+01  4.845e-03  3616.34   &lt;2e-16 ***
origin_id978      1.581e+01  1.645e-02   960.97   &lt;2e-16 ***
origin_id979      1.818e+01  5.748e-03  3163.64   &lt;2e-16 ***
origin_id980      1.789e+01  7.110e-03  2515.90   &lt;2e-16 ***
origin_id981      1.728e+01  1.436e-02  1203.60   &lt;2e-16 ***
origin_id996      1.765e+01  5.411e-03  3262.20   &lt;2e-16 ***
origin_id997      1.703e+01  7.162e-03  2377.92   &lt;2e-16 ***
origin_id998      1.773e+01  5.601e-03  3166.20   &lt;2e-16 ***
origin_id999      1.680e+01  7.144e-03  2351.43   &lt;2e-16 ***
origin_id1000     1.593e+01  1.373e-02  1160.57   &lt;2e-16 ***
origin_id1001     1.886e+01  3.078e-03  6124.97   &lt;2e-16 ***
origin_id1002     1.697e+01  8.759e-03  1937.58   &lt;2e-16 ***
origin_id1005     1.574e+01  3.133e-02   502.61   &lt;2e-16 ***
origin_id1019     1.825e+01  4.896e-03  3726.49   &lt;2e-16 ***
origin_id1020     1.922e+01  2.804e-03  6856.49   &lt;2e-16 ***
origin_id1021     1.731e+01  8.776e-03  1972.35   &lt;2e-16 ***
origin_id1022     1.601e+01  1.402e-02  1141.63   &lt;2e-16 ***
origin_id1023     1.682e+01  7.567e-03  2223.00   &lt;2e-16 ***
origin_id1024     1.622e+01  1.033e-02  1569.08   &lt;2e-16 ***
origin_id1025     1.795e+01  4.109e-03  4368.10   &lt;2e-16 ***
origin_id1027     1.686e+01  1.981e-02   850.90   &lt;2e-16 ***
origin_id1028     1.922e+01  4.600e-03  4177.41   &lt;2e-16 ***
origin_id1029     1.736e+01  1.326e-02  1309.44   &lt;2e-16 ***
origin_id1043     1.794e+01  5.196e-03  3452.55   &lt;2e-16 ***
origin_id1044     1.779e+01  4.352e-03  4088.59   &lt;2e-16 ***
origin_id1045     1.677e+01  7.523e-03  2228.97   &lt;2e-16 ***
origin_id1046     1.611e+01  1.697e-02   949.51   &lt;2e-16 ***
origin_id1047     1.633e+01  9.416e-03  1734.43   &lt;2e-16 ***
origin_id1048     1.783e+01  5.231e-03  3408.64   &lt;2e-16 ***
origin_id1049     1.745e+01  5.455e-03  3198.75   &lt;2e-16 ***
origin_id1050     1.742e+01  7.202e-03  2419.22   &lt;2e-16 ***
origin_id1053     1.667e+01  9.398e-03  1773.19   &lt;2e-16 ***
origin_id1054     1.881e+01  3.926e-03  4792.07   &lt;2e-16 ***
origin_id1066     1.775e+01  6.664e-03  2664.39   &lt;2e-16 ***
origin_id1067     1.830e+01  4.639e-03  3944.71   &lt;2e-16 ***
origin_id1068     1.620e+01  8.996e-03  1801.31   &lt;2e-16 ***
origin_id1069     1.839e+01  4.066e-03  4523.97   &lt;2e-16 ***
origin_id1070     1.857e+01  3.951e-03  4698.85   &lt;2e-16 ***
origin_id1072     1.680e+01  1.045e-02  1607.69   &lt;2e-16 ***
origin_id1073     1.723e+01  7.379e-03  2335.06   &lt;2e-16 ***
origin_id1075     1.649e+01  2.031e-02   812.08   &lt;2e-16 ***
origin_id1076     1.680e+01  1.570e-02  1070.16   &lt;2e-16 ***
origin_id1077     1.740e+01  6.178e-03  2817.23   &lt;2e-16 ***
origin_id1091     1.639e+01  2.091e-02   783.85   &lt;2e-16 ***
origin_id1092     1.757e+01  5.818e-03  3019.96   &lt;2e-16 ***
origin_id1093     1.626e+01  1.051e-02  1547.36   &lt;2e-16 ***
origin_id1094     1.776e+01  5.066e-03  3504.80   &lt;2e-16 ***
origin_id1097     1.772e+01  5.669e-03  3126.28   &lt;2e-16 ***
origin_id1101     1.841e+01  4.008e-03  4593.67   &lt;2e-16 ***
origin_id1102     1.790e+01  5.304e-03  3374.95   &lt;2e-16 ***
origin_id1114     1.808e+01  5.480e-03  3299.90   &lt;2e-16 ***
origin_id1115     1.791e+01  4.888e-03  3665.24   &lt;2e-16 ***
origin_id1116     1.764e+01  6.590e-03  2677.03   &lt;2e-16 ***
origin_id1117     1.671e+01  9.428e-03  1772.22   &lt;2e-16 ***
origin_id1118     1.620e+01  1.156e-02  1402.24   &lt;2e-16 ***
origin_id1123     1.763e+01  1.100e-02  1602.81   &lt;2e-16 ***
origin_id1125     1.732e+01  5.866e-03  2953.07   &lt;2e-16 ***
origin_id1126     1.490e+01  3.032e-02   491.27   &lt;2e-16 ***
origin_id1138     1.793e+01  5.923e-03  3026.58   &lt;2e-16 ***
origin_id1139     1.809e+01  4.601e-03  3931.85   &lt;2e-16 ***
origin_id1140     1.734e+01  6.472e-03  2679.14   &lt;2e-16 ***
origin_id1141     1.619e+01  1.215e-02  1331.85   &lt;2e-16 ***
origin_id1142     1.776e+01  5.364e-03  3309.81   &lt;2e-16 ***
origin_id1149     1.645e+01  1.015e-02  1620.05   &lt;2e-16 ***
origin_id1150     1.682e+01  9.055e-03  1857.71   &lt;2e-16 ***
origin_id1161     1.703e+01  9.630e-03  1768.21   &lt;2e-16 ***
origin_id1162     1.815e+01  6.979e-03  2600.77   &lt;2e-16 ***
origin_id1163     1.618e+01  1.010e-02  1601.74   &lt;2e-16 ***
origin_id1164     1.652e+01  9.028e-03  1830.36   &lt;2e-16 ***
origin_id1171     1.303e+01  1.543e-01    84.41   &lt;2e-16 ***
origin_id1172     1.392e+01  5.525e-02   251.90   &lt;2e-16 ***
origin_id1173     1.988e+01  2.527e-03  7865.43   &lt;2e-16 ***
origin_id1174     1.724e+01  1.051e-02  1639.96   &lt;2e-16 ***
origin_id1187     1.707e+01  8.840e-03  1930.98   &lt;2e-16 ***
origin_id1188     1.785e+01  4.228e-03  4221.21   &lt;2e-16 ***
origin_id1189     1.590e+01  1.487e-02  1069.90   &lt;2e-16 ***
origin_id1190     1.631e+01  1.105e-02  1475.46   &lt;2e-16 ***
origin_id1195     1.847e+01  8.998e-03  2052.86   &lt;2e-16 ***
origin_id1197     1.786e+01  6.058e-03  2948.44   &lt;2e-16 ***
origin_id1198     1.761e+01  5.499e-03  3202.07   &lt;2e-16 ***
origin_id1199     1.731e+01  1.813e-02   954.45   &lt;2e-16 ***
origin_id1209     1.816e+01  4.978e-03  3649.00   &lt;2e-16 ***
origin_id1210     1.620e+01  2.247e-02   720.95   &lt;2e-16 ***
origin_id1211     1.772e+01  4.614e-03  3840.50   &lt;2e-16 ***
origin_id1212     1.699e+01  6.741e-03  2520.48   &lt;2e-16 ***
origin_id1213     1.728e+01  6.412e-03  2694.68   &lt;2e-16 ***
origin_id1220     1.479e+01  3.591e-02   411.95   &lt;2e-16 ***
origin_id1221     1.732e+01  5.566e-03  3112.05   &lt;2e-16 ***
origin_id1222     1.777e+01  5.216e-03  3406.69   &lt;2e-16 ***
origin_id1234     1.606e+01  1.026e-02  1566.10   &lt;2e-16 ***
origin_id1235     1.582e+01  1.076e-02  1469.96   &lt;2e-16 ***
origin_id1236     1.634e+01  8.498e-03  1922.61   &lt;2e-16 ***
origin_id1244     1.643e+01  2.098e-02   783.04   &lt;2e-16 ***
origin_id1245     1.727e+01  7.444e-03  2320.52   &lt;2e-16 ***
origin_id1246     1.849e+01  3.595e-03  5143.14   &lt;2e-16 ***
origin_id1247     1.817e+01  5.426e-03  3348.46   &lt;2e-16 ***
origin_id1257     1.832e+01  3.993e-03  4587.67   &lt;2e-16 ***
origin_id1258     1.797e+01  4.025e-03  4465.08   &lt;2e-16 ***
origin_id1259     1.675e+01  6.567e-03  2550.80   &lt;2e-16 ***
origin_id1260     1.688e+01  7.501e-03  2249.96   &lt;2e-16 ***
origin_id1261     1.723e+01  6.804e-03  2531.98   &lt;2e-16 ***
origin_id1267     1.518e+01  4.907e-02   309.31   &lt;2e-16 ***
origin_id1269     1.796e+01  5.007e-03  3587.47   &lt;2e-16 ***
origin_id1270     1.756e+01  5.636e-03  3115.97   &lt;2e-16 ***
origin_id1271     1.815e+01  7.123e-03  2548.44   &lt;2e-16 ***
origin_id1282     1.702e+01  6.829e-03  2491.88   &lt;2e-16 ***
origin_id1283     1.754e+01  4.840e-03  3624.15   &lt;2e-16 ***
origin_id1284     1.619e+01  1.052e-02  1539.00   &lt;2e-16 ***
origin_id1285     1.706e+01  7.089e-03  2406.40   &lt;2e-16 ***
origin_id1291     1.428e+01  7.764e-02   183.91   &lt;2e-16 ***
origin_id1292     1.609e+01  3.574e-02   450.06   &lt;2e-16 ***
origin_id1294     1.748e+01  5.560e-03  3143.93   &lt;2e-16 ***
origin_id1295     1.787e+01  8.254e-03  2164.71   &lt;2e-16 ***
origin_id1305     1.704e+01  6.214e-03  2743.11   &lt;2e-16 ***
origin_id1306     1.778e+01  4.421e-03  4020.25   &lt;2e-16 ***
origin_id1307     1.551e+01  2.630e-02   589.87   &lt;2e-16 ***
origin_id1309     1.642e+01  9.891e-03  1659.83   &lt;2e-16 ***
origin_id1318     1.736e+01  6.008e-03  2889.81   &lt;2e-16 ***
origin_id1319     1.826e+01  4.768e-03  3830.60   &lt;2e-16 ***
origin_id1329     1.768e+01  4.913e-03  3598.97   &lt;2e-16 ***
origin_id1330     1.813e+01  3.621e-03  5007.34   &lt;2e-16 ***
origin_id1331     1.679e+01  6.953e-03  2413.96   &lt;2e-16 ***
origin_id1332     1.705e+01  7.731e-03  2205.11   &lt;2e-16 ***
origin_id1333     1.710e+01  7.254e-03  2356.71   &lt;2e-16 ***
origin_id1334     1.364e+01  9.452e-02   144.27   &lt;2e-16 ***
origin_id1338     1.312e+01  8.674e-02   151.22   &lt;2e-16 ***
origin_id1339     1.753e+01  7.847e-03  2233.47   &lt;2e-16 ***
origin_id1342     1.708e+01  7.194e-03  2373.88   &lt;2e-16 ***
origin_id1343     1.745e+01  7.598e-03  2296.26   &lt;2e-16 ***
origin_id1353     1.717e+01  5.972e-03  2875.57   &lt;2e-16 ***
origin_id1354     1.774e+01  4.317e-03  4108.93   &lt;2e-16 ***
origin_id1355     1.631e+01  1.405e-02  1160.52   &lt;2e-16 ***
origin_id1358     1.429e+01  4.614e-02   309.71   &lt;2e-16 ***
origin_id1361     1.566e+01  3.260e-02   480.33   &lt;2e-16 ***
origin_id1362     1.757e+01  7.741e-03  2269.98   &lt;2e-16 ***
origin_id1363     1.546e+01  2.074e-02   745.83   &lt;2e-16 ***
origin_id1366     1.865e+01  3.362e-03  5545.66   &lt;2e-16 ***
origin_id1367     1.702e+01  1.012e-02  1682.47   &lt;2e-16 ***
origin_id1377     1.837e+01  3.840e-03  4784.30   &lt;2e-16 ***
origin_id1378     1.777e+01  4.100e-03  4333.40   &lt;2e-16 ***
origin_id1379     1.689e+01  6.501e-03  2598.38   &lt;2e-16 ***
origin_id1380     1.697e+01  7.379e-03  2299.24   &lt;2e-16 ***
origin_id1381     1.789e+01  4.908e-03  3645.49   &lt;2e-16 ***
origin_id1382     1.503e+01  4.079e-02   368.36   &lt;2e-16 ***
origin_id1386     1.421e+01  5.560e-02   255.64   &lt;2e-16 ***
origin_id1387     1.410e+01  6.354e-02   221.98   &lt;2e-16 ***
origin_id1388     1.576e+01  1.440e-02  1094.10   &lt;2e-16 ***
origin_id1389     1.673e+01  7.985e-03  2095.30   &lt;2e-16 ***
origin_id1390     1.694e+01  7.177e-03  2360.18   &lt;2e-16 ***
origin_id1391     1.619e+01  1.262e-02  1282.87   &lt;2e-16 ***
origin_id1401     1.731e+01  5.384e-03  3214.69   &lt;2e-16 ***
origin_id1402     1.824e+01  3.586e-03  5087.88   &lt;2e-16 ***
origin_id1403     1.686e+01  6.830e-03  2469.20   &lt;2e-16 ***
origin_id1404     1.716e+01  8.506e-03  2017.74   &lt;2e-16 ***
origin_id1405     1.414e+01  5.917e-02   238.87   &lt;2e-16 ***
origin_id1406     1.200e+01  2.085e-01    57.57   &lt;2e-16 ***
origin_id1407     1.532e+01  1.645e-02   931.30   &lt;2e-16 ***
origin_id1408     1.593e+01  1.338e-02  1190.33   &lt;2e-16 ***
origin_id1409     1.779e+01  6.194e-03  2871.98   &lt;2e-16 ***
origin_id1410     1.377e+01  8.141e-02   169.13   &lt;2e-16 ***
origin_id1411     1.434e+01  3.265e-02   439.26   &lt;2e-16 ***
origin_id1412     1.655e+01  8.613e-03  1921.55   &lt;2e-16 ***
origin_id1413     1.681e+01  7.199e-03  2334.64   &lt;2e-16 ***
origin_id1414     1.698e+01  7.393e-03  2296.69   &lt;2e-16 ***
origin_id1425     1.400e+01  3.394e-02   412.63   &lt;2e-16 ***
origin_id1426     1.636e+01  7.692e-03  2126.48   &lt;2e-16 ***
origin_id1427     1.716e+01  5.500e-03  3120.76   &lt;2e-16 ***
origin_id1428     1.843e+01  3.844e-03  4795.50   &lt;2e-16 ***
origin_id1429     1.698e+01  1.146e-02  1481.98   &lt;2e-16 ***
origin_id1432     1.663e+01  8.005e-03  2076.94   &lt;2e-16 ***
origin_id1433     1.636e+01  9.584e-03  1706.72   &lt;2e-16 ***
origin_id1434     1.278e+01  1.361e-01    93.89   &lt;2e-16 ***
origin_id1435     1.599e+01  2.026e-02   789.29   &lt;2e-16 ***
origin_id1436     1.886e+01  3.192e-03  5906.28   &lt;2e-16 ***
origin_id1437     1.856e+01  3.370e-03  5507.47   &lt;2e-16 ***
origin_id1438     1.797e+01  5.240e-03  3430.18   &lt;2e-16 ***
origin_id1439     1.543e+01  2.140e-02   720.89   &lt;2e-16 ***
origin_id1449     1.687e+01  6.176e-03  2732.26   &lt;2e-16 ***
origin_id1450     1.727e+01  5.086e-03  3395.47   &lt;2e-16 ***
origin_id1451     1.871e+01  3.320e-03  5636.89   &lt;2e-16 ***
origin_id1452     1.774e+01  4.996e-03  3551.27   &lt;2e-16 ***
origin_id1453     1.637e+01  9.208e-03  1777.75   &lt;2e-16 ***
origin_id1454     1.669e+01  7.003e-03  2383.16   &lt;2e-16 ***
origin_id1455     1.713e+01  5.866e-03  2919.49   &lt;2e-16 ***
origin_id1456     1.734e+01  5.598e-03  3098.18   &lt;2e-16 ***
origin_id1457     1.646e+01  9.700e-03  1696.95   &lt;2e-16 ***
origin_id1458     1.563e+01  2.062e-02   758.33   &lt;2e-16 ***
origin_id1459     1.483e+01  2.712e-02   546.88   &lt;2e-16 ***
origin_id1460     1.767e+01  4.330e-03  4082.30   &lt;2e-16 ***
origin_id1461     1.714e+01  5.823e-03  2943.01   &lt;2e-16 ***
origin_id1462     1.677e+01  1.132e-02  1481.21   &lt;2e-16 ***
origin_id1463     1.688e+01  2.312e-02   729.87   &lt;2e-16 ***
origin_id1474     1.787e+01  3.934e-03  4542.92   &lt;2e-16 ***
origin_id1475     1.700e+01  6.721e-03  2528.80   &lt;2e-16 ***
origin_id1477     1.713e+01  6.262e-03  2735.72   &lt;2e-16 ***
origin_id1478     1.700e+01  6.362e-03  2672.29   &lt;2e-16 ***
origin_id1479     1.680e+01  6.575e-03  2555.55   &lt;2e-16 ***
origin_id1480     1.688e+01  6.071e-03  2780.85   &lt;2e-16 ***
origin_id1481     1.710e+01  6.632e-03  2578.51   &lt;2e-16 ***
origin_id1482     1.638e+01  1.005e-02  1628.79   &lt;2e-16 ***
origin_id1484     1.712e+01  6.538e-03  2618.82   &lt;2e-16 ***
origin_id1485     1.802e+01  3.984e-03  4523.02   &lt;2e-16 ***
origin_id1486     1.659e+01  1.238e-02  1339.89   &lt;2e-16 ***
origin_id1487     1.587e+01  3.275e-02   484.45   &lt;2e-16 ***
origin_id1497     1.769e+01  4.642e-03  3810.85   &lt;2e-16 ***
origin_id1498     1.814e+01  3.771e-03  4811.07   &lt;2e-16 ***
origin_id1499     1.798e+01  4.054e-03  4435.08   &lt;2e-16 ***
origin_id1500     1.725e+01  5.515e-03  3128.14   &lt;2e-16 ***
origin_id1501     1.786e+01  4.013e-03  4450.45   &lt;2e-16 ***
origin_id1502     1.651e+01  7.892e-03  2092.45   &lt;2e-16 ***
origin_id1503     1.699e+01  5.893e-03  2883.03   &lt;2e-16 ***
origin_id1504     1.767e+01  4.171e-03  4235.37   &lt;2e-16 ***
origin_id1505     1.801e+01  4.208e-03  4279.59   &lt;2e-16 ***
origin_id1508     1.750e+01  5.414e-03  3232.68   &lt;2e-16 ***
origin_id1509     1.800e+01  5.149e-03  3495.64   &lt;2e-16 ***
origin_id1522     1.817e+01  3.722e-03  4881.45   &lt;2e-16 ***
origin_id1523     1.777e+01  4.223e-03  4208.52   &lt;2e-16 ***
origin_id1524     1.776e+01  4.940e-03  3594.58   &lt;2e-16 ***
origin_id1525     1.757e+01  5.262e-03  3338.02   &lt;2e-16 ***
origin_id1526     1.869e+01  3.002e-03  6225.56   &lt;2e-16 ***
origin_id1527     1.848e+01  3.209e-03  5758.48   &lt;2e-16 ***
origin_id1528     1.640e+01  7.264e-03  2257.48   &lt;2e-16 ***
origin_id1529     1.714e+01  5.331e-03  3215.38   &lt;2e-16 ***
origin_id1530     1.843e+01  4.151e-03  4439.42   &lt;2e-16 ***
origin_id1532     1.638e+01  1.021e-02  1603.47   &lt;2e-16 ***
origin_id1533     1.723e+01  6.593e-03  2612.87   &lt;2e-16 ***
origin_id1545     1.629e+01  9.287e-03  1753.73   &lt;2e-16 ***
origin_id1546     1.780e+01  4.178e-03  4260.52   &lt;2e-16 ***
origin_id1547     1.789e+01  3.996e-03  4476.97   &lt;2e-16 ***
origin_id1548     1.637e+01  1.085e-02  1508.59   &lt;2e-16 ***
origin_id1549     1.741e+01  4.417e-03  3941.22   &lt;2e-16 ***
origin_id1550     1.749e+01  4.320e-03  4049.55   &lt;2e-16 ***
origin_id1551     1.651e+01  6.528e-03  2528.83   &lt;2e-16 ***
origin_id1552     1.900e+01  2.831e-03  6710.55   &lt;2e-16 ***
origin_id1556     1.680e+01  8.064e-03  2083.72   &lt;2e-16 ***
origin_id1570     1.788e+01  4.560e-03  3921.10   &lt;2e-16 ***
origin_id1571     1.832e+01  3.515e-03  5211.44   &lt;2e-16 ***
origin_id1572     1.790e+01  4.074e-03  4393.87   &lt;2e-16 ***
origin_id1573     1.736e+01  5.184e-03  3349.55   &lt;2e-16 ***
origin_id1574     1.751e+01  4.747e-03  3688.41   &lt;2e-16 ***
origin_id1575     1.686e+01  8.507e-03  1981.99   &lt;2e-16 ***
origin_id1576     1.747e+01  4.480e-03  3900.30   &lt;2e-16 ***
origin_id1577     1.790e+01  4.448e-03  4025.03   &lt;2e-16 ***
origin_id1578     1.644e+01  1.136e-02  1447.88   &lt;2e-16 ***
origin_id1581     1.486e+01  2.410e-02   616.67   &lt;2e-16 ***
origin_id1593     1.393e+01  3.015e-01    46.20   &lt;2e-16 ***
origin_id1594     1.692e+01  7.301e-03  2317.20   &lt;2e-16 ***
origin_id1595     1.823e+01  3.554e-03  5128.55   &lt;2e-16 ***
origin_id1596     1.792e+01  3.901e-03  4592.33   &lt;2e-16 ***
origin_id1597     1.712e+01  5.054e-03  3387.39   &lt;2e-16 ***
origin_id1598     1.704e+01  5.660e-03  3010.28   &lt;2e-16 ***
origin_id1599     1.520e+01  1.360e-02  1117.36   &lt;2e-16 ***
origin_id1600     1.712e+01  5.503e-03  3110.18   &lt;2e-16 ***
origin_id1603     1.451e+01  3.518e-02   412.35   &lt;2e-16 ***
origin_id1618     1.723e+01  9.321e-03  1848.94   &lt;2e-16 ***
origin_id1619     1.645e+01  9.705e-03  1695.00   &lt;2e-16 ***
origin_id1620     1.786e+01  3.869e-03  4615.42   &lt;2e-16 ***
origin_id1621     1.772e+01  4.181e-03  4237.70   &lt;2e-16 ***
origin_id1622     1.708e+01  7.837e-03  2179.28   &lt;2e-16 ***
origin_id1623     1.617e+01  1.006e-02  1606.98   &lt;2e-16 ***
origin_id1624     1.676e+01  7.334e-03  2285.73   &lt;2e-16 ***
origin_id1625     1.691e+01  6.654e-03  2541.41   &lt;2e-16 ***
origin_id1626     1.590e+01  1.400e-02  1135.77   &lt;2e-16 ***
origin_id1627     1.647e+01  1.346e-02  1223.73   &lt;2e-16 ***
origin_id1628     1.694e+01  1.084e-02  1562.28   &lt;2e-16 ***
origin_id1641     1.308e+01  1.491e-01    87.73   &lt;2e-16 ***
origin_id1643     1.675e+01  8.390e-03  1996.47   &lt;2e-16 ***
origin_id1644     1.718e+01  5.369e-03  3199.18   &lt;2e-16 ***
origin_id1645     1.775e+01  4.041e-03  4392.45   &lt;2e-16 ***
origin_id1646     1.545e+01  1.297e-02  1191.04   &lt;2e-16 ***
origin_id1647     1.643e+01  7.409e-03  2217.55   &lt;2e-16 ***
origin_id1648     1.737e+01  5.353e-03  3244.65   &lt;2e-16 ***
origin_id1649     1.716e+01  6.193e-03  2771.07   &lt;2e-16 ***
origin_id1650     1.417e+01  4.109e-02   344.77   &lt;2e-16 ***
origin_id1651     1.567e+01  1.663e-02   942.74   &lt;2e-16 ***
origin_id1652     1.558e+01  2.278e-02   683.92   &lt;2e-16 ***
origin_id1666     1.260e+01  3.015e-01    41.80   &lt;2e-16 ***
origin_id1667     1.635e+01  1.606e-02  1018.14   &lt;2e-16 ***
origin_id1668     1.699e+01  5.494e-03  3092.11   &lt;2e-16 ***
origin_id1669     1.739e+01  5.046e-03  3446.61   &lt;2e-16 ***
origin_id1670     1.770e+01  4.430e-03  3996.42   &lt;2e-16 ***
origin_id1671     1.906e+01  2.842e-03  6704.32   &lt;2e-16 ***
origin_id1672     1.615e+01  8.327e-03  1939.24   &lt;2e-16 ***
origin_id1673     1.810e+01  3.748e-03  4828.73   &lt;2e-16 ***
origin_id1674     1.722e+01  5.874e-03  2931.80   &lt;2e-16 ***
origin_id1675     1.757e+01  5.456e-03  3220.52   &lt;2e-16 ***
origin_id1676     1.562e+01  2.759e-02   566.25   &lt;2e-16 ***
origin_id1691     1.731e+01  1.113e-02  1554.39   &lt;2e-16 ***
origin_id1692     1.765e+01  4.238e-03  4163.78   &lt;2e-16 ***
origin_id1693     1.816e+01  4.254e-03  4267.80   &lt;2e-16 ***
origin_id1694     1.562e+01  1.151e-02  1356.94   &lt;2e-16 ***
origin_id1695     1.730e+01  4.778e-03  3620.88   &lt;2e-16 ***
origin_id1696     1.719e+01  5.204e-03  3303.17   &lt;2e-16 ***
origin_id1697     1.661e+01  6.911e-03  2403.38   &lt;2e-16 ***
origin_id1698     1.685e+01  7.565e-03  2227.58   &lt;2e-16 ***
origin_id1699     1.540e+01  2.108e-02   730.51   &lt;2e-16 ***
origin_id1715     1.529e+01  2.646e-02   577.82   &lt;2e-16 ***
origin_id1716     1.681e+01  6.627e-03  2537.08   &lt;2e-16 ***
origin_id1717     1.661e+01  6.587e-03  2521.73   &lt;2e-16 ***
origin_id1718     1.724e+01  5.995e-03  2876.11   &lt;2e-16 ***
origin_id1719     1.658e+01  6.608e-03  2509.46   &lt;2e-16 ***
origin_id1721     1.799e+01  3.808e-03  4724.81   &lt;2e-16 ***
origin_id1722     1.699e+01  6.758e-03  2514.03   &lt;2e-16 ***
origin_id1739     1.698e+01  7.867e-03  2157.87   &lt;2e-16 ***
origin_id1740     1.778e+01  4.078e-03  4359.57   &lt;2e-16 ***
origin_id1741     1.763e+01  4.316e-03  4084.63   &lt;2e-16 ***
origin_id1742     1.733e+01  5.021e-03  3452.23   &lt;2e-16 ***
origin_id1743     1.641e+01  7.775e-03  2110.77   &lt;2e-16 ***
origin_id1744     1.693e+01  6.524e-03  2595.36   &lt;2e-16 ***
origin_id1745     1.702e+01  6.520e-03  2611.20   &lt;2e-16 ***
origin_id1746     1.599e+01  1.274e-02  1255.08   &lt;2e-16 ***
origin_id1764     1.771e+01  4.815e-03  3677.69   &lt;2e-16 ***
origin_id1765     1.668e+01  6.631e-03  2516.01   &lt;2e-16 ***
origin_id1766     1.765e+01  4.401e-03  4009.98   &lt;2e-16 ***
origin_id1767     1.655e+01  8.831e-03  1873.98   &lt;2e-16 ***
origin_id1768     1.795e+01  4.082e-03  4396.90   &lt;2e-16 ***
origin_id1769     1.777e+01  4.119e-03  4315.00   &lt;2e-16 ***
origin_id1770     1.651e+01  9.328e-03  1770.09   &lt;2e-16 ***
origin_id1787     1.678e+01  9.728e-03  1724.99   &lt;2e-16 ***
origin_id1788     1.718e+01  5.112e-03  3360.66   &lt;2e-16 ***
origin_id1789     1.782e+01  4.026e-03  4426.91   &lt;2e-16 ***
origin_id1790     1.650e+01  7.926e-03  2082.23   &lt;2e-16 ***
origin_id1791     1.754e+01  4.940e-03  3549.73   &lt;2e-16 ***
origin_id1792     1.847e+01  3.163e-03  5839.70   &lt;2e-16 ***
origin_id1793     1.795e+01  3.840e-03  4674.61   &lt;2e-16 ***
origin_id1794     1.734e+01  5.706e-03  3038.45   &lt;2e-16 ***
origin_id1812     1.664e+01  7.417e-03  2243.72   &lt;2e-16 ***
origin_id1813     1.797e+01  3.855e-03  4660.73   &lt;2e-16 ***
origin_id1814     1.770e+01  5.199e-03  3404.08   &lt;2e-16 ***
origin_id1815     1.701e+01  7.078e-03  2403.93   &lt;2e-16 ***
origin_id1816     1.770e+01  4.363e-03  4057.45   &lt;2e-16 ***
origin_id1817     1.731e+01  4.923e-03  3515.62   &lt;2e-16 ***
origin_id1818     1.876e+01  2.982e-03  6289.21   &lt;2e-16 ***
origin_id1819     1.735e+01  5.882e-03  2949.79   &lt;2e-16 ***
origin_id1835     1.740e+01  5.894e-03  2951.37   &lt;2e-16 ***
origin_id1836     1.790e+01  4.073e-03  4393.37   &lt;2e-16 ***
origin_id1837     1.765e+01  4.860e-03  3631.91   &lt;2e-16 ***
origin_id1838     1.672e+01  1.049e-02  1594.96   &lt;2e-16 ***
origin_id1839     1.560e+01  3.729e-02   418.27   &lt;2e-16 ***
origin_id1840     1.717e+01  5.380e-03  3191.67   &lt;2e-16 ***
origin_id1841     1.668e+01  6.597e-03  2528.26   &lt;2e-16 ***
origin_id1842     1.743e+01  4.738e-03  3678.14   &lt;2e-16 ***
origin_id1843     1.645e+01  1.066e-02  1542.87   &lt;2e-16 ***
origin_id1860     1.766e+01  5.210e-03  3389.23   &lt;2e-16 ***
origin_id1861     1.812e+01  3.787e-03  4784.35   &lt;2e-16 ***
origin_id1862     1.819e+01  3.702e-03  4912.65   &lt;2e-16 ***
origin_id1863     1.862e+01  6.884e-03  2705.22   &lt;2e-16 ***
origin_id1864     1.521e+01  2.241e-02   678.83   &lt;2e-16 ***
origin_id1865     1.694e+01  6.665e-03  2541.86   &lt;2e-16 ***
origin_id1866     1.711e+01  5.305e-03  3224.42   &lt;2e-16 ***
origin_id1867     1.853e+01  3.209e-03  5774.36   &lt;2e-16 ***
origin_id1868     1.550e+01  2.230e-02   694.98   &lt;2e-16 ***
origin_id1883     1.834e+01  4.077e-03  4499.30   &lt;2e-16 ***
origin_id1884     1.699e+01  6.024e-03  2819.88   &lt;2e-16 ***
origin_id1885     1.758e+01  4.490e-03  3916.01   &lt;2e-16 ***
origin_id1889     1.582e+01  1.147e-02  1379.14   &lt;2e-16 ***
origin_id1890     1.858e+01  3.187e-03  5828.74   &lt;2e-16 ***
origin_id1891     1.599e+01  1.381e-02  1157.54   &lt;2e-16 ***
origin_id1908     1.734e+01  5.344e-03  3245.43   &lt;2e-16 ***
origin_id1909     1.690e+01  6.404e-03  2638.45   &lt;2e-16 ***
origin_id1910     1.772e+01  4.626e-03  3831.33   &lt;2e-16 ***
origin_id1912     1.716e+01  1.232e-02  1392.96   &lt;2e-16 ***
origin_id1913     1.347e+01  1.005e-01   134.01   &lt;2e-16 ***
origin_id1914     1.669e+01  7.749e-03  2154.09   &lt;2e-16 ***
origin_id1915     1.695e+01  6.065e-03  2795.36   &lt;2e-16 ***
origin_id1916     1.600e+01  1.806e-02   885.78   &lt;2e-16 ***
origin_id1931     1.646e+01  1.069e-02  1539.76   &lt;2e-16 ***
origin_id1932     1.586e+01  1.169e-02  1356.78   &lt;2e-16 ***
origin_id1933     1.615e+01  1.002e-02  1610.95   &lt;2e-16 ***
origin_id1934     1.609e+01  1.439e-02  1117.77   &lt;2e-16 ***
origin_id1936     1.782e+01  8.891e-03  2004.01   &lt;2e-16 ***
origin_id1937     1.223e+01  3.162e-01    38.67   &lt;2e-16 ***
origin_id1938     1.706e+01  6.155e-03  2771.99   &lt;2e-16 ***
origin_id1939     1.630e+01  1.577e-02  1033.70   &lt;2e-16 ***
origin_id1956     1.739e+01  5.735e-03  3032.35   &lt;2e-16 ***
origin_id1957     1.764e+01  4.712e-03  3743.76   &lt;2e-16 ***
origin_id1958     1.774e+01  4.488e-03  3952.14   &lt;2e-16 ***
origin_id1961     1.706e+01  1.409e-02  1210.34   &lt;2e-16 ***
origin_id1963     1.586e+01  1.401e-02  1132.65   &lt;2e-16 ***
origin_id1980     1.668e+01  8.278e-03  2014.71   &lt;2e-16 ***
origin_id1981     1.710e+01  6.212e-03  2752.16   &lt;2e-16 ***
origin_id1984     1.576e+01  2.526e-02   624.07   &lt;2e-16 ***
origin_id1985     1.662e+01  2.289e-02   726.06   &lt;2e-16 ***
origin_id1986     1.590e+01  1.529e-02  1039.80   &lt;2e-16 ***
origin_id2004     1.699e+01  7.400e-03  2295.84   &lt;2e-16 ***
origin_id2005     1.780e+01  4.272e-03  4167.35   &lt;2e-16 ***
origin_id2006     1.706e+01  6.255e-03  2728.03   &lt;2e-16 ***
origin_id2007     1.670e+01  9.314e-03  1793.43   &lt;2e-16 ***
origin_id2009     1.761e+01  1.277e-02  1378.94   &lt;2e-16 ***
origin_id2028     1.674e+01  8.448e-03  1981.55   &lt;2e-16 ***
origin_id2029     1.863e+01  3.114e-03  5984.46   &lt;2e-16 ***
origin_id2030     1.558e+01  1.457e-02  1069.40   &lt;2e-16 ***
origin_id2031     1.694e+01  7.396e-03  2290.17   &lt;2e-16 ***
origin_id2032     1.714e+01  6.467e-03  2650.68   &lt;2e-16 ***
origin_id2052     1.655e+01  1.027e-02  1611.10   &lt;2e-16 ***
origin_id2053     1.860e+01  3.336e-03  5575.29   &lt;2e-16 ***
origin_id2054     1.770e+01  4.252e-03  4163.49   &lt;2e-16 ***
origin_id2055     1.808e+01  4.042e-03  4471.99   &lt;2e-16 ***
origin_id2056     1.732e+01  5.556e-03  3117.74   &lt;2e-16 ***
origin_id2057     1.821e+01  4.161e-03  4376.85   &lt;2e-16 ***
origin_id2076     1.697e+01  6.714e-03  2528.09   &lt;2e-16 ***
origin_id2077     1.727e+01  5.055e-03  3416.97   &lt;2e-16 ***
origin_id2078     1.631e+01  7.757e-03  2102.54   &lt;2e-16 ***
origin_id2079     1.733e+01  5.493e-03  3155.34   &lt;2e-16 ***
origin_id2080     1.504e+01  1.976e-02   761.45   &lt;2e-16 ***
origin_id2081     1.777e+01  5.362e-03  3313.29   &lt;2e-16 ***
origin_id2101     1.707e+01  6.426e-03  2656.02   &lt;2e-16 ***
origin_id2102     1.689e+01  7.103e-03  2377.76   &lt;2e-16 ***
origin_id2103     1.794e+01  3.822e-03  4693.23   &lt;2e-16 ***
origin_id2104     1.681e+01  7.502e-03  2240.41   &lt;2e-16 ***
origin_id2105     1.747e+01  5.491e-03  3182.07   &lt;2e-16 ***
origin_id2124     1.700e+01  7.300e-03  2328.25   &lt;2e-16 ***
origin_id2125     1.817e+01  4.011e-03  4531.38   &lt;2e-16 ***
origin_id2127     1.948e+01  2.593e-03  7513.08   &lt;2e-16 ***
origin_id2128     1.680e+01  1.059e-02  1585.45   &lt;2e-16 ***
origin_id2129     1.670e+01  9.283e-03  1798.87   &lt;2e-16 ***
origin_id2149     1.582e+01  2.007e-02   788.50   &lt;2e-16 ***
origin_id2150     1.768e+01  4.736e-03  3733.83   &lt;2e-16 ***
origin_id2151     1.691e+01  6.081e-03  2781.61   &lt;2e-16 ***
origin_id2152     1.624e+01  1.009e-02  1608.96   &lt;2e-16 ***
origin_id2153     1.883e+01  3.162e-03  5955.48   &lt;2e-16 ***
origin_id2172     1.627e+01  1.222e-02  1331.82   &lt;2e-16 ***
origin_id2173     1.675e+01  7.983e-03  2098.28   &lt;2e-16 ***
origin_id2174     1.820e+01  3.945e-03  4614.22   &lt;2e-16 ***
origin_id2175     1.822e+01  3.522e-03  5172.22   &lt;2e-16 ***
origin_id2176     1.769e+01  5.454e-03  3242.84   &lt;2e-16 ***
origin_id2197     1.708e+01  1.133e-02  1507.03   &lt;2e-16 ***
origin_id2198     1.737e+01  6.267e-03  2772.33   &lt;2e-16 ***
origin_id2199     1.690e+01  6.080e-03  2779.83   &lt;2e-16 ***
origin_id2200     1.693e+01  5.943e-03  2848.44   &lt;2e-16 ***
origin_id2201     1.749e+01  5.620e-03  3111.78   &lt;2e-16 ***
origin_id2221     1.671e+01  1.328e-02  1258.42   &lt;2e-16 ***
origin_id2222     1.733e+01  6.091e-03  2845.43   &lt;2e-16 ***
origin_id2223     1.765e+01  4.509e-03  3915.11   &lt;2e-16 ***
origin_id2224     1.737e+01  5.477e-03  3170.99   &lt;2e-16 ***
origin_id2246     1.831e+01  5.246e-03  3490.77   &lt;2e-16 ***
origin_id2247     1.681e+01  9.132e-03  1841.31   &lt;2e-16 ***
origin_id2248     1.714e+01  5.999e-03  2857.92   &lt;2e-16 ***
origin_id2249     1.675e+01  8.571e-03  1954.69   &lt;2e-16 ***
origin_id2269     1.694e+01  1.406e-02  1204.70   &lt;2e-16 ***
origin_id2270     1.516e+01  3.476e-02   436.15   &lt;2e-16 ***
origin_id2271     1.786e+01  5.391e-03  3313.82   &lt;2e-16 ***
origin_id2272     1.708e+01  7.110e-03  2401.62   &lt;2e-16 ***
origin_id2294     1.756e+01  1.277e-02  1374.74   &lt;2e-16 ***
origin_id2295     1.858e+01  7.348e-03  2529.29   &lt;2e-16 ***
origin_id2296     1.644e+01  1.105e-02  1487.40   &lt;2e-16 ***
origin_id2297     1.784e+01  5.711e-03  3123.73   &lt;2e-16 ***
origin_id2319     1.729e+01  1.439e-02  1201.42   &lt;2e-16 ***
origin_id2320     1.606e+01  1.944e-02   826.12   &lt;2e-16 ***
origin_id2321     1.734e+01  8.945e-03  1938.33   &lt;2e-16 ***
origin_id2345     1.705e+01  8.961e-03  1902.55   &lt;2e-16 ***
origin_id2346     1.700e+01  1.084e-02  1568.55   &lt;2e-16 ***
origin_id2366     1.813e+01  6.913e-03  2621.96   &lt;2e-16 ***
origin_id2368     1.594e+01  2.440e-02   653.23   &lt;2e-16 ***
origin_id2391     1.681e+01  1.290e-02  1302.83   &lt;2e-16 ***
origin_id2392     1.880e+01  5.288e-03  3555.63   &lt;2e-16 ***
origin_id2394     1.792e+01  7.469e-03  2399.61   &lt;2e-16 ***
origin_id2412     1.819e+01  1.595e-02  1140.67   &lt;2e-16 ***
origin_id2415     1.895e+01  5.072e-03  3735.91   &lt;2e-16 ***
origin_id2441     1.909e+01  5.101e-03  3742.33   &lt;2e-16 ***
origin_id2442     1.516e+01  3.739e-02   405.58   &lt;2e-16 ***
origin_id2460     1.764e+01  2.149e-02   820.77   &lt;2e-16 ***
origin_id2465     1.845e+01  6.692e-03  2757.65   &lt;2e-16 ***
origin_id2489     1.782e+01  1.374e-02  1296.98   &lt;2e-16 ***
origin_id2512     1.893e+01  2.325e-02   814.14   &lt;2e-16 ***
origin_id2556     1.793e+01  2.588e-02   692.83   &lt;2e-16 ***
log(des_food)     8.935e-02  2.622e-04   340.75   &lt;2e-16 ***
log(des_leisure)  8.336e-03  3.290e-04    25.34   &lt;2e-16 ***
log(des_home)     1.640e-01  7.548e-05  2173.28   &lt;2e-16 ***
log(dist)        -1.578e+00  2.792e-04 -5650.65   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 320884898  on 49890  degrees of freedom
Residual deviance:  29894930  on 49250  degrees of freedom
AIC: 30181854

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calc_Rsquared</span>(orcSIM<span class="sc">$</span>data<span class="sc">$</span>trips, orcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4925793</code></pre>
</div>
</div>
<p>From the results above, we can observe that all three variables included in the simulation are significant at alpha of 0.05. The variables also returned positive estimated values. Furthermore, from the R-squared function, we can see that this model accounts for about 49% of of the variation of flows in the system. This set of results is better than the results from the unconstrained model.</p>
</section>
<section id="destination-constrained" class="level2">
<h2 class="anchored" data-anchor-id="destination-constrained">6.4. Destination Constrained</h2>
<p>In this section, we will fit a destination constrained SIM by using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> trips <span class="sc">~</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                destin_id <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ori_business) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ori_finance) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ori_train) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(decSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = trips ~ destin_id + log(ori_business) + log(ori_finance) + 
    log(ori_train) + log(dist) - 1, family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                    Estimate Std. Error   z value Pr(&gt;|z|)    
destin_id105      16.9729251  0.0864144   196.413   &lt;2e-16 ***
destin_id131      16.6191405  0.0827901   200.738   &lt;2e-16 ***
destin_id153      16.3176871  0.0470765   346.621   &lt;2e-16 ***
destin_id154      17.4560816  0.0244553   713.795   &lt;2e-16 ***
destin_id155      17.5973487  0.0208374   844.508   &lt;2e-16 ***
destin_id178      15.7162641  0.0860890   182.558   &lt;2e-16 ***
destin_id179      17.2661972  0.0208579   827.801   &lt;2e-16 ***
destin_id180      15.9139644  0.0465661   341.750   &lt;2e-16 ***
destin_id181      15.5729790  0.0764995   203.570   &lt;2e-16 ***
destin_id201      18.7819937  0.0133065  1411.487   &lt;2e-16 ***
destin_id202      15.9017238  0.0512732   310.137   &lt;2e-16 ***
destin_id203      15.7629043  0.0463591   340.017   &lt;2e-16 ***
destin_id204      16.6446397  0.0265492   626.935   &lt;2e-16 ***
destin_id205      14.9265027  0.0677583   220.290   &lt;2e-16 ***
destin_id226      15.8929423  0.0793298   200.340   &lt;2e-16 ***
destin_id227      15.9578878  0.0649912   245.539   &lt;2e-16 ***
destin_id228      16.3846364  0.0341168   480.251   &lt;2e-16 ***
destin_id229      16.7360515  0.0347073   482.205   &lt;2e-16 ***
destin_id230      16.2440384  0.0278505   583.259   &lt;2e-16 ***
destin_id231      16.7289434  0.0432379   386.905   &lt;2e-16 ***
destin_id252      15.1582080  0.0880658   172.124   &lt;2e-16 ***
destin_id253      18.8607201  0.0076675  2459.842   &lt;2e-16 ***
destin_id254      19.0527410  0.0072055  2644.208   &lt;2e-16 ***
destin_id275      16.3151188  0.2000127    81.570   &lt;2e-16 ***
destin_id277      15.7970698  0.0546712   288.947   &lt;2e-16 ***
destin_id278      16.5572613  0.0250458   661.080   &lt;2e-16 ***
destin_id300      14.5701399  0.0725742   200.762   &lt;2e-16 ***
destin_id301      16.6064442  0.0214333   774.796   &lt;2e-16 ***
destin_id302      14.4262415  0.1078506   133.761   &lt;2e-16 ***
destin_id324      15.9193916  0.0582552   273.270   &lt;2e-16 ***
destin_id325      19.0836564  0.0063822  2990.130   &lt;2e-16 ***
destin_id326      16.6706350  0.0299493   556.629   &lt;2e-16 ***
destin_id347      16.2645644  0.0441480   368.410   &lt;2e-16 ***
destin_id348      15.7706165  0.0346429   455.234   &lt;2e-16 ***
destin_id349      15.7053717  0.0460714   340.892   &lt;2e-16 ***
destin_id372      15.9547452  0.0340711   468.278   &lt;2e-16 ***
destin_id373      18.6599123  0.0090540  2060.963   &lt;2e-16 ***
destin_id395      16.3650646  0.0595822   274.664   &lt;2e-16 ***
destin_id396      16.5295790  0.0512706   322.399   &lt;2e-16 ***
destin_id397      14.5832367  0.1924611    75.772   &lt;2e-16 ***
destin_id419      17.9000121  0.0249574   717.224   &lt;2e-16 ***
destin_id420      16.7328992  0.0284585   587.975   &lt;2e-16 ***
destin_id421      17.1741151  0.0216968   791.549   &lt;2e-16 ***
destin_id444      16.3047510  0.0336716   484.229   &lt;2e-16 ***
destin_id445      16.9348688  0.0237414   713.305   &lt;2e-16 ***
destin_id468      16.3334447  0.0296445   550.976   &lt;2e-16 ***
destin_id469      15.6765666  0.0334479   468.687   &lt;2e-16 ***
destin_id471      16.2422512  0.0375561   432.480   &lt;2e-16 ***
destin_id491      16.6091181  0.0480985   345.315   &lt;2e-16 ***
destin_id492      15.8427481  0.0502277   315.419   &lt;2e-16 ***
destin_id493      20.2904399  0.0035310  5746.379   &lt;2e-16 ***
destin_id494      17.9829659  0.0141597  1270.015   &lt;2e-16 ***
destin_id495      18.2328200  0.0225403   808.897   &lt;2e-16 ***
destin_id516      15.6233048  0.0491865   317.634   &lt;2e-16 ***
destin_id517      16.5817861  0.0227594   728.568   &lt;2e-16 ***
destin_id519      18.7072342  0.0089228  2096.577   &lt;2e-16 ***
destin_id539      15.6842063  0.0698691   224.480   &lt;2e-16 ***
destin_id540      16.4291705  0.0312368   525.956   &lt;2e-16 ***
destin_id541      16.8176245  0.0172714   973.728   &lt;2e-16 ***
destin_id542      19.8942733  0.0042315  4701.502   &lt;2e-16 ***
destin_id543      18.7493248  0.0105346  1779.783   &lt;2e-16 ***
destin_id564      15.1284672  0.0776396   194.855   &lt;2e-16 ***
destin_id565      16.3143236  0.0319737   510.241   &lt;2e-16 ***
destin_id566      17.3626846  0.0129369  1342.110   &lt;2e-16 ***
destin_id567      19.7319320  0.0057720  3418.546   &lt;2e-16 ***
destin_id568      13.6233371  0.2041346    66.737   &lt;2e-16 ***
destin_id588      17.2874744  0.0192363   898.689   &lt;2e-16 ***
destin_id589      17.6680548  0.0111669  1582.177   &lt;2e-16 ***
destin_id590      20.0421962  0.0035014  5723.993   &lt;2e-16 ***
destin_id591      16.5570838  0.0287611   575.676   &lt;2e-16 ***
destin_id592      16.3008649  0.0362136   450.130   &lt;2e-16 ***
destin_id593      14.4698085  0.1400432   103.324   &lt;2e-16 ***
destin_id612      16.6153538  0.0292008   569.003   &lt;2e-16 ***
destin_id613      15.7360960  0.0423412   371.650   &lt;2e-16 ***
destin_id614      19.7681645  0.0038017  5199.778   &lt;2e-16 ***
destin_id615      20.0734510  0.0037148  5403.628   &lt;2e-16 ***
destin_id617      17.0361496  0.0219900   774.721   &lt;2e-16 ***
destin_id618      12.1315136  1.0000021    12.131   &lt;2e-16 ***
destin_id619      15.9187909  0.0570196   279.181   &lt;2e-16 ***
destin_id620      18.1587486  0.0325330   558.165   &lt;2e-16 ***
destin_id636      16.2880804  0.0343288   474.473   &lt;2e-16 ***
destin_id637      16.9618058  0.0247011   686.683   &lt;2e-16 ***
destin_id638      20.5672550  0.0026781  7679.844   &lt;2e-16 ***
destin_id639      18.8576187  0.0063576  2966.175   &lt;2e-16 ***
destin_id640      14.6532206  0.0710963   206.104   &lt;2e-16 ***
destin_id642      15.3407625  0.0980837   156.405   &lt;2e-16 ***
destin_id643      11.6613283  0.7071096    16.492   &lt;2e-16 ***
destin_id644      15.5019861  0.0870640   178.053   &lt;2e-16 ***
destin_id661      17.0872179  0.0251778   678.662   &lt;2e-16 ***
destin_id662      17.3947566  0.0096844  1796.164   &lt;2e-16 ***
destin_id663      19.6880139  0.0035886  5486.240   &lt;2e-16 ***
destin_id669      16.1687867  0.0913161   177.064   &lt;2e-16 ***
destin_id670      16.4358147  0.0508101   323.476   &lt;2e-16 ***
destin_id684      16.0850341  0.0346424   464.317   &lt;2e-16 ***
destin_id685      16.4384868  0.0228459   719.538   &lt;2e-16 ***
destin_id686      18.3875181  0.0057958  3172.573   &lt;2e-16 ***
destin_id688      13.6520858  0.2357129    57.918   &lt;2e-16 ***
destin_id693      14.6791941  0.1443523   101.690   &lt;2e-16 ***
destin_id710      15.4352283  0.0305881   504.615   &lt;2e-16 ***
destin_id711      20.0236154  0.0034027  5884.644   &lt;2e-16 ***
destin_id713      18.0574215  0.0128680  1403.287   &lt;2e-16 ***
destin_id732      16.9098502  0.0189404   892.792   &lt;2e-16 ***
destin_id733      18.3469153  0.0066259  2768.981   &lt;2e-16 ***
destin_id734      19.3816684  0.0039524  4903.749   &lt;2e-16 ***
destin_id735      19.3726481  0.0067751  2859.386   &lt;2e-16 ***
destin_id756      17.2059521  0.0240558   715.253   &lt;2e-16 ***
destin_id757      15.9362978  0.0237862   669.980   &lt;2e-16 ***
destin_id758      19.6565235  0.0037219  5281.295   &lt;2e-16 ***
destin_id759      19.8111865  0.0034622  5722.187   &lt;2e-16 ***
destin_id761      19.3297314  0.0069790  2769.706   &lt;2e-16 ***
destin_id780      16.4846889  0.0243641   676.598   &lt;2e-16 ***
destin_id781      19.1432242  0.0047579  4023.480   &lt;2e-16 ***
destin_id782      17.1396871  0.0117668  1456.615   &lt;2e-16 ***
destin_id783      17.8297711  0.0122928  1450.419   &lt;2e-16 ***
destin_id804      16.5376881  0.0286915   576.396   &lt;2e-16 ***
destin_id807      19.3081407  0.0041710  4629.172   &lt;2e-16 ***
destin_id809      15.7539419  0.0370670   425.013   &lt;2e-16 ***
destin_id828      18.6788292  0.0081451  2293.261   &lt;2e-16 ***
destin_id830      19.2457218  0.0039656  4853.169   &lt;2e-16 ***
destin_id831      17.9686695  0.0107314  1674.407   &lt;2e-16 ***
destin_id837      15.1462893  0.0745651   203.128   &lt;2e-16 ***
destin_id852      15.3972377  0.0486630   316.405   &lt;2e-16 ***
destin_id853      19.6866248  0.0045584  4318.747   &lt;2e-16 ***
destin_id854      19.6574657  0.0033276  5907.455   &lt;2e-16 ***
destin_id855      18.4415627  0.0057931  3183.341   &lt;2e-16 ***
destin_id856      18.4168609  0.0085915  2143.616   &lt;2e-16 ***
destin_id857      20.0631578  0.0035823  5600.584   &lt;2e-16 ***
destin_id858      17.7167167  0.0131270  1349.639   &lt;2e-16 ***
destin_id875      14.8613212  0.0845410   175.788   &lt;2e-16 ***
destin_id877      16.7886881  0.0118685  1414.553   &lt;2e-16 ***
destin_id878      19.0641618  0.0040665  4688.044   &lt;2e-16 ***
destin_id879      19.7206681  0.0043055  4580.395   &lt;2e-16 ***
destin_id880      18.0028254  0.0102290  1759.984   &lt;2e-16 ***
destin_id881      20.0726608  0.0032171  6239.335   &lt;2e-16 ***
destin_id882      18.7861272  0.0063970  2936.706   &lt;2e-16 ***
destin_id885      17.8622557  0.0148901  1199.602   &lt;2e-16 ***
destin_id901      18.7682732  0.0051021  3678.566   &lt;2e-16 ***
destin_id902      19.0711597  0.0044228  4312.024   &lt;2e-16 ***
destin_id903      19.3292422  0.0037865  5104.785   &lt;2e-16 ***
destin_id904      19.1675761  0.0046639  4109.739   &lt;2e-16 ***
destin_id905      19.2581508  0.0041875  4598.907   &lt;2e-16 ***
destin_id906      18.7305793  0.0058430  3205.635   &lt;2e-16 ***
destin_id907      19.5923209  0.0052914  3702.666   &lt;2e-16 ***
destin_id909      15.7910429  0.0376352   419.582   &lt;2e-16 ***
destin_id923      17.4383965  0.0217248   802.695   &lt;2e-16 ***
destin_id924      17.4619562  0.0120147  1453.383   &lt;2e-16 ***
destin_id925      17.2529718  0.0110492  1561.467   &lt;2e-16 ***
destin_id926      17.5259548  0.0092157  1901.754   &lt;2e-16 ***
destin_id927      18.6906700  0.0047284  3952.883   &lt;2e-16 ***
destin_id928      18.3507948  0.0061245  2996.269   &lt;2e-16 ***
destin_id929      18.9316560  0.0046541  4067.767   &lt;2e-16 ***
destin_id930      19.4714148  0.0051280  3797.105   &lt;2e-16 ***
destin_id931      14.4113261  0.0825039   174.674   &lt;2e-16 ***
destin_id932      16.1259157  0.0316866   508.918   &lt;2e-16 ***
destin_id933      15.6433384  0.0435250   359.411   &lt;2e-16 ***
destin_id948      14.1188732  0.0898233   157.185   &lt;2e-16 ***
destin_id949      18.5257817  0.0067841  2730.755   &lt;2e-16 ***
destin_id950      18.8873360  0.0065832  2869.009   &lt;2e-16 ***
destin_id951      19.7323470  0.0032819  6012.556   &lt;2e-16 ***
destin_id952      19.3055948  0.0057938  3332.094   &lt;2e-16 ***
destin_id953      18.5550610  0.0050632  3664.683   &lt;2e-16 ***
destin_id954      16.9984790  0.0117353  1448.495   &lt;2e-16 ***
destin_id955      19.0598095  0.0049757  3830.571   &lt;2e-16 ***
destin_id956      16.8531647  0.0174533   965.612   &lt;2e-16 ***
destin_id957      16.0957657  0.0295278   545.106   &lt;2e-16 ***
destin_id972      18.1002336  0.0069116  2618.838   &lt;2e-16 ***
destin_id973      16.5982844  0.0145245  1142.776   &lt;2e-16 ***
destin_id974      18.9297261  0.0048081  3937.086   &lt;2e-16 ***
destin_id975      17.7375966  0.0079497  2231.221   &lt;2e-16 ***
destin_id976      12.7568771  0.1644100    77.592   &lt;2e-16 ***
destin_id977      19.1002722  0.0041007  4657.780   &lt;2e-16 ***
destin_id978      16.7058410  0.0176546   946.260   &lt;2e-16 ***
destin_id979      18.6133328  0.0070273  2648.719   &lt;2e-16 ***
destin_id980      18.7486764  0.0062699  2990.275   &lt;2e-16 ***
destin_id981      15.9377674  0.0368409   432.611   &lt;2e-16 ***
destin_id996      19.0333106  0.0045038  4226.033   &lt;2e-16 ***
destin_id997      18.6017471  0.0053093  3503.597   &lt;2e-16 ***
destin_id998      17.4378498  0.0098728  1766.257   &lt;2e-16 ***
destin_id999      18.6082776  0.0051348  3623.959   &lt;2e-16 ***
destin_id1000     17.5160394  0.0101475  1726.144   &lt;2e-16 ***
destin_id1001     19.4558562  0.0036713  5299.514   &lt;2e-16 ***
destin_id1002     19.2729476  0.0054924  3508.990   &lt;2e-16 ***
destin_id1005     17.2530492  0.0166854  1034.021   &lt;2e-16 ***
destin_id1019     19.4153032  0.0047152  4117.626   &lt;2e-16 ***
destin_id1020     20.4463250  0.0027473  7442.337   &lt;2e-16 ***
destin_id1021     16.9271567  0.0216378   782.295   &lt;2e-16 ***
destin_id1022     17.2579939  0.0119106  1448.955   &lt;2e-16 ***
destin_id1023     18.5132568  0.0056675  3266.539   &lt;2e-16 ***
destin_id1024     16.9288846  0.0122501  1381.936   &lt;2e-16 ***
destin_id1025     19.5820760  0.0035329  5542.708   &lt;2e-16 ***
destin_id1027     16.8533989  0.0293290   574.632   &lt;2e-16 ***
destin_id1028     20.0215059  0.0050155  3991.930   &lt;2e-16 ***
destin_id1029     16.8301041  0.0223044   754.564   &lt;2e-16 ***
destin_id1043     18.5817665  0.0055992  3318.652   &lt;2e-16 ***
destin_id1044     19.1600276  0.0037053  5170.977   &lt;2e-16 ***
destin_id1045     18.4363392  0.0054198  3401.647   &lt;2e-16 ***
destin_id1046     17.3870980  0.0145591  1194.241   &lt;2e-16 ***
destin_id1047     17.6533911  0.0081311  2171.100   &lt;2e-16 ***
destin_id1048     18.3918755  0.0064143  2867.336   &lt;2e-16 ***
destin_id1049     19.2961162  0.0039840  4843.370   &lt;2e-16 ***
destin_id1050     19.7116565  0.0046248  4262.204   &lt;2e-16 ***
destin_id1053     17.8717099  0.0096571  1850.629   &lt;2e-16 ***
destin_id1054     21.0416054  0.0029311  7178.667   &lt;2e-16 ***
destin_id1066     17.8279538  0.0090853  1962.288   &lt;2e-16 ***
destin_id1067     17.6832210  0.0088179  2005.368   &lt;2e-16 ***
destin_id1068     17.6753955  0.0073595  2401.721   &lt;2e-16 ***
destin_id1069     18.0304127  0.0068521  2631.361   &lt;2e-16 ***
destin_id1070     19.2033627  0.0041877  4585.656   &lt;2e-16 ***
destin_id1072     18.6453222  0.0072866  2558.840   &lt;2e-16 ***
destin_id1073     19.3906266  0.0052487  3694.388   &lt;2e-16 ***
destin_id1075     16.5750128  0.0296912   558.247   &lt;2e-16 ***
destin_id1076     17.2459191  0.0174345   989.185   &lt;2e-16 ***
destin_id1077     18.9245116  0.0055443  3413.334   &lt;2e-16 ***
destin_id1091     14.8865663  0.0486014   306.299   &lt;2e-16 ***
destin_id1092     17.8132299  0.0080606  2209.915   &lt;2e-16 ***
destin_id1093     17.6821931  0.0080753  2189.656   &lt;2e-16 ***
destin_id1094     18.0677536  0.0061963  2915.896   &lt;2e-16 ***
destin_id1097     19.4453372  0.0044736  4346.731   &lt;2e-16 ***
destin_id1101     19.8024897  0.0039710  4986.784   &lt;2e-16 ***
destin_id1102     19.7154924  0.0041004  4808.137   &lt;2e-16 ***
destin_id1114     17.4931808  0.0095682  1828.254   &lt;2e-16 ***
destin_id1115     18.2272223  0.0057643  3162.076   &lt;2e-16 ***
destin_id1116     18.2571653  0.0074727  2443.172   &lt;2e-16 ***
destin_id1117     17.1476636  0.0148633  1153.694   &lt;2e-16 ***
destin_id1118     17.3733147  0.0119800  1450.188   &lt;2e-16 ***
destin_id1123     16.7094201  0.0285048   586.198   &lt;2e-16 ***
destin_id1125     19.1809377  0.0041493  4622.665   &lt;2e-16 ***
destin_id1126     16.1883724  0.0282658   572.719   &lt;2e-16 ***
destin_id1138     19.0576925  0.0049351  3861.676   &lt;2e-16 ***
destin_id1139     18.0918831  0.0063329  2856.799   &lt;2e-16 ***
destin_id1140     18.5027647  0.0050938  3632.431   &lt;2e-16 ***
destin_id1141     16.9278092  0.0120458  1405.286   &lt;2e-16 ***
destin_id1142     18.8960028  0.0047310  3994.056   &lt;2e-16 ***
destin_id1149     18.5144835  0.0067982  2723.446   &lt;2e-16 ***
destin_id1150     17.5389657  0.0118896  1475.147   &lt;2e-16 ***
destin_id1161     18.0769309  0.0084442  2140.756   &lt;2e-16 ***
destin_id1162     16.2341076  0.0183884   882.847   &lt;2e-16 ***
destin_id1163     16.3811065  0.0131507  1245.645   &lt;2e-16 ***
destin_id1164     17.1190661  0.0092590  1848.916   &lt;2e-16 ***
destin_id1171     13.5947851  0.1525128    89.139   &lt;2e-16 ***
destin_id1172     14.3402124  0.0867329   165.338   &lt;2e-16 ***
destin_id1173     20.7389399  0.0026907  7707.776   &lt;2e-16 ***
destin_id1174     19.2466108  0.0065050  2958.737   &lt;2e-16 ***
destin_id1187     16.3402968  0.0191059   855.247   &lt;2e-16 ***
destin_id1188     19.0706271  0.0036438  5233.662   &lt;2e-16 ***
destin_id1189     16.9425510  0.0115440  1467.650   &lt;2e-16 ***
destin_id1190     17.0594368  0.0110611  1542.296   &lt;2e-16 ***
destin_id1195     17.5610436  0.0195538   898.090   &lt;2e-16 ***
destin_id1197     19.2862161  0.0050273  3836.282   &lt;2e-16 ***
destin_id1198     19.4319695  0.0040667  4778.291   &lt;2e-16 ***
destin_id1199     17.1277898  0.0256390   668.036   &lt;2e-16 ***
destin_id1209     16.8363331  0.0140331  1199.760   &lt;2e-16 ***
destin_id1210     16.0100869  0.0223652   715.847   &lt;2e-16 ***
destin_id1211     18.7171836  0.0043011  4351.764   &lt;2e-16 ***
destin_id1212     17.5975731  0.0074570  2359.862   &lt;2e-16 ***
destin_id1213     17.7315893  0.0075012  2363.834   &lt;2e-16 ***
destin_id1220     14.7148359  0.0695329   211.624   &lt;2e-16 ***
destin_id1221     19.6138450  0.0036346  5396.470   &lt;2e-16 ***
destin_id1222     18.2031389  0.0080030  2274.533   &lt;2e-16 ***
destin_id1234     17.0708554  0.0099741  1711.514   &lt;2e-16 ***
destin_id1235     17.2623461  0.0080170  2153.218   &lt;2e-16 ***
destin_id1236     17.6682677  0.0064325  2746.716   &lt;2e-16 ***
destin_id1244     16.6377941  0.0309501   537.568   &lt;2e-16 ***
destin_id1245     19.4437656  0.0049679  3913.894   &lt;2e-16 ***
destin_id1246     20.1613671  0.0034226  5890.742   &lt;2e-16 ***
destin_id1247     17.8029679  0.0110216  1615.275   &lt;2e-16 ***
destin_id1257     18.1273299  0.0061655  2940.110   &lt;2e-16 ***
destin_id1258     18.8494730  0.0041089  4587.487   &lt;2e-16 ***
destin_id1259     17.6946446  0.0061822  2862.177   &lt;2e-16 ***
destin_id1260     17.4211725  0.0079777  2183.725   &lt;2e-16 ***
destin_id1261     17.4263789  0.0086441  2015.985   &lt;2e-16 ***
destin_id1267     14.4789178  0.0936808   154.556   &lt;2e-16 ***
destin_id1269     19.1971125  0.0051870  3701.029   &lt;2e-16 ***
destin_id1270     18.9218622  0.0055061  3436.504   &lt;2e-16 ***
destin_id1271     17.0230781  0.0204749   831.414   &lt;2e-16 ***
destin_id1282     17.9330396  0.0066681  2689.387   &lt;2e-16 ***
destin_id1283     18.8517949  0.0041801  4509.894   &lt;2e-16 ***
destin_id1284     17.0663553  0.0097529  1749.873   &lt;2e-16 ***
destin_id1285     17.8123410  0.0068623  2595.688   &lt;2e-16 ***
destin_id1291     14.7039308  0.0798340   184.181   &lt;2e-16 ***
destin_id1292     14.6202932  0.1139796   128.271   &lt;2e-16 ***
destin_id1294     19.4059824  0.0045726  4244.000   &lt;2e-16 ***
destin_id1295     16.1532017  0.0303287   532.604   &lt;2e-16 ***
destin_id1305     18.7547416  0.0044994  4168.237   &lt;2e-16 ***
destin_id1306     18.2090422  0.0051910  3507.802   &lt;2e-16 ***
destin_id1307     16.8312713  0.0210881   798.140   &lt;2e-16 ***
destin_id1309     17.3559452  0.0111338  1558.845   &lt;2e-16 ***
destin_id1318     17.8549859  0.0094741  1884.614   &lt;2e-16 ***
destin_id1319     18.2452968  0.0090223  2022.256   &lt;2e-16 ***
destin_id1329     18.3776582  0.0053533  3432.944   &lt;2e-16 ***
destin_id1330     18.4257478  0.0045452  4053.876   &lt;2e-16 ***
destin_id1331     17.3703161  0.0071678  2423.381   &lt;2e-16 ***
destin_id1332     16.6856461  0.0116224  1435.641   &lt;2e-16 ***
destin_id1333     17.4046821  0.0089691  1940.518   &lt;2e-16 ***
destin_id1334     13.8213528  0.1147270   120.472   &lt;2e-16 ***
destin_id1338     13.7341910  0.1060202   129.543   &lt;2e-16 ***
destin_id1339     17.6910449  0.0110827  1596.281   &lt;2e-16 ***
destin_id1342     18.6927175  0.0063317  2952.247   &lt;2e-16 ***
destin_id1343     19.5227124  0.0051009  3827.277   &lt;2e-16 ***
destin_id1353     18.7045702  0.0046940  3984.768   &lt;2e-16 ***
destin_id1354     18.8212252  0.0038283  4916.299   &lt;2e-16 ***
destin_id1355     16.0522767  0.0187006   858.381   &lt;2e-16 ***
destin_id1358     14.5005975  0.0669990   216.430   &lt;2e-16 ***
destin_id1361     13.2749325  0.1490858    89.042   &lt;2e-16 ***
destin_id1362     18.9690006  0.0062592  3030.568   &lt;2e-16 ***
destin_id1363     16.7056531  0.0190167   878.471   &lt;2e-16 ***
destin_id1366     20.0149986  0.0035145  5695.042   &lt;2e-16 ***
destin_id1367     17.8422584  0.0125438  1422.399   &lt;2e-16 ***
destin_id1376     17.3446878  0.0217484   797.514   &lt;2e-16 ***
destin_id1377     19.2501433  0.0037790  5093.977   &lt;2e-16 ***
destin_id1378     18.7001074  0.0038854  4812.976   &lt;2e-16 ***
destin_id1379     17.4552261  0.0065986  2645.278   &lt;2e-16 ***
destin_id1380     16.4644120  0.0108293  1520.365   &lt;2e-16 ***
destin_id1381     18.2094223  0.0052980  3437.067   &lt;2e-16 ***
destin_id1382     14.6638296  0.0640546   228.927   &lt;2e-16 ***
destin_id1386     14.9937473  0.0647174   231.680   &lt;2e-16 ***
destin_id1387     17.0520391  0.0210021   811.919   &lt;2e-16 ***
destin_id1388     15.3181115  0.0328744   465.959   &lt;2e-16 ***
destin_id1389     18.3215417  0.0067293  2722.654   &lt;2e-16 ***
destin_id1390     18.6834764  0.0061772  3024.567   &lt;2e-16 ***
destin_id1391     17.8773796  0.0100873  1772.265   &lt;2e-16 ***
destin_id1401     18.4744419  0.0045160  4090.844   &lt;2e-16 ***
destin_id1402     18.8665450  0.0035086  5377.177   &lt;2e-16 ***
destin_id1403     16.9508064  0.0073163  2316.850   &lt;2e-16 ***
destin_id1404     17.3074810  0.0089960  1923.901   &lt;2e-16 ***
destin_id1405     15.5533110  0.0350961   443.164   &lt;2e-16 ***
destin_id1406     12.7724599  0.2425440    52.660   &lt;2e-16 ***
destin_id1407     16.2437295  0.0162711   998.318   &lt;2e-16 ***
destin_id1408     16.9412505  0.0130977  1293.457   &lt;2e-16 ***
destin_id1409     17.0252127  0.0135075  1260.427   &lt;2e-16 ***
destin_id1410     15.3660608  0.0586621   261.942   &lt;2e-16 ***
destin_id1411     15.6754258  0.0294400   532.454   &lt;2e-16 ***
destin_id1412     18.2089010  0.0068018  2677.060   &lt;2e-16 ***
destin_id1413     18.4222519  0.0061713  2985.149   &lt;2e-16 ***
destin_id1414     19.0419905  0.0049598  3839.257   &lt;2e-16 ***
destin_id1425     14.4026508  0.0458343   314.233   &lt;2e-16 ***
destin_id1426     17.5790302  0.0058815  2988.875   &lt;2e-16 ***
destin_id1427     17.5925943  0.0053289  3301.342   &lt;2e-16 ***
destin_id1428     18.1379238  0.0046609  3891.524   &lt;2e-16 ***
destin_id1429     16.9933602  0.0116972  1452.772   &lt;2e-16 ***
destin_id1432     17.9573622  0.0065874  2726.002   &lt;2e-16 ***
destin_id1433     17.5714646  0.0085965  2044.015   &lt;2e-16 ***
destin_id1434     15.2364280  0.0595796   255.732   &lt;2e-16 ***
destin_id1435     14.5075409  0.0932735   155.538   &lt;2e-16 ***
destin_id1436     19.8722097  0.0034310  5791.882   &lt;2e-16 ***
destin_id1437     19.6343843  0.0037633  5217.389   &lt;2e-16 ***
destin_id1438     19.2140356  0.0054315  3537.539   &lt;2e-16 ***
destin_id1439     17.1846569  0.0163810  1049.058   &lt;2e-16 ***
destin_id1449     17.4775943  0.0060835  2872.951   &lt;2e-16 ***
destin_id1450     17.6702715  0.0049598  3562.711   &lt;2e-16 ***
destin_id1451     18.3680928  0.0039481  4652.411   &lt;2e-16 ***
destin_id1452     17.5486506  0.0060747  2888.807   &lt;2e-16 ***
destin_id1453     16.2044935  0.0159220  1017.740   &lt;2e-16 ***
destin_id1454     17.3131305  0.0079119  2188.240   &lt;2e-16 ***
destin_id1455     18.2370217  0.0055392  3292.333   &lt;2e-16 ***
destin_id1456     18.5574400  0.0050939  3643.087   &lt;2e-16 ***
destin_id1457     17.9806680  0.0070200  2561.356   &lt;2e-16 ***
destin_id1458     17.1393091  0.0152367  1124.872   &lt;2e-16 ***
destin_id1459     17.2298817  0.0154979  1111.759   &lt;2e-16 ***
destin_id1460     19.1200538  0.0040594  4710.037   &lt;2e-16 ***
destin_id1461     19.0323329  0.0047651  3994.120   &lt;2e-16 ***
destin_id1462     19.1907267  0.0074351  2581.087   &lt;2e-16 ***
destin_id1463     18.0881982  0.0169872  1064.811   &lt;2e-16 ***
destin_id1474     18.2114995  0.0040018  4550.872   &lt;2e-16 ***
destin_id1475     17.1900524  0.0070953  2422.737   &lt;2e-16 ***
destin_id1477     17.2612742  0.0075197  2295.468   &lt;2e-16 ***
destin_id1478     16.6090225  0.0110971  1496.701   &lt;2e-16 ***
destin_id1479     17.5589179  0.0068708  2555.573   &lt;2e-16 ***
destin_id1480     17.6835196  0.0069250  2553.578   &lt;2e-16 ***
destin_id1481     18.8967461  0.0048357  3907.798   &lt;2e-16 ***
destin_id1482     17.3698977  0.0099488  1745.936   &lt;2e-16 ***
destin_id1484     19.4146843  0.0044190  4393.425   &lt;2e-16 ***
destin_id1485     19.9079536  0.0033858  5879.835   &lt;2e-16 ***
destin_id1486     17.7860810  0.0139052  1279.099   &lt;2e-16 ***
destin_id1487     18.0642830  0.0201328   897.257   &lt;2e-16 ***
destin_id1497     17.6846635  0.0055977  3159.264   &lt;2e-16 ***
destin_id1498     18.2144268  0.0039299  4634.801   &lt;2e-16 ***
destin_id1499     18.2540415  0.0038683  4718.847   &lt;2e-16 ***
destin_id1500     17.5983202  0.0056484  3115.619   &lt;2e-16 ***
destin_id1501     18.5825142  0.0039464  4708.747   &lt;2e-16 ***
destin_id1502     17.7154676  0.0067819  2612.155   &lt;2e-16 ***
destin_id1503     18.7398070  0.0043106  4347.336   &lt;2e-16 ***
destin_id1504     19.2748336  0.0034479  5590.332   &lt;2e-16 ***
destin_id1505     19.5308628  0.0036179  5398.429   &lt;2e-16 ***
destin_id1508     19.4859059  0.0043183  4512.433   &lt;2e-16 ***
destin_id1509     18.6310342  0.0074958  2485.536   &lt;2e-16 ***
destin_id1522     17.3377100  0.0054375  3188.568   &lt;2e-16 ***
destin_id1523     17.2646371  0.0053331  3237.278   &lt;2e-16 ***
destin_id1524     18.1011676  0.0047686  3795.925   &lt;2e-16 ***
destin_id1525     17.6705986  0.0071014  2488.326   &lt;2e-16 ***
destin_id1526     19.5744306  0.0030215  6478.371   &lt;2e-16 ***
destin_id1527     19.1031947  0.0036806  5190.202   &lt;2e-16 ***
destin_id1528     18.1029185  0.0056171  3222.829   &lt;2e-16 ***
destin_id1529     17.9674378  0.0059974  2995.885   &lt;2e-16 ***
destin_id1530     17.1151324  0.0120718  1417.783   &lt;2e-16 ***
destin_id1532     18.4482250  0.0078580  2347.687   &lt;2e-16 ***
destin_id1533     18.9980887  0.0058948  3222.846   &lt;2e-16 ***
destin_id1545     16.1116277  0.0119358  1349.859   &lt;2e-16 ***
destin_id1546     17.4707085  0.0050001  3494.042   &lt;2e-16 ***
destin_id1547     18.1004227  0.0039917  4534.545   &lt;2e-16 ***
destin_id1548     17.7460442  0.0066788  2657.082   &lt;2e-16 ***
destin_id1549     18.3807098  0.0042889  4285.613   &lt;2e-16 ***
destin_id1550     18.6758055  0.0040124  4654.518   &lt;2e-16 ***
destin_id1551     17.3861470  0.0070673  2460.070   &lt;2e-16 ***
destin_id1552     19.8217084  0.0029988  6609.950   &lt;2e-16 ***
destin_id1556     18.6220101  0.0070817  2629.611   &lt;2e-16 ***
destin_id1570     16.8470795  0.0073590  2289.326   &lt;2e-16 ***
destin_id1571     18.1706595  0.0038350  4738.124   &lt;2e-16 ***
destin_id1572     18.3575067  0.0039943  4595.901   &lt;2e-16 ***
destin_id1573     18.6397203  0.0040482  4604.391   &lt;2e-16 ***
destin_id1574     19.1615885  0.0037750  5075.860   &lt;2e-16 ***
destin_id1575     18.6839134  0.0057039  3275.658   &lt;2e-16 ***
destin_id1576     18.9349604  0.0038628  4901.841   &lt;2e-16 ***
destin_id1577     18.7772360  0.0050575  3712.730   &lt;2e-16 ***
destin_id1578     17.8658675  0.0095214  1876.394   &lt;2e-16 ***
destin_id1581     17.2972297  0.0166272  1040.296   &lt;2e-16 ***
destin_id1593     10.3400548  0.3333387    31.020   &lt;2e-16 ***
destin_id1594     16.1850630  0.0096838  1671.352   &lt;2e-16 ***
destin_id1595     18.1856414  0.0038860  4679.816   &lt;2e-16 ***
destin_id1596     18.4120729  0.0039886  4616.224   &lt;2e-16 ***
destin_id1597     18.6526890  0.0039652  4704.039   &lt;2e-16 ***
destin_id1598     18.2733863  0.0053161  3437.341   &lt;2e-16 ***
destin_id1599     16.7733033  0.0106607  1573.378   &lt;2e-16 ***
destin_id1600     19.1425414  0.0037875  5054.142   &lt;2e-16 ***
destin_id1603     13.9360547  0.1154884   120.671   &lt;2e-16 ***
destin_id1618     17.2483378  0.0084635  2037.965   &lt;2e-16 ***
destin_id1619     16.0248489  0.0126772  1264.067   &lt;2e-16 ***
destin_id1620     18.1208923  0.0042192  4294.831   &lt;2e-16 ***
destin_id1621     18.9993153  0.0035917  5289.820   &lt;2e-16 ***
destin_id1622     19.2083147  0.0054832  3503.125   &lt;2e-16 ***
destin_id1623     16.8869028  0.0122335  1380.382   &lt;2e-16 ***
destin_id1624     18.2696248  0.0065285  2798.426   &lt;2e-16 ***
destin_id1625     16.6983083  0.0140583  1187.792   &lt;2e-16 ***
destin_id1626     17.2224855  0.0129859  1326.248   &lt;2e-16 ***
destin_id1627     15.1415033  0.0544316   278.175   &lt;2e-16 ***
destin_id1628     14.9208220  0.0558529   267.145   &lt;2e-16 ***
destin_id1641     13.4410150  0.1162664   115.605   &lt;2e-16 ***
destin_id1643     17.3446023  0.0073880  2347.658   &lt;2e-16 ***
destin_id1644     16.3537190  0.0115320  1418.112   &lt;2e-16 ***
destin_id1645     18.6527469  0.0040701  4582.924   &lt;2e-16 ***
destin_id1646     16.6551308  0.0122454  1360.116   &lt;2e-16 ***
destin_id1647     18.0057375  0.0057131  3151.665   &lt;2e-16 ***
destin_id1648     16.9369329  0.0113728  1489.247   &lt;2e-16 ***
destin_id1649     17.0433039  0.0129319  1317.930   &lt;2e-16 ***
destin_id1650     15.9743906  0.0472348   338.191   &lt;2e-16 ***
destin_id1651     15.9174505  0.0273243   582.539   &lt;2e-16 ***
destin_id1652     14.8371803  0.0811405   182.858   &lt;2e-16 ***
destin_id1666     14.6967604  0.0562916   261.083   &lt;2e-16 ***
destin_id1667     17.5309126  0.0120058  1460.200   &lt;2e-16 ***
destin_id1668     17.3434820  0.0064122  2704.782   &lt;2e-16 ***
destin_id1669     18.3647006  0.0047506  3865.770   &lt;2e-16 ***
destin_id1670     19.0724942  0.0039603  4815.926   &lt;2e-16 ***
destin_id1671     19.5916005  0.0031998  6122.827   &lt;2e-16 ***
destin_id1672     17.7800871  0.0066474  2674.728   &lt;2e-16 ***
destin_id1673     18.8471226  0.0044641  4221.889   &lt;2e-16 ***
destin_id1674     19.1219415  0.0043865  4359.278   &lt;2e-16 ***
destin_id1675     18.8965817  0.0056535  3342.440   &lt;2e-16 ***
destin_id1676     15.4484016  0.0685507   225.357   &lt;2e-16 ***
destin_id1691     17.3476599  0.0147987  1172.245   &lt;2e-16 ***
destin_id1692     18.8116537  0.0037078  5073.495   &lt;2e-16 ***
destin_id1693     17.9732288  0.0063377  2835.929   &lt;2e-16 ***
destin_id1694     17.0518065  0.0087751  1943.205   &lt;2e-16 ***
destin_id1695     18.6217549  0.0043855  4246.163   &lt;2e-16 ***
destin_id1696     19.1261335  0.0039476  4845.036   &lt;2e-16 ***
destin_id1697     17.7855177  0.0074465  2388.455   &lt;2e-16 ***
destin_id1698     19.0288723  0.0051494  3695.352   &lt;2e-16 ***
destin_id1699     14.8281873  0.0540348   274.419   &lt;2e-16 ***
destin_id1715     15.9705713  0.0274514   581.776   &lt;2e-16 ***
destin_id1716     18.0274249  0.0052814  3413.377   &lt;2e-16 ***
destin_id1717     17.6788852  0.0063942  2764.826   &lt;2e-16 ***
destin_id1718     18.3207768  0.0056685  3232.029   &lt;2e-16 ***
destin_id1719     18.5207847  0.0047159  3927.327   &lt;2e-16 ***
destin_id1721     19.6947237  0.0032840  5997.188   &lt;2e-16 ***
destin_id1722     19.0431809  0.0050846  3745.276   &lt;2e-16 ***
destin_id1739     17.9073513  0.0067954  2635.232   &lt;2e-16 ***
destin_id1740     18.8617514  0.0037594  5017.193   &lt;2e-16 ***
destin_id1741     18.1754895  0.0049331  3684.380   &lt;2e-16 ***
destin_id1742     17.9182898  0.0063736  2811.346   &lt;2e-16 ***
destin_id1743     18.2551502  0.0057029  3201.044   &lt;2e-16 ***
destin_id1744     18.9431033  0.0044564  4250.795   &lt;2e-16 ***
destin_id1745     19.0799603  0.0046576  4096.538   &lt;2e-16 ***
destin_id1746     18.1971773  0.0082979  2192.991   &lt;2e-16 ***
destin_id1764     18.7211489  0.0042606  4394.054   &lt;2e-16 ***
destin_id1765     18.0342035  0.0056197  3209.122   &lt;2e-16 ***
destin_id1766     18.2200082  0.0051759  3520.180   &lt;2e-16 ***
destin_id1767     18.0439568  0.0072130  2501.574   &lt;2e-16 ***
destin_id1768     18.9195228  0.0045062  4198.578   &lt;2e-16 ***
destin_id1769     19.5114022  0.0034448  5664.069   &lt;2e-16 ***
destin_id1770     18.8347554  0.0052294  3601.722   &lt;2e-16 ***
destin_id1787     17.8461509  0.0083059  2148.599   &lt;2e-16 ***
destin_id1788     18.8457708  0.0037492  5026.628   &lt;2e-16 ***
destin_id1789     18.4440415  0.0043665  4223.963   &lt;2e-16 ***
destin_id1790     16.3854937  0.0140913  1162.808   &lt;2e-16 ***
destin_id1791     19.0121802  0.0042821  4439.893   &lt;2e-16 ***
destin_id1792     19.5131291  0.0032342  6033.322   &lt;2e-16 ***
destin_id1793     18.8688490  0.0044568  4233.676   &lt;2e-16 ***
destin_id1794     19.1144304  0.0045505  4200.493   &lt;2e-16 ***
destin_id1812     17.8497455  0.0062526  2854.751   &lt;2e-16 ***
destin_id1813     18.2688087  0.0048981  3729.755   &lt;2e-16 ***
destin_id1814     17.3053546  0.0092206  1876.816   &lt;2e-16 ***
destin_id1815     17.8797647  0.0080345  2225.363   &lt;2e-16 ***
destin_id1816     19.1405254  0.0039115  4893.412   &lt;2e-16 ***
destin_id1817     18.9354467  0.0042672  4437.442   &lt;2e-16 ***
destin_id1818     19.6414906  0.0033476  5867.394   &lt;2e-16 ***
destin_id1819     19.4942818  0.0039628  4919.361   &lt;2e-16 ***
destin_id1835     18.4392254  0.0052199  3532.460   &lt;2e-16 ***
destin_id1836     18.4910955  0.0042827  4317.610   &lt;2e-16 ***
destin_id1837     17.9854412  0.0062063  2897.919   &lt;2e-16 ***
destin_id1838     16.5487065  0.0170949   968.051   &lt;2e-16 ***
destin_id1839     15.0171570  0.0760579   197.444   &lt;2e-16 ***
destin_id1840     18.8065768  0.0048753  3857.498   &lt;2e-16 ***
destin_id1841     18.5570810  0.0049515  3747.753   &lt;2e-16 ***
destin_id1842     19.0160022  0.0040636  4679.615   &lt;2e-16 ***
destin_id1843     18.4607391  0.0070680  2611.886   &lt;2e-16 ***
destin_id1860     18.5044112  0.0050882  3636.719   &lt;2e-16 ***
destin_id1861     18.5071997  0.0045002  4112.554   &lt;2e-16 ***
destin_id1862     18.1968060  0.0053683  3389.699   &lt;2e-16 ***
destin_id1863     16.8712932  0.0281285   599.794   &lt;2e-16 ***
destin_id1864     15.7858892  0.0283151   557.509   &lt;2e-16 ***
destin_id1865     19.2680408  0.0041429  4650.893   &lt;2e-16 ***
destin_id1866     19.0393679  0.0039363  4836.831   &lt;2e-16 ***
destin_id1867     19.3984599  0.0036886  5258.977   &lt;2e-16 ***
destin_id1868     17.7950141  0.0134267  1325.350   &lt;2e-16 ***
destin_id1883     18.9411110  0.0044721  4235.349   &lt;2e-16 ***
destin_id1884     17.9431688  0.0057848  3101.773   &lt;2e-16 ***
destin_id1885     18.8874934  0.0039542  4776.517   &lt;2e-16 ***
destin_id1889     17.9299247  0.0088021  2036.996   &lt;2e-16 ***
destin_id1890     20.2255369  0.0028489  7099.444   &lt;2e-16 ***
destin_id1891     16.7586081  0.0153870  1089.144   &lt;2e-16 ***
destin_id1908     18.5060681  0.0047766  3874.290   &lt;2e-16 ***
destin_id1909     18.3430838  0.0049521  3704.115   &lt;2e-16 ***
destin_id1910     19.1670360  0.0040742  4704.492   &lt;2e-16 ***
destin_id1912     15.5888884  0.0482139   323.328   &lt;2e-16 ***
destin_id1913     14.6118792  0.1291158   113.169   &lt;2e-16 ***
destin_id1914     18.7695825  0.0053680  3496.592   &lt;2e-16 ***
destin_id1915     18.9890141  0.0044720  4246.163   &lt;2e-16 ***
destin_id1916     17.0116082  0.0219105   776.414   &lt;2e-16 ***
destin_id1931     18.3284985  0.0065329  2805.581   &lt;2e-16 ***
destin_id1932     16.9247289  0.0113225  1494.783   &lt;2e-16 ***
destin_id1933     18.1476568  0.0071828  2526.535   &lt;2e-16 ***
destin_id1934     15.6454182  0.0307939   508.069   &lt;2e-16 ***
destin_id1936     16.2663548  0.0335647   484.628   &lt;2e-16 ***
destin_id1937     13.7406525  0.3535602    38.864   &lt;2e-16 ***
destin_id1938     18.9550272  0.0049275  3846.787   &lt;2e-16 ***
destin_id1939     18.6645256  0.0091499  2039.872   &lt;2e-16 ***
destin_id1956     18.6603291  0.0048492  3848.155   &lt;2e-16 ***
destin_id1957     18.2549086  0.0056493  3231.332   &lt;2e-16 ***
destin_id1958     18.9915886  0.0043925  4323.621   &lt;2e-16 ***
destin_id1961     16.1915559  0.0329962   490.710   &lt;2e-16 ***
destin_id1963     18.2205478  0.0084335  2160.493   &lt;2e-16 ***
destin_id1980     17.6379365  0.0079199  2227.038   &lt;2e-16 ***
destin_id1981     18.9517105  0.0045635  4152.900   &lt;2e-16 ***
destin_id1984     14.3513598  0.0833577   172.166   &lt;2e-16 ***
destin_id1985     14.6400484  0.0916939   159.662   &lt;2e-16 ***
destin_id1986     18.3504118  0.0088798  2066.535   &lt;2e-16 ***
destin_id2004     18.1577675  0.0064849  2799.994   &lt;2e-16 ***
destin_id2005     18.6825517  0.0043939  4251.915   &lt;2e-16 ***
destin_id2006     18.9286474  0.0047449  3989.220   &lt;2e-16 ***
destin_id2007     18.8434314  0.0060686  3105.090   &lt;2e-16 ***
destin_id2009     17.1370174  0.0331208   517.409   &lt;2e-16 ***
destin_id2028     17.8095423  0.0077243  2305.660   &lt;2e-16 ***
destin_id2029     19.5606369  0.0032484  6021.566   &lt;2e-16 ***
destin_id2030     17.7684659  0.0091543  1941.003   &lt;2e-16 ***
destin_id2031     18.8709274  0.0055772  3383.604   &lt;2e-16 ***
destin_id2032     18.0308946  0.0076624  2353.152   &lt;2e-16 ***
destin_id2052     17.8668109  0.0084686  2109.760   &lt;2e-16 ***
destin_id2053     19.5032488  0.0034502  5652.803   &lt;2e-16 ***
destin_id2054     19.1269016  0.0039558  4835.118   &lt;2e-16 ***
destin_id2055     19.4044650  0.0039491  4913.595   &lt;2e-16 ***
destin_id2056     19.0159136  0.0046639  4077.251   &lt;2e-16 ***
destin_id2057     19.0293433  0.0050673  3755.313   &lt;2e-16 ***
destin_id2076     18.0016960  0.0064670  2783.644   &lt;2e-16 ***
destin_id2077     19.0643656  0.0038937  4896.250   &lt;2e-16 ***
destin_id2078     17.2568141  0.0088144  1957.804   &lt;2e-16 ***
destin_id2079     19.2161267  0.0041444  4636.701   &lt;2e-16 ***
destin_id2080     17.3995963  0.0124777  1394.453   &lt;2e-16 ***
destin_id2081     19.3898581  0.0046241  4193.189   &lt;2e-16 ***
destin_id2101     18.8189114  0.0046333  4061.697   &lt;2e-16 ***
destin_id2102     19.2560767  0.0052747  3650.662   &lt;2e-16 ***
destin_id2103     18.9945896  0.0038764  4900.000   &lt;2e-16 ***
destin_id2104     19.0103813  0.0043919  4328.480   &lt;2e-16 ***
destin_id2105     19.5263711  0.0040816  4783.941   &lt;2e-16 ***
destin_id2124     18.5306100  0.0058341  3176.244   &lt;2e-16 ***
destin_id2125     19.3975394  0.0037383  5188.923   &lt;2e-16 ***
destin_id2127     20.3348432  0.0027512  7391.153   &lt;2e-16 ***
destin_id2128     18.6947442  0.0075639  2471.561   &lt;2e-16 ***
destin_id2129     18.3257842  0.0076478  2396.204   &lt;2e-16 ***
destin_id2149     18.4201084  0.0077080  2389.746   &lt;2e-16 ***
destin_id2150     17.9871857  0.0066322  2712.120   &lt;2e-16 ***
destin_id2151     18.6213475  0.0046669  3990.113   &lt;2e-16 ***
destin_id2152     18.0290047  0.0074592  2417.013   &lt;2e-16 ***
destin_id2153     19.8025230  0.0035406  5593.036   &lt;2e-16 ***
destin_id2172     16.6867370  0.0159775  1044.390   &lt;2e-16 ***
destin_id2173     17.3650742  0.0092549  1876.306   &lt;2e-16 ***
destin_id2174     18.8701232  0.0045531  4144.429   &lt;2e-16 ***
destin_id2175     19.4955527  0.0033975  5738.228   &lt;2e-16 ***
destin_id2176     18.7899075  0.0052865  3554.320   &lt;2e-16 ***
destin_id2197     18.1281477  0.0098846  1833.983   &lt;2e-16 ***
destin_id2198     16.7009304  0.0127604  1308.806   &lt;2e-16 ***
destin_id2199     18.7779381  0.0045216  4152.905   &lt;2e-16 ***
destin_id2200     19.1184809  0.0040917  4672.512   &lt;2e-16 ***
destin_id2201     19.2367018  0.0046680  4120.939   &lt;2e-16 ***
destin_id2221     16.4482796  0.0194231   846.843   &lt;2e-16 ***
destin_id2222     18.4308875  0.0056295  3273.956   &lt;2e-16 ***
destin_id2223     19.4227009  0.0036762  5283.329   &lt;2e-16 ***
destin_id2224     19.3900563  0.0040405  4798.949   &lt;2e-16 ***
destin_id2246     18.0968877  0.0089157  2029.784   &lt;2e-16 ***
destin_id2247     17.4689133  0.0107244  1628.890   &lt;2e-16 ***
destin_id2248     19.0222084  0.0044484  4276.160   &lt;2e-16 ***
destin_id2249     18.5737054  0.0066827  2779.384   &lt;2e-16 ***
destin_id2269     15.1641562  0.0429589   352.992   &lt;2e-16 ***
destin_id2270     14.9683016  0.0421539   355.087   &lt;2e-16 ***
destin_id2271     18.9323250  0.0055845  3390.138   &lt;2e-16 ***
destin_id2272     18.4881662  0.0067700  2730.878   &lt;2e-16 ***
destin_id2294     15.5628586  0.0357200   435.690   &lt;2e-16 ***
destin_id2295     17.3846456  0.0212557   817.881   &lt;2e-16 ***
destin_id2296     17.2640674  0.0127710  1351.815   &lt;2e-16 ***
destin_id2297     17.7047835  0.0111190  1592.297   &lt;2e-16 ***
destin_id2319     16.8651192  0.0285947   589.798   &lt;2e-16 ***
destin_id2320     17.9111959  0.0124573  1437.813   &lt;2e-16 ***
destin_id2321     16.1455702  0.0291842   553.229   &lt;2e-16 ***
destin_id2345     16.3954551  0.0212671   770.932   &lt;2e-16 ***
destin_id2346     17.0035910  0.0182550   931.447   &lt;2e-16 ***
destin_id2366     18.4467377  0.0096060  1920.336   &lt;2e-16 ***
destin_id2368     15.3247249  0.0566523   270.505   &lt;2e-16 ***
destin_id2391     16.4668693  0.0231434   711.516   &lt;2e-16 ***
destin_id2392     19.1112097  0.0067312  2839.213   &lt;2e-16 ***
destin_id2394     18.8448595  0.0077684  2425.837   &lt;2e-16 ***
destin_id2412     19.4182982  0.0120389  1612.965   &lt;2e-16 ***
destin_id2415     19.2880500  0.0065049  2965.144   &lt;2e-16 ***
destin_id2441     18.0034829  0.0148407  1213.116   &lt;2e-16 ***
destin_id2442     16.3661349  0.0316442   517.192   &lt;2e-16 ***
destin_id2460     18.2625740  0.0179730  1016.114   &lt;2e-16 ***
destin_id2465     18.2250213  0.0121687  1497.692   &lt;2e-16 ***
destin_id2489     17.1523138  0.0313277   547.513   &lt;2e-16 ***
destin_id2512     14.2189193  0.1690431    84.114   &lt;2e-16 ***
destin_id2556     16.9421878  0.0589689   287.307   &lt;2e-16 ***
log(ori_business) -0.0004489  0.0001771    -2.535   0.0112 *  
log(ori_finance)   0.3566874  0.0002363  1509.497   &lt;2e-16 ***
log(ori_train)     0.3541172  0.0003809   929.712   &lt;2e-16 ***
log(dist)         -1.6578701  0.0002800 -5920.015   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 320884898  on 49890  degrees of freedom
Residual deviance:  29015686  on 49249  degrees of freedom
AIC: 29302612

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calc_Rsquared</span>(decSIM<span class="sc">$</span>data<span class="sc">$</span>trips, decSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.425145</code></pre>
</div>
</div>
<p>From the results above, we can observe that all variables included in the simulation are significant at alpha of 0.05. However, ori_business had the highest p-value and it returned a negative estimated value. Furthermore, from the R-squared function, we can see that the model accounts for about 42% of of the variation of flows in the system.</p>
</section>
<section id="doubly-constrained" class="level2">
<h2 class="anchored" data-anchor-id="doubly-constrained">6.5. Doubly Constrained</h2>
<p>Lastly, we will fit a doubly constrained SIM by using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> trips <span class="sc">~</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                origin_id <span class="sc">+</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                destin_id <span class="sc">+</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = trips ~ origin_id + destin_id + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)   15.6034468  0.1015731   153.618  &lt; 2e-16 ***
origin_id131   1.0651584  0.0799633    13.321  &lt; 2e-16 ***
origin_id153   0.7582533  0.0562280    13.485  &lt; 2e-16 ***
origin_id154   2.0109670  0.0537391    37.421  &lt; 2e-16 ***
origin_id155   2.0573113  0.0583521    35.257  &lt; 2e-16 ***
origin_id178  -1.2345690  0.0773545   -15.960  &lt; 2e-16 ***
origin_id179   1.8709444  0.0547679    34.161  &lt; 2e-16 ***
origin_id180   1.4943652  0.0595015    25.115  &lt; 2e-16 ***
origin_id181   2.2808873  0.0574238    39.720  &lt; 2e-16 ***
origin_id201   3.5621646  0.0572648    62.205  &lt; 2e-16 ***
origin_id202   1.5595439  0.0607036    25.691  &lt; 2e-16 ***
origin_id203   2.6836892  0.0562500    47.710  &lt; 2e-16 ***
origin_id204   2.6077188  0.0554876    46.996  &lt; 2e-16 ***
origin_id205   0.4696809  0.0577475     8.133 4.18e-16 ***
origin_id226   1.9901409  0.0653222    30.467  &lt; 2e-16 ***
origin_id227   1.3804902  0.0622143    22.189  &lt; 2e-16 ***
origin_id228   1.2483627  0.0622220    20.063  &lt; 2e-16 ***
origin_id229   1.0888721  0.0564290    19.296  &lt; 2e-16 ***
origin_id230   0.4360950  0.0566375     7.700 1.36e-14 ***
origin_id231   0.4541361  0.0598756     7.585 3.33e-14 ***
origin_id252   2.4538088  0.0561692    43.686  &lt; 2e-16 ***
origin_id253   1.7807340  0.0550110    32.370  &lt; 2e-16 ***
origin_id254   1.5365004  0.0557218    27.574  &lt; 2e-16 ***
origin_id275  -0.0633314  0.1078886    -0.587 0.557199    
origin_id277   0.9390816  0.0582056    16.134  &lt; 2e-16 ***
origin_id278   1.0011614  0.0554226    18.064  &lt; 2e-16 ***
origin_id300  -0.8263283  0.0725323   -11.393  &lt; 2e-16 ***
origin_id301   1.2913182  0.0550936    23.439  &lt; 2e-16 ***
origin_id302  -1.1043270  0.0755035   -14.626  &lt; 2e-16 ***
origin_id324   1.7066703  0.0569151    29.986  &lt; 2e-16 ***
origin_id325   1.5453319  0.0552665    27.961  &lt; 2e-16 ***
origin_id326   0.5041696  0.0575205     8.765  &lt; 2e-16 ***
origin_id347   3.2699708  0.0558851    58.512  &lt; 2e-16 ***
origin_id348   0.9229895  0.0558588    16.524  &lt; 2e-16 ***
origin_id349   1.1727112  0.0557047    21.052  &lt; 2e-16 ***
origin_id372   2.3794192  0.0554793    42.888  &lt; 2e-16 ***
origin_id373   0.2151838  0.0574904     3.743 0.000182 ***
origin_id395   0.8146969  0.0634973    12.830  &lt; 2e-16 ***
origin_id396   1.0474946  0.0599431    17.475  &lt; 2e-16 ***
origin_id397  -2.4459013  0.1218521   -20.073  &lt; 2e-16 ***
origin_id419   3.0012455  0.0563425    53.268  &lt; 2e-16 ***
origin_id420   1.9821321  0.0559372    35.435  &lt; 2e-16 ***
origin_id421   1.5525096  0.0549202    28.268  &lt; 2e-16 ***
origin_id444   2.1686741  0.0555555    39.036  &lt; 2e-16 ***
origin_id445   1.2011016  0.0551131    21.793  &lt; 2e-16 ***
origin_id468   2.2997478  0.0554870    41.447  &lt; 2e-16 ***
origin_id469   0.7224271  0.0553070    13.062  &lt; 2e-16 ***
origin_id471   1.0943319  0.0554524    19.735  &lt; 2e-16 ***
origin_id491   1.8156970  0.0583995    31.091  &lt; 2e-16 ***
origin_id492   1.7871246  0.0557087    32.080  &lt; 2e-16 ***
origin_id493   2.6281571  0.0544557    48.262  &lt; 2e-16 ***
origin_id494   2.2997765  0.0546506    42.081  &lt; 2e-16 ***
origin_id495   0.2598181  0.0579806     4.481 7.43e-06 ***
origin_id516   0.4723735  0.0587901     8.035 9.36e-16 ***
origin_id517   1.2540206  0.0548259    22.873  &lt; 2e-16 ***
origin_id519   2.3235909  0.0545533    42.593  &lt; 2e-16 ***
origin_id539   0.7558068  0.0632787    11.944  &lt; 2e-16 ***
origin_id540   1.0325602  0.0561624    18.385  &lt; 2e-16 ***
origin_id541   0.7043440  0.0548794    12.834  &lt; 2e-16 ***
origin_id542   1.5241657  0.0545764    27.927  &lt; 2e-16 ***
origin_id543   1.4048290  0.0553599    25.376  &lt; 2e-16 ***
origin_id564   0.5953148  0.0608725     9.780  &lt; 2e-16 ***
origin_id565   0.4644831  0.0559128     8.307  &lt; 2e-16 ***
origin_id566  -0.1125573  0.0553079    -2.035 0.041840 *  
origin_id567   0.3224727  0.0552639     5.835 5.37e-09 ***
origin_id568  -1.1447378  0.0663127   -17.263  &lt; 2e-16 ***
origin_id588   2.9909545  0.0547601    54.619  &lt; 2e-16 ***
origin_id589   1.1607746  0.0548070    21.179  &lt; 2e-16 ***
origin_id590   1.1641023  0.0545063    21.357  &lt; 2e-16 ***
origin_id591   1.0604952  0.0550522    19.263  &lt; 2e-16 ***
origin_id592   1.2238267  0.0556336    21.998  &lt; 2e-16 ***
origin_id593  -1.0544334  0.0734361   -14.359  &lt; 2e-16 ***
origin_id612   2.2397357  0.0555518    40.318  &lt; 2e-16 ***
origin_id613   1.0162560  0.0561217    18.108  &lt; 2e-16 ***
origin_id614   1.8967419  0.0544202    34.854  &lt; 2e-16 ***
origin_id615   1.0818986  0.0545401    19.837  &lt; 2e-16 ***
origin_id617   0.6454374  0.0565477    11.414  &lt; 2e-16 ***
origin_id618  -3.8830195  0.3208926   -12.101  &lt; 2e-16 ***
origin_id619  -0.8729323  0.0782590   -11.154  &lt; 2e-16 ***
origin_id620   1.8996485  0.0565423    33.597  &lt; 2e-16 ***
origin_id636   1.1080046  0.0575030    19.269  &lt; 2e-16 ***
origin_id637   0.8388214  0.0556788    15.065  &lt; 2e-16 ***
origin_id638   3.4875412  0.0543356    64.185  &lt; 2e-16 ***
origin_id639   0.9003267  0.0546966    16.460  &lt; 2e-16 ***
origin_id640  -3.1910248  0.1151683   -27.707  &lt; 2e-16 ***
origin_id642  -1.0938012  0.0750594   -14.572  &lt; 2e-16 ***
origin_id643  -2.6713373  1.0017225    -2.667 0.007659 ** 
origin_id644   0.0604681  0.0673202     0.898 0.369070    
origin_id661   1.7528364  0.0556066    31.522  &lt; 2e-16 ***
origin_id662   0.4380216  0.0547053     8.007 1.18e-15 ***
origin_id663   1.1326765  0.0544930    20.786  &lt; 2e-16 ***
origin_id669  -2.4197948  0.1735207   -13.945  &lt; 2e-16 ***
origin_id670   0.5578301  0.0662343     8.422  &lt; 2e-16 ***
origin_id684   0.8020409  0.0559993    14.322  &lt; 2e-16 ***
origin_id685   1.4534613  0.0547762    26.535  &lt; 2e-16 ***
origin_id686   0.1958761  0.0547091     3.580 0.000343 ***
origin_id688  -4.3822226  0.2072773   -21.142  &lt; 2e-16 ***
origin_id693  -0.5161882  0.0754889    -6.838 8.03e-12 ***
origin_id710   0.2793063  0.0551263     5.067 4.05e-07 ***
origin_id711   1.4616807  0.0544890    26.825  &lt; 2e-16 ***
origin_id713   0.8106556  0.0553547    14.645  &lt; 2e-16 ***
origin_id732   1.9649977  0.0547438    35.894  &lt; 2e-16 ***
origin_id733   1.0968864  0.0546684    20.064  &lt; 2e-16 ***
origin_id734   2.4729966  0.0543885    45.469  &lt; 2e-16 ***
origin_id735   0.3366792  0.0556181     6.053 1.42e-09 ***
origin_id756   1.6581421  0.0555616    29.843  &lt; 2e-16 ***
origin_id757  -0.1438601  0.0557066    -2.582 0.009810 ** 
origin_id758   1.2941630  0.0545644    23.718  &lt; 2e-16 ***
origin_id759   1.7216446  0.0544432    31.623  &lt; 2e-16 ***
origin_id761   1.2084562  0.0550437    21.954  &lt; 2e-16 ***
origin_id780   0.0494421  0.0565710     0.874 0.382128    
origin_id781   1.4349883  0.0545830    26.290  &lt; 2e-16 ***
origin_id782  -0.7457100  0.0558496   -13.352  &lt; 2e-16 ***
origin_id783  -0.7562474  0.0576121   -13.127  &lt; 2e-16 ***
origin_id804   1.5119676  0.0552038    27.389  &lt; 2e-16 ***
origin_id807   1.2959304  0.0545219    23.769  &lt; 2e-16 ***
origin_id809  -1.9535454  0.0609121   -32.072  &lt; 2e-16 ***
origin_id828   1.6652468  0.0548627    30.353  &lt; 2e-16 ***
origin_id830   1.4431875  0.0544711    26.495  &lt; 2e-16 ***
origin_id831   0.5321597  0.0550144     9.673  &lt; 2e-16 ***
origin_id837  -0.8554300  0.0696443   -12.283  &lt; 2e-16 ***
origin_id852   0.8780000  0.0558955    15.708  &lt; 2e-16 ***
origin_id853   1.5518888  0.0547416    28.349  &lt; 2e-16 ***
origin_id854   2.5277221  0.0543898    46.474  &lt; 2e-16 ***
origin_id855   0.5484365  0.0546591    10.034  &lt; 2e-16 ***
origin_id856   0.4738350  0.0550555     8.606  &lt; 2e-16 ***
origin_id857   1.3485562  0.0545666    24.714  &lt; 2e-16 ***
origin_id858  -1.1824394  0.0579623   -20.400  &lt; 2e-16 ***
origin_id875  -0.9400031  0.0675156   -13.923  &lt; 2e-16 ***
origin_id877  -0.2047806  0.0552235    -3.708 0.000209 ***
origin_id878   0.9050163  0.0545897    16.579  &lt; 2e-16 ***
origin_id879   1.0704891  0.0547006    19.570  &lt; 2e-16 ***
origin_id880  -2.4529883  0.0628459   -39.032  &lt; 2e-16 ***
origin_id881   2.7627624  0.0543928    50.793  &lt; 2e-16 ***
origin_id882   0.5892924  0.0549154    10.731  &lt; 2e-16 ***
origin_id885   0.3230583  0.0602623     5.361 8.28e-08 ***
origin_id901   1.4974488  0.0545670    27.442  &lt; 2e-16 ***
origin_id902   1.8375228  0.0544613    33.740  &lt; 2e-16 ***
origin_id903   1.1954100  0.0544968    21.935  &lt; 2e-16 ***
origin_id904   0.5739320  0.0547591    10.481  &lt; 2e-16 ***
origin_id905   0.5811829  0.0546647    10.632  &lt; 2e-16 ***
origin_id906   0.0732290  0.0549736     1.332 0.182835    
origin_id907   0.4795240  0.0551664     8.692  &lt; 2e-16 ***
origin_id909  -0.3104165  0.0601367    -5.162 2.45e-07 ***
origin_id923   1.9997261  0.0549668    36.381  &lt; 2e-16 ***
origin_id924   1.6936181  0.0546344    30.999  &lt; 2e-16 ***
origin_id925   1.7536320  0.0545416    32.152  &lt; 2e-16 ***
origin_id926  -0.1623169  0.0553399    -2.933 0.003356 ** 
origin_id927   0.9816925  0.0545204    18.006  &lt; 2e-16 ***
origin_id928   0.3915470  0.0547075     7.157 8.24e-13 ***
origin_id929   0.2688247  0.0546950     4.915 8.88e-07 ***
origin_id930   2.2736330  0.0545037    41.715  &lt; 2e-16 ***
origin_id931  -1.6759734  0.0663509   -25.259  &lt; 2e-16 ***
origin_id932   0.3168580  0.0568816     5.570 2.54e-08 ***
origin_id933   0.4632754  0.0574457     8.065 7.35e-16 ***
origin_id948   0.3466546  0.0567500     6.108 1.01e-09 ***
origin_id949   0.4330770  0.0553083     7.830 4.87e-15 ***
origin_id950   2.2249639  0.0546261    40.731  &lt; 2e-16 ***
origin_id951   2.2924382  0.0544028    42.138  &lt; 2e-16 ***
origin_id952   1.9344523  0.0545105    35.488  &lt; 2e-16 ***
origin_id953   0.4628321  0.0546368     8.471  &lt; 2e-16 ***
origin_id954  -0.7562107  0.0557060   -13.575  &lt; 2e-16 ***
origin_id955   0.8460853  0.0547876    15.443  &lt; 2e-16 ***
origin_id956  -0.3428934  0.0564604    -6.073 1.25e-09 ***
origin_id957   0.1984308  0.0572283     3.467 0.000526 ***
origin_id972   0.7924157  0.0547446    14.475  &lt; 2e-16 ***
origin_id973   0.7999149  0.0547878    14.600  &lt; 2e-16 ***
origin_id974   1.8093533  0.0545063    33.195  &lt; 2e-16 ***
origin_id975  -0.3140375  0.0553303    -5.676 1.38e-08 ***
origin_id976  -0.3295194  0.0570953    -5.771 7.86e-09 ***
origin_id977   0.9047283  0.0545273    16.592  &lt; 2e-16 ***
origin_id978  -0.7233700  0.0567500   -12.747  &lt; 2e-16 ***
origin_id979   1.7187771  0.0546207    31.468  &lt; 2e-16 ***
origin_id980   0.8349918  0.0548279    15.229  &lt; 2e-16 ***
origin_id981   1.0339222  0.0562580    18.378  &lt; 2e-16 ***
origin_id996   1.3586302  0.0545744    24.895  &lt; 2e-16 ***
origin_id997   0.7378682  0.0547711    13.472  &lt; 2e-16 ***
origin_id998   1.4990357  0.0545984    27.456  &lt; 2e-16 ***
origin_id999   0.5096906  0.0547688     9.306  &lt; 2e-16 ***
origin_id1000 -0.4407102  0.0560183    -7.867 3.63e-15 ***
origin_id1001  2.3900352  0.0543944    43.939  &lt; 2e-16 ***
origin_id1002  0.1028505  0.0550369     1.869 0.061657 .  
origin_id1005 -2.1635110  0.0627528   -34.477  &lt; 2e-16 ***
origin_id1019  2.1809434  0.0545252    39.999  &lt; 2e-16 ***
origin_id1020  3.5249400  0.0543709    64.831  &lt; 2e-16 ***
origin_id1021  1.1434941  0.0550107    20.787  &lt; 2e-16 ***
origin_id1022 -0.2879421  0.0561005    -5.133 2.86e-07 ***
origin_id1023  0.6050490  0.0548272    11.036  &lt; 2e-16 ***
origin_id1024 -0.2929993  0.0552818    -5.300 1.16e-07 ***
origin_id1025  1.3073515  0.0544737    24.000  &lt; 2e-16 ***
origin_id1027  0.2431866  0.0579362     4.197 2.70e-05 ***
origin_id1028  2.4839364  0.0545238    45.557  &lt; 2e-16 ***
origin_id1029 -0.8159247  0.0559535   -14.582  &lt; 2e-16 ***
origin_id1043  2.0261239  0.0545526    37.141  &lt; 2e-16 ***
origin_id1044  1.7346682  0.0544770    31.842  &lt; 2e-16 ***
origin_id1045  0.6168986  0.0548241    11.252  &lt; 2e-16 ***
origin_id1046 -0.1570329  0.0569155    -2.759 0.005797 ** 
origin_id1047  0.1251397  0.0551111     2.271 0.023166 *  
origin_id1048  1.4742171  0.0545566    27.022  &lt; 2e-16 ***
origin_id1049  0.7800936  0.0545914    14.290  &lt; 2e-16 ***
origin_id1050  0.6650448  0.0548134    12.133  &lt; 2e-16 ***
origin_id1053 -0.3834886  0.0551483    -6.954 3.56e-12 ***
origin_id1054  2.2714412  0.0544782    41.695  &lt; 2e-16 ***
origin_id1066  1.7795117  0.0547073    32.528  &lt; 2e-16 ***
origin_id1067  2.3184704  0.0545087    42.534  &lt; 2e-16 ***
origin_id1068  0.1122628  0.0550450     2.039 0.041403 *  
origin_id1069  2.4846245  0.0544539    45.628  &lt; 2e-16 ***
origin_id1070  2.4754384  0.0544426    45.469  &lt; 2e-16 ***
origin_id1072 -0.0312338  0.0553248    -0.565 0.572378    
origin_id1073  0.3376255  0.0548349     6.157 7.41e-10 ***
origin_id1075  0.1776921  0.0580304     3.062 0.002198 ** 
origin_id1076 -0.2341369  0.0565778    -4.138 3.50e-05 ***
origin_id1077  0.2189364  0.0546910     4.003 6.25e-05 ***
origin_id1091  0.2905165  0.0582560     4.987 6.14e-07 ***
origin_id1092  1.6672943  0.0546162    30.527  &lt; 2e-16 ***
origin_id1093  0.4162722  0.0553183     7.525 5.27e-14 ***
origin_id1094  1.6192426  0.0545368    29.691  &lt; 2e-16 ***
origin_id1097  1.1191930  0.0546169    20.492  &lt; 2e-16 ***
origin_id1101  1.6859555  0.0544782    30.947  &lt; 2e-16 ***
origin_id1102  0.6786779  0.0545984    12.430  &lt; 2e-16 ***
origin_id1114  2.1320555  0.0545817    39.062  &lt; 2e-16 ***
origin_id1115  2.1238638  0.0545240    38.953  &lt; 2e-16 ***
origin_id1116  2.1929310  0.0547235    40.073  &lt; 2e-16 ***
origin_id1117  0.8755933  0.0551203    15.885  &lt; 2e-16 ***
origin_id1118  0.0999671  0.0555231     1.800 0.071788 .  
origin_id1123  1.4989914  0.0554567    27.030  &lt; 2e-16 ***
origin_id1125  0.2750729  0.0546488     5.033 4.82e-07 ***
origin_id1126 -2.4174133  0.0622274   -38.848  &lt; 2e-16 ***
origin_id1138  2.2361801  0.0546247    40.937  &lt; 2e-16 ***
origin_id1139  2.4069818  0.0545003    44.165  &lt; 2e-16 ***
origin_id1140  1.4936865  0.0546901    27.312  &lt; 2e-16 ***
origin_id1141  0.3949762  0.0556508     7.097 1.27e-12 ***
origin_id1142  1.8674978  0.0545611    34.228  &lt; 2e-16 ***
origin_id1149 -0.6751181  0.0552789   -12.213  &lt; 2e-16 ***
origin_id1150 -0.4023272  0.0550891    -7.303 2.81e-13 ***
origin_id1161  1.2251740  0.0551553    22.213  &lt; 2e-16 ***
origin_id1162  2.0101133  0.0547694    36.701  &lt; 2e-16 ***
origin_id1163  0.4209167  0.0552452     7.619 2.56e-14 ***
origin_id1164  0.6886877  0.0550565    12.509  &lt; 2e-16 ***
origin_id1171 -3.4123515  0.1637246   -20.842  &lt; 2e-16 ***
origin_id1172 -2.9045512  0.0775059   -37.475  &lt; 2e-16 ***
origin_id1173  3.5294803  0.0543888    64.893  &lt; 2e-16 ***
origin_id1174  0.0819686  0.0553432     1.481 0.138581    
origin_id1187  1.3562783  0.0550345    24.644  &lt; 2e-16 ***
origin_id1188  2.2766370  0.0544702    41.796  &lt; 2e-16 ***
origin_id1189  0.0735844  0.0563122     1.307 0.191307    
origin_id1190  0.2775354  0.0554116     5.009 5.48e-07 ***
origin_id1195  2.7613483  0.0551069    50.109  &lt; 2e-16 ***
origin_id1197  0.6628280  0.0546845    12.121  &lt; 2e-16 ***
origin_id1198  0.6254335  0.0546149    11.452  &lt; 2e-16 ***
origin_id1199  1.0362389  0.0573597    18.066  &lt; 2e-16 ***
origin_id1209  2.5464705  0.0545352    46.694  &lt; 2e-16 ***
origin_id1210  0.2644299  0.0587711     4.499 6.82e-06 ***
origin_id1211  2.1864136  0.0545034    40.115  &lt; 2e-16 ***
origin_id1212  1.3629712  0.0547286    24.904  &lt; 2e-16 ***
origin_id1213  1.4584247  0.0546754    26.674  &lt; 2e-16 ***
origin_id1220 -2.1037043  0.0651504   -32.290  &lt; 2e-16 ***
origin_id1221  0.4350982  0.0546223     7.966 1.64e-15 ***
origin_id1222  1.0673486  0.0545869    19.553  &lt; 2e-16 ***
origin_id1234  0.5499013  0.0552704     9.949  &lt; 2e-16 ***
origin_id1235  0.1740864  0.0553644     3.144 0.001664 ** 
origin_id1236  0.6590592  0.0549705    11.989  &lt; 2e-16 ***
origin_id1244  0.5959079  0.0582938    10.222  &lt; 2e-16 ***
origin_id1245  0.5890233  0.0548522    10.738  &lt; 2e-16 ***
origin_id1246  1.9637780  0.0544564    36.062  &lt; 2e-16 ***
origin_id1247  1.7249123  0.0546064    31.588  &lt; 2e-16 ***
origin_id1257  2.7726398  0.0544518    50.919  &lt; 2e-16 ***
origin_id1258  2.5195251  0.0544568    46.267  &lt; 2e-16 ***
origin_id1259  1.1936080  0.0547040    21.819  &lt; 2e-16 ***
origin_id1260  1.2387856  0.0548224    22.596  &lt; 2e-16 ***
origin_id1261  1.4542871  0.0547256    26.574  &lt; 2e-16 ***
origin_id1267 -0.7537520  0.0734292   -10.265  &lt; 2e-16 ***
origin_id1269  1.1999096  0.0545739    21.987  &lt; 2e-16 ***
origin_id1270  1.0980228  0.0546343    20.098  &lt; 2e-16 ***
origin_id1271  1.5027194  0.0548020    27.421  &lt; 2e-16 ***
origin_id1282  1.4447533  0.0547451    26.391  &lt; 2e-16 ***
origin_id1283  2.1199869  0.0545287    38.878  &lt; 2e-16 ***
origin_id1284  0.6415623  0.0553186    11.598  &lt; 2e-16 ***
origin_id1285  1.3310196  0.0547640    24.305  &lt; 2e-16 ***
origin_id1291 -2.0098534  0.0948700   -21.185  &lt; 2e-16 ***
origin_id1292 -0.0415011  0.0650367    -0.638 0.523397    
origin_id1294  1.0155946  0.0546263    18.592  &lt; 2e-16 ***
origin_id1295  1.4146420  0.0549815    25.729  &lt; 2e-16 ***
origin_id1305  1.4820823  0.0546637    27.113  &lt; 2e-16 ***
origin_id1306  2.2196666  0.0544899    40.735  &lt; 2e-16 ***
origin_id1307  0.2485689  0.0603627     4.118 3.82e-05 ***
origin_id1309  0.7411042  0.0551980    13.426  &lt; 2e-16 ***
origin_id1318  0.8259441  0.0546790    15.105  &lt; 2e-16 ***
origin_id1319  1.9101259  0.0545511    35.015  &lt; 2e-16 ***
origin_id1329  2.0608557  0.0545304    37.793  &lt; 2e-16 ***
origin_id1330  2.5905204  0.0544304    47.593  &lt; 2e-16 ***
origin_id1331  1.2426240  0.0547555    22.694  &lt; 2e-16 ***
origin_id1332  1.4348692  0.0548509    26.159  &lt; 2e-16 ***
origin_id1333  1.3658392  0.0547854    24.931  &lt; 2e-16 ***
origin_id1334 -2.0003972  0.1090228   -18.348  &lt; 2e-16 ***
origin_id1338 -3.2503599  0.1023709   -31.751  &lt; 2e-16 ***
origin_id1339  1.2212367  0.0549033    22.243  &lt; 2e-16 ***
origin_id1342  0.5426211  0.0548191     9.898  &lt; 2e-16 ***
origin_id1343  0.8582250  0.0548836    15.637  &lt; 2e-16 ***
origin_id1353  1.5799394  0.0546479    28.911  &lt; 2e-16 ***
origin_id1354  2.2320806  0.0544835    40.968  &lt; 2e-16 ***
origin_id1355  0.7568517  0.0561095    13.489  &lt; 2e-16 ***
origin_id1358 -1.4639226  0.0712578   -20.544  &lt; 2e-16 ***
origin_id1361 -0.6124614  0.0633770    -9.664  &lt; 2e-16 ***
origin_id1362  1.5356063  0.0548772    27.983  &lt; 2e-16 ***
origin_id1363 -0.9466347  0.0581514   -16.279  &lt; 2e-16 ***
origin_id1366  2.4184622  0.0544471    44.419  &lt; 2e-16 ***
origin_id1367  0.5960309  0.0552770    10.783  &lt; 2e-16 ***
origin_id1377  2.8975159  0.0544453    53.219  &lt; 2e-16 ***
origin_id1378  2.2577359  0.0544668    41.452  &lt; 2e-16 ***
origin_id1379  1.3282654  0.0546986    24.283  &lt; 2e-16 ***
origin_id1380  1.2907213  0.0548048    23.551  &lt; 2e-16 ***
origin_id1381  2.1605069  0.0545218    39.626  &lt; 2e-16 ***
origin_id1382 -0.7656349  0.0679165   -11.273  &lt; 2e-16 ***
origin_id1386 -1.6455973  0.0777558   -21.164  &lt; 2e-16 ***
origin_id1387 -2.4203162  0.0836030   -28.950  &lt; 2e-16 ***
origin_id1388 -0.7248484  0.0562109   -12.895  &lt; 2e-16 ***
origin_id1389  0.3597970  0.0549170     6.552 5.69e-11 ***
origin_id1390  0.4713534  0.0548123     8.599  &lt; 2e-16 ***
origin_id1391 -0.4291759  0.0558037    -7.691 1.46e-14 ***
origin_id1401  1.7870177  0.0545815    32.740  &lt; 2e-16 ***
origin_id1402  2.7838550  0.0544304    51.145  &lt; 2e-16 ***
origin_id1403  1.2413852  0.0547346    22.680  &lt; 2e-16 ***
origin_id1404  1.2527993  0.0549735    22.789  &lt; 2e-16 ***
origin_id1405 -1.8194234  0.0803331   -22.648  &lt; 2e-16 ***
origin_id1406 -3.5580168  0.2154883   -16.511  &lt; 2e-16 ***
origin_id1407 -0.3837672  0.0567515    -6.762 1.36e-11 ***
origin_id1408  0.0793830  0.0559462     1.419 0.155923    
origin_id1409  1.7980402  0.0546760    32.885  &lt; 2e-16 ***
origin_id1410 -2.7409129  0.0978855   -28.001  &lt; 2e-16 ***
origin_id1411 -2.1509827  0.0633825   -33.937  &lt; 2e-16 ***
origin_id1412  0.0308255  0.0550158     0.560 0.575272    
origin_id1413  0.4486120  0.0548108     8.185 2.73e-16 ***
origin_id1414  0.5163364  0.0548623     9.412  &lt; 2e-16 ***
origin_id1425 -1.5814179  0.0640506   -24.690  &lt; 2e-16 ***
origin_id1426  0.8668690  0.0548557    15.803  &lt; 2e-16 ***
origin_id1427  1.5665226  0.0545865    28.698  &lt; 2e-16 ***
origin_id1428  2.7141017  0.0544391    49.856  &lt; 2e-16 ***
origin_id1429  0.8559142  0.0555047    15.421  &lt; 2e-16 ***
origin_id1432  0.8781084  0.0549063    15.993  &lt; 2e-16 ***
origin_id1433  0.4338103  0.0551637     7.864 3.72e-15 ***
origin_id1434 -3.1955176  0.1465720   -21.802  &lt; 2e-16 ***
origin_id1435  0.1142663  0.0579847     1.971 0.048766 *  
origin_id1436  2.7923788  0.0544237    51.308  &lt; 2e-16 ***
origin_id1437  2.2382905  0.0544425    41.113  &lt; 2e-16 ***
origin_id1438  1.5143313  0.0546051    27.732  &lt; 2e-16 ***
origin_id1439 -1.1819406  0.0585062   -20.202  &lt; 2e-16 ***
origin_id1449  1.4064914  0.0546577    25.733  &lt; 2e-16 ***
origin_id1450  1.7354610  0.0545481    31.815  &lt; 2e-16 ***
origin_id1451  3.0870138  0.0544040    56.742  &lt; 2e-16 ***
origin_id1452  1.9470858  0.0545327    35.705  &lt; 2e-16 ***
origin_id1453  0.6843717  0.0550811    12.425  &lt; 2e-16 ***
origin_id1454  1.0934875  0.0547582    19.969  &lt; 2e-16 ***
origin_id1455  1.4750642  0.0546327    27.000  &lt; 2e-16 ***
origin_id1456  1.5152029  0.0546114    27.745  &lt; 2e-16 ***
origin_id1457  0.4123356  0.0551897     7.471 7.94e-14 ***
origin_id1458 -0.4383213  0.0580997    -7.544 4.55e-14 ***
origin_id1459 -1.7860307  0.0607421   -29.404  &lt; 2e-16 ***
origin_id1460  1.2853463  0.0545070    23.581  &lt; 2e-16 ***
origin_id1461  0.7697071  0.0546555    14.083  &lt; 2e-16 ***
origin_id1462  0.2478743  0.0555277     4.464 8.05e-06 ***
origin_id1463  0.3724600  0.0591495     6.297 3.04e-10 ***
origin_id1474  2.4782875  0.0544501    45.515  &lt; 2e-16 ***
origin_id1475  1.4533284  0.0547277    26.556  &lt; 2e-16 ***
origin_id1477  1.4407771  0.0546689    26.355  &lt; 2e-16 ***
origin_id1478  1.2206767  0.0546851    22.322  &lt; 2e-16 ***
origin_id1479  1.0266602  0.0547112    18.765  &lt; 2e-16 ***
origin_id1480  1.0610082  0.0546567    19.412  &lt; 2e-16 ***
origin_id1481  1.0960297  0.0547323    20.025  &lt; 2e-16 ***
origin_id1482  0.4199918  0.0552470     7.602 2.91e-14 ***
origin_id1484  0.7308692  0.0547385    13.352  &lt; 2e-16 ***
origin_id1485  1.7461089  0.0544896    32.045  &lt; 2e-16 ***
origin_id1486  0.2706289  0.0557617     4.853 1.21e-06 ***
origin_id1487 -0.9437423  0.0638906   -14.771  &lt; 2e-16 ***
origin_id1497  2.2567029  0.0545026    41.405  &lt; 2e-16 ***
origin_id1498  2.6178500  0.0544370    48.089  &lt; 2e-16 ***
origin_id1499  2.3427527  0.0544529    43.023  &lt; 2e-16 ***
origin_id1500  1.5301022  0.0545860    28.031  &lt; 2e-16 ***
origin_id1501  2.1258853  0.0544551    39.039  &lt; 2e-16 ***
origin_id1502  0.7190206  0.0548868    13.100  &lt; 2e-16 ***
origin_id1503  1.2562385  0.0546355    22.993  &lt; 2e-16 ***
origin_id1504  1.7950519  0.0544763    32.951  &lt; 2e-16 ***
origin_id1505  2.1853307  0.0544803    40.112  &lt; 2e-16 ***
origin_id1508  1.1657167  0.0546213    21.342  &lt; 2e-16 ***
origin_id1509  1.6816793  0.0546069    30.796  &lt; 2e-16 ***
origin_id1522  2.6586901  0.0544320    48.844  &lt; 2e-16 ***
origin_id1523  2.1037779  0.0544687    38.624  &lt; 2e-16 ***
origin_id1524  2.1452196  0.0545304    39.340  &lt; 2e-16 ***
origin_id1525  1.9677638  0.0545721    36.058  &lt; 2e-16 ***
origin_id1526  3.0508127  0.0543932    56.088  &lt; 2e-16 ***
origin_id1527  2.8166207  0.0544092    51.767  &lt; 2e-16 ***
origin_id1528  0.4787855  0.0548021     8.737  &lt; 2e-16 ***
origin_id1529  1.0995282  0.0545788    20.146  &lt; 2e-16 ***
origin_id1530  2.4086754  0.0544785    44.213  &lt; 2e-16 ***
origin_id1532  0.0521258  0.0553025     0.943 0.345907    
origin_id1533  0.8925795  0.0547590    16.300  &lt; 2e-16 ***
origin_id1545  0.8964651  0.0550935    16.272  &lt; 2e-16 ***
origin_id1546  2.2654242  0.0544649    41.594  &lt; 2e-16 ***
origin_id1547  2.2032086  0.0544527    40.461  &lt; 2e-16 ***
origin_id1548  0.6845268  0.0553960    12.357  &lt; 2e-16 ***
origin_id1549  1.6556031  0.0544908    30.383  &lt; 2e-16 ***
origin_id1550  1.6739946  0.0544849    30.724  &lt; 2e-16 ***
origin_id1551  0.6798867  0.0547060    12.428  &lt; 2e-16 ***
origin_id1552  3.1927873  0.0543886    58.703  &lt; 2e-16 ***
origin_id1556  0.5850790  0.0549502    10.647  &lt; 2e-16 ***
origin_id1570  2.3999508  0.0544957    44.039  &lt; 2e-16 ***
origin_id1571  2.7480393  0.0544173    50.499  &lt; 2e-16 ***
origin_id1572  2.2714502  0.0544639    41.706  &lt; 2e-16 ***
origin_id1573  1.7244722  0.0545627    31.605  &lt; 2e-16 ***
origin_id1574  1.7200859  0.0545247    31.547  &lt; 2e-16 ***
origin_id1575  1.1229323  0.0549891    20.421  &lt; 2e-16 ***
origin_id1576  1.5926879  0.0545003    29.223  &lt; 2e-16 ***
origin_id1577  1.8703441  0.0545003    34.318  &lt; 2e-16 ***
origin_id1578  0.3706907  0.0554912     6.680 2.39e-11 ***
origin_id1581 -1.3684283  0.0594578   -23.015  &lt; 2e-16 ***
origin_id1593 -0.4003704  0.3117159    -1.284 0.198999    
origin_id1594  1.3078162  0.0547968    23.867  &lt; 2e-16 ***
origin_id1595  2.6586899  0.0544236    48.852  &lt; 2e-16 ***
origin_id1596  2.2747927  0.0544508    41.777  &lt; 2e-16 ***
origin_id1597  1.3357932  0.0545473    24.489  &lt; 2e-16 ***
origin_id1598  1.2097151  0.0546096    22.152  &lt; 2e-16 ***
origin_id1599 -0.6411760  0.0559921   -11.451  &lt; 2e-16 ***
origin_id1600  1.2062595  0.0545964    22.094  &lt; 2e-16 ***
origin_id1603 -1.5918566  0.0647347   -24.590  &lt; 2e-16 ***
origin_id1618  1.7514358  0.0551019    31.785  &lt; 2e-16 ***
origin_id1619  0.8361854  0.0551689    15.157  &lt; 2e-16 ***
origin_id1620  2.3169019  0.0544464    42.554  &lt; 2e-16 ***
origin_id1621  2.0968509  0.0544728    38.494  &lt; 2e-16 ***
origin_id1622  1.1969004  0.0548965    21.803  &lt; 2e-16 ***
origin_id1623  0.2352650  0.0552440     4.259 2.06e-05 ***
origin_id1624  0.8968345  0.0548160    16.361  &lt; 2e-16 ***
origin_id1625  0.9618373  0.0547265    17.575  &lt; 2e-16 ***
origin_id1626 -0.2742943  0.0560989    -4.889 1.01e-06 ***
origin_id1627  0.2110230  0.0559859     3.769 0.000164 ***
origin_id1628  0.8768123  0.0554073    15.825  &lt; 2e-16 ***
origin_id1641 -1.5346089  0.1591391    -9.643  &lt; 2e-16 ***
origin_id1643  1.1420794  0.0549768    20.774  &lt; 2e-16 ***
origin_id1644  1.4805743  0.0545777    27.128  &lt; 2e-16 ***
origin_id1645  1.9939852  0.0544624    36.612  &lt; 2e-16 ***
origin_id1646 -0.3704289  0.0558462    -6.633 3.29e-11 ***
origin_id1647  0.5301591  0.0548183     9.671  &lt; 2e-16 ***
origin_id1648  1.3775942  0.0545828    25.239  &lt; 2e-16 ***
origin_id1649  1.1500387  0.0546738    21.035  &lt; 2e-16 ***
origin_id1650 -2.0421492  0.0681393   -29.970  &lt; 2e-16 ***
origin_id1651 -0.4026697  0.0568244    -7.086 1.38e-12 ***
origin_id1652 -0.4313835  0.0589167    -7.322 2.44e-13 ***
origin_id1666 -2.4382609  0.3064013    -7.958 1.75e-15 ***
origin_id1667  0.8404478  0.0567283    14.815  &lt; 2e-16 ***
origin_id1668  1.3929664  0.0545894    25.517  &lt; 2e-16 ***
origin_id1669  1.6734049  0.0545466    30.678  &lt; 2e-16 ***
origin_id1670  2.0127828  0.0544959    36.935  &lt; 2e-16 ***
origin_id1671  3.4071077  0.0543861    62.647  &lt; 2e-16 ***
origin_id1672  0.2588110  0.0549504     4.710 2.48e-06 ***
origin_id1673  2.1349093  0.0544468    39.211  &lt; 2e-16 ***
origin_id1674  1.1743108  0.0546425    21.491  &lt; 2e-16 ***
origin_id1675  1.6251822  0.0545983    29.766  &lt; 2e-16 ***
origin_id1676 -0.3910580  0.0609566    -6.415 1.40e-10 ***
origin_id1691  1.5715265  0.0555635    28.283  &lt; 2e-16 ***
origin_id1692  1.9963762  0.0544754    36.647  &lt; 2e-16 ***
origin_id1693  2.5390415  0.0544803    46.605  &lt; 2e-16 ***
origin_id1694 -0.2332901  0.0555212    -4.202 2.65e-05 ***
origin_id1695  1.4388740  0.0545236    26.390  &lt; 2e-16 ***
origin_id1696  1.2187664  0.0545647    22.336  &lt; 2e-16 ***
origin_id1697  0.4696747  0.0547610     8.577  &lt; 2e-16 ***
origin_id1698  0.7157684  0.0548604    13.047  &lt; 2e-16 ***
origin_id1699 -0.8935332  0.0582794   -15.332  &lt; 2e-16 ***
origin_id1715 -0.4658091  0.0605049    -7.699 1.37e-14 ***
origin_id1716  1.1060208  0.0547217    20.212  &lt; 2e-16 ***
origin_id1717  0.9545508  0.0547136    17.446  &lt; 2e-16 ***
origin_id1718  1.5799975  0.0546452    28.914  &lt; 2e-16 ***
origin_id1719  0.7665287  0.0547161    14.009  &lt; 2e-16 ***
origin_id1721  1.9637302  0.0544527    36.063  &lt; 2e-16 ***
origin_id1722  0.9265723  0.0547544    16.922  &lt; 2e-16 ***
origin_id1739  1.1698300  0.0548869    21.313  &lt; 2e-16 ***
origin_id1740  2.0914412  0.0544664    38.399  &lt; 2e-16 ***
origin_id1741  1.9867105  0.0544844    36.464  &lt; 2e-16 ***
origin_id1742  1.6627568  0.0545451    30.484  &lt; 2e-16 ***
origin_id1743  0.5000847  0.0548726     9.114  &lt; 2e-16 ***
origin_id1744  0.7284047  0.0547124    13.313  &lt; 2e-16 ***
origin_id1745  0.8280717  0.0547124    15.135  &lt; 2e-16 ***
origin_id1746 -0.2945186  0.0558150    -5.277 1.32e-07 ***
origin_id1764  1.8992758  0.0545296    34.830  &lt; 2e-16 ***
origin_id1765  0.9602828  0.0547186    17.549  &lt; 2e-16 ***
origin_id1766  1.9777268  0.0544911    36.294  &lt; 2e-16 ***
origin_id1767  0.6444180  0.0550371    11.709  &lt; 2e-16 ***
origin_id1768  1.9285729  0.0544736    35.404  &lt; 2e-16 ***
origin_id1769  1.6688507  0.0544764    30.634  &lt; 2e-16 ***
origin_id1770  0.2494278  0.0551287     4.524 6.05e-06 ***
origin_id1787  0.9549691  0.0551914    17.303  &lt; 2e-16 ***
origin_id1788  1.4859757  0.0545532    27.239  &lt; 2e-16 ***
origin_id1789  2.1762898  0.0544613    39.960  &lt; 2e-16 ***
origin_id1790  0.7872789  0.0548896    14.343  &lt; 2e-16 ***
origin_id1791  1.6272172  0.0545424    29.834  &lt; 2e-16 ***
origin_id1792  2.4726127  0.0544089    45.445  &lt; 2e-16 ***
origin_id1793  1.7461792  0.0544589    32.064  &lt; 2e-16 ***
origin_id1794  1.1010342  0.0546300    20.154  &lt; 2e-16 ***
origin_id1812  0.8287975  0.0548215    15.118  &lt; 2e-16 ***
origin_id1813  2.3144764  0.0544525    42.504  &lt; 2e-16 ***
origin_id1814  2.0201502  0.0545661    37.022  &lt; 2e-16 ***
origin_id1815  1.2191587  0.0547767    22.257  &lt; 2e-16 ***
origin_id1816  1.7144771  0.0544917    31.463  &lt; 2e-16 ***
origin_id1817  1.1481299  0.0545439    21.050  &lt; 2e-16 ***
origin_id1818  2.6239308  0.0544048    48.230  &lt; 2e-16 ***
origin_id1819  1.1303358  0.0546445    20.685  &lt; 2e-16 ***
origin_id1835  1.5705422  0.0546361    28.746  &lt; 2e-16 ***
origin_id1836  2.1035642  0.0544652    38.622  &lt; 2e-16 ***
origin_id1837  1.9748305  0.0545360    36.211  &lt; 2e-16 ***
origin_id1838  1.0181138  0.0553255    18.402  &lt; 2e-16 ***
origin_id1839  0.0784777  0.0658889     1.191 0.233629    
origin_id1840  1.0928374  0.0545849    20.021  &lt; 2e-16 ***
origin_id1841  0.4493240  0.0547238     8.211  &lt; 2e-16 ***
origin_id1842  1.0143745  0.0545350    18.600  &lt; 2e-16 ***
origin_id1843  0.1633970  0.0554012     2.949 0.003185 ** 
origin_id1860  1.8149792  0.0545724    33.258  &lt; 2e-16 ***
origin_id1861  2.4452624  0.0544477    44.910  &lt; 2e-16 ***
origin_id1862  2.5317132  0.0544400    46.505  &lt; 2e-16 ***
origin_id1863  3.2215999  0.0547716    58.819  &lt; 2e-16 ***
origin_id1864 -0.8533975  0.0587646   -14.522  &lt; 2e-16 ***
origin_id1865  0.8900432  0.0547327    16.262  &lt; 2e-16 ***
origin_id1866  0.8025177  0.0545849    14.702  &lt; 2e-16 ***
origin_id1867  2.2908228  0.0544247    42.092  &lt; 2e-16 ***
origin_id1868 -0.1901949  0.0588843    -3.230 0.001238 ** 
origin_id1883  2.5135171  0.0544700    46.145  &lt; 2e-16 ***
origin_id1884  1.2443284  0.0546488    22.770  &lt; 2e-16 ***
origin_id1885  1.9256411  0.0545021    35.331  &lt; 2e-16 ***
origin_id1889 -0.4367225  0.0555259    -7.865 3.68e-15 ***
origin_id1890  2.4610048  0.0544207    45.222  &lt; 2e-16 ***
origin_id1891 -0.1091435  0.0561327    -1.944 0.051849 .  
origin_id1908  1.5302455  0.0545791    28.037  &lt; 2e-16 ***
origin_id1909  1.1549470  0.0546921    21.117  &lt; 2e-16 ***
origin_id1910  2.0286512  0.0545153    37.213  &lt; 2e-16 ***
origin_id1912  1.2975123  0.0557128    23.289  &lt; 2e-16 ***
origin_id1913 -2.7077530  0.1142681   -23.696  &lt; 2e-16 ***
origin_id1914  0.3189645  0.0548825     5.812 6.18e-09 ***
origin_id1915  0.6241071  0.0546805    11.414  &lt; 2e-16 ***
origin_id1916  0.2894384  0.0574609     5.037 4.73e-07 ***
origin_id1931  0.5842435  0.0553703    10.552  &lt; 2e-16 ***
origin_id1932  0.0270104  0.0555683     0.486 0.626913    
origin_id1933  0.3574019  0.0552459     6.469 9.85e-11 ***
origin_id1934  0.2150337  0.0562093     3.826 0.000130 ***
origin_id1936  2.0806012  0.0550572    37.790  &lt; 2e-16 ***
origin_id1937 -3.5486846  0.3208863   -11.059  &lt; 2e-16 ***
origin_id1938  0.7060602  0.0546857    12.911  &lt; 2e-16 ***
origin_id1939  0.1732084  0.0566446     3.058 0.002230 ** 
origin_id1956  1.5835162  0.0546186    28.992  &lt; 2e-16 ***
origin_id1957  1.9125459  0.0545226    35.078  &lt; 2e-16 ***
origin_id1958  1.9990441  0.0545059    36.676  &lt; 2e-16 ***
origin_id1961  1.2517101  0.0561384    22.297  &lt; 2e-16 ***
origin_id1963 -0.3458344  0.0561757    -6.156 7.45e-10 ***
origin_id1980  0.7609526  0.0549501    13.848  &lt; 2e-16 ***
origin_id1981  1.2248300  0.0546812    22.399  &lt; 2e-16 ***
origin_id1984 -0.1849413  0.0599260    -3.086 0.002028 ** 
origin_id1985  0.5436394  0.0589460     9.223  &lt; 2e-16 ***
origin_id1986 -0.3299244  0.0564608    -5.843 5.11e-09 ***
origin_id2004  1.1650240  0.0548204    21.252  &lt; 2e-16 ***
origin_id2005  1.9058670  0.0544872    34.978  &lt; 2e-16 ***
origin_id2006  1.2343800  0.0546849    22.573  &lt; 2e-16 ***
origin_id2007  0.8816479  0.0551168    15.996  &lt; 2e-16 ***
origin_id2009  1.7751735  0.0558699    31.773  &lt; 2e-16 ***
origin_id2028  0.7492409  0.0549775    13.628  &lt; 2e-16 ***
origin_id2029  2.8013271  0.0544092    51.486  &lt; 2e-16 ***
origin_id2030 -0.2055879  0.0562435    -3.655 0.000257 ***
origin_id2031  0.9529258  0.0548312    17.379  &lt; 2e-16 ***
origin_id2032  1.2888088  0.0547108    23.557  &lt; 2e-16 ***
origin_id2052  0.6502737  0.0552804    11.763  &lt; 2e-16 ***
origin_id2053  2.7443055  0.0544242    50.424  &lt; 2e-16 ***
origin_id2054  1.8774519  0.0544896    34.455  &lt; 2e-16 ***
origin_id2055  2.2309927  0.0544753    40.954  &lt; 2e-16 ***
origin_id2056  1.4677496  0.0546092    26.877  &lt; 2e-16 ***
origin_id2057  2.2545609  0.0544828    41.381  &lt; 2e-16 ***
origin_id2076  1.0649404  0.0547348    19.456  &lt; 2e-16 ***
origin_id2077  1.3304537  0.0545595    24.385  &lt; 2e-16 ***
origin_id2078  0.4180012  0.0548748     7.617 2.59e-14 ***
origin_id2079  1.2448329  0.0546076    22.796  &lt; 2e-16 ***
origin_id2080 -1.0065569  0.0578186   -17.409  &lt; 2e-16 ***
origin_id2081  1.7606523  0.0545881    32.253  &lt; 2e-16 ***
origin_id2101  1.0764509  0.0547071    19.677  &lt; 2e-16 ***
origin_id2102  1.0275926  0.0547916    18.755  &lt; 2e-16 ***
origin_id2103  1.9982834  0.0544566    36.695  &lt; 2e-16 ***
origin_id2104  0.7040168  0.0548463    12.836  &lt; 2e-16 ***
origin_id2105  1.4345852  0.0546048    26.272  &lt; 2e-16 ***
origin_id2124  1.1563700  0.0548109    21.097  &lt; 2e-16 ***
origin_id2125  2.3676479  0.0544714    43.466  &lt; 2e-16 ***
origin_id2127  3.7931254  0.0543838    69.747  &lt; 2e-16 ***
origin_id2128  0.5656151  0.0553581    10.217  &lt; 2e-16 ***
origin_id2129  0.5162117  0.0551215     9.365  &lt; 2e-16 ***
origin_id2149 -0.0872908  0.0579417    -1.507 0.131932    
origin_id2150  1.8148919  0.0545334    33.280  &lt; 2e-16 ***
origin_id2151  0.9062567  0.0546653    16.578  &lt; 2e-16 ***
origin_id2152  0.1280865  0.0552618     2.318 0.020460 *  
origin_id2153  3.0107242  0.0544167    55.327  &lt; 2e-16 ***
origin_id2172  0.3610343  0.0556807     6.484 8.93e-11 ***
origin_id2173  0.8675892  0.0549123    15.800  &lt; 2e-16 ***
origin_id2174  2.3972847  0.0544687    44.012  &lt; 2e-16 ***
origin_id2175  2.2791323  0.0544399    41.865  &lt; 2e-16 ***
origin_id2176  1.5068662  0.0546019    27.597  &lt; 2e-16 ***
origin_id2197  1.1466585  0.0554982    20.661  &lt; 2e-16 ***
origin_id2198  1.5308427  0.0546888    27.992  &lt; 2e-16 ***
origin_id2199  1.0584165  0.0546653    19.362  &lt; 2e-16 ***
origin_id2200  1.0275810  0.0546506    18.803  &lt; 2e-16 ***
origin_id2201  1.5007999  0.0546203    27.477  &lt; 2e-16 ***
origin_id2221  0.8512604  0.0559480    15.215  &lt; 2e-16 ***
origin_id2222  1.5697718  0.0546703    28.713  &lt; 2e-16 ***
origin_id2223  1.8146282  0.0545138    33.288  &lt; 2e-16 ***
origin_id2224  1.4691312  0.0546041    26.905  &lt; 2e-16 ***
origin_id2246  2.7414038  0.0545930    50.215  &lt; 2e-16 ***
origin_id2247  0.8020890  0.0550975    14.558  &lt; 2e-16 ***
origin_id2248  1.2023270  0.0546593    21.997  &lt; 2e-16 ***
origin_id2249  0.8260369  0.0550063    15.017  &lt; 2e-16 ***
origin_id2269  1.1060059  0.0561708    19.690  &lt; 2e-16 ***
origin_id2270 -0.6303139  0.0645238    -9.769  &lt; 2e-16 ***
origin_id2271  2.0534849  0.0546063    37.605  &lt; 2e-16 ***
origin_id2272  1.1850815  0.0547968    21.627  &lt; 2e-16 ***
origin_id2294  1.7247044  0.0558741    30.868  &lt; 2e-16 ***
origin_id2295  2.2821000  0.0548660    41.594  &lt; 2e-16 ***
origin_id2296  0.4966766  0.0554549     8.956  &lt; 2e-16 ***
origin_id2297  2.0738611  0.0546302    37.962  &lt; 2e-16 ***
origin_id2319  0.9280267  0.0562476    16.499  &lt; 2e-16 ***
origin_id2320  0.3440931  0.0577183     5.962 2.50e-09 ***
origin_id2321  1.5335837  0.0550709    27.847  &lt; 2e-16 ***
origin_id2345  1.3004428  0.0550692    23.615  &lt; 2e-16 ***
origin_id2346  1.2133936  0.0554076    21.899  &lt; 2e-16 ***
origin_id2366  2.2822028  0.0547552    41.680  &lt; 2e-16 ***
origin_id2368  0.1178604  0.0596040     1.977 0.047998 *  
origin_id2391  0.6180241  0.0558645    11.063  &lt; 2e-16 ***
origin_id2392  2.7478503  0.0545993    50.328  &lt; 2e-16 ***
origin_id2394  2.3351611  0.0548356    42.585  &lt; 2e-16 ***
origin_id2412  2.3387986  0.0582785    40.131  &lt; 2e-16 ***
origin_id2415  2.9563743  0.0545811    54.165  &lt; 2e-16 ***
origin_id2441  3.4107589  0.0545760    62.496  &lt; 2e-16 ***
origin_id2442 -0.7961405  0.0659976   -12.063  &lt; 2e-16 ***
origin_id2460  0.3807495  0.0599642     6.350 2.16e-10 ***
origin_id2465  2.8217741  0.0547670    51.523  &lt; 2e-16 ***
origin_id2489  2.3111715  0.0561521    41.159  &lt; 2e-16 ***
origin_id2512  2.6772226  0.0593379    45.118  &lt; 2e-16 ***
origin_id2556  1.4460263  0.0609795    23.713  &lt; 2e-16 ***
destin_id131  -0.3472159  0.1212913    -2.863 0.004201 ** 
destin_id153   0.3953396  0.0990303     3.992 6.55e-05 ***
destin_id154   0.1687153  0.0916648     1.841 0.065685 .  
destin_id155   0.6758585  0.0901896     7.494 6.69e-14 ***
destin_id178  -1.3809908  0.1220348   -11.316  &lt; 2e-16 ***
destin_id179   0.2273421  0.0900597     2.524 0.011591 *  
destin_id180  -1.5403764  0.0998830   -15.422  &lt; 2e-16 ***
destin_id181  -1.7076632  0.1169330   -14.604  &lt; 2e-16 ***
destin_id201   2.8112089  0.0882474    31.856  &lt; 2e-16 ***
destin_id202  -1.5398777  0.1020998   -15.082  &lt; 2e-16 ***
destin_id203  -1.2337670  0.0996777   -12.378  &lt; 2e-16 ***
destin_id204   0.0385350  0.0920875     0.418 0.675610    
destin_id205  -1.8536756  0.1112939   -16.656  &lt; 2e-16 ***
destin_id226  -2.5097930  0.1198438   -20.942  &lt; 2e-16 ***
destin_id227  -0.9954453  0.1090388    -9.129  &lt; 2e-16 ***
destin_id228  -1.0029268  0.0947697   -10.583  &lt; 2e-16 ***
destin_id229  -0.0127521  0.0946281    -0.135 0.892801    
destin_id230  -0.2490242  0.0923612    -2.696 0.007014 ** 
destin_id231   0.3436506  0.0984901     3.489 0.000484 ***
destin_id252  -2.0248425  0.1250107   -16.197  &lt; 2e-16 ***
destin_id253   2.5557637  0.0884017    28.911  &lt; 2e-16 ***
destin_id254   2.8160443  0.0883661    31.868  &lt; 2e-16 ***
destin_id275  -0.0632744  0.2188500    -0.289 0.772488    
destin_id277  -0.8680358  0.1038182    -8.361  &lt; 2e-16 ***
destin_id278   0.1387291  0.0916383     1.514 0.130057    
destin_id300  -2.3371319  0.1143147   -20.445  &lt; 2e-16 ***
destin_id301   0.1609053  0.0907074     1.774 0.076081 .  
destin_id302  -1.9768644  0.1393297   -14.188  &lt; 2e-16 ***
destin_id324  -1.1564619  0.1059466   -10.916  &lt; 2e-16 ***
destin_id325   2.5923373  0.0883991    29.325  &lt; 2e-16 ***
destin_id326   0.3720756  0.0931437     3.995 6.48e-05 ***
destin_id347  -0.9921091  0.0988905   -10.032  &lt; 2e-16 ***
destin_id348  -0.8374498  0.0948318    -8.831  &lt; 2e-16 ***
destin_id349  -0.5079758  0.0995121    -5.105 3.31e-07 ***
destin_id372  -1.2171139  0.0948058   -12.838  &lt; 2e-16 ***
destin_id373   2.2554664  0.0886733    25.436  &lt; 2e-16 ***
destin_id395  -0.8225606  0.1067966    -7.702 1.34e-14 ***
destin_id396  -0.0974806  0.1021458    -0.954 0.339918    
destin_id397  -2.2071868  0.2117416   -10.424  &lt; 2e-16 ***
destin_id419   1.2079962  0.0922079    13.101  &lt; 2e-16 ***
destin_id420  -0.6630626  0.0928179    -7.144 9.09e-13 ***
destin_id421   0.9175840  0.0908425    10.101  &lt; 2e-16 ***
destin_id444  -0.4209173  0.0945416    -4.452 8.50e-06 ***
destin_id445   0.3297103  0.0913804     3.608 0.000308 ***
destin_id468  -0.6193652  0.0931968    -6.646 3.02e-11 ***
destin_id469  -1.2199415  0.0943577   -12.929  &lt; 2e-16 ***
destin_id471  -0.4217381  0.0959423    -4.396 1.10e-05 ***
destin_id491   0.5683912  0.1008080     5.638 1.72e-08 ***
destin_id492  -1.4424700  0.1016224   -14.194  &lt; 2e-16 ***
destin_id493   3.9268698  0.0882354    44.504  &lt; 2e-16 ***
destin_id494   1.3705680  0.0894062    15.330  &lt; 2e-16 ***
destin_id495   1.3942249  0.0911919    15.289  &lt; 2e-16 ***
destin_id516  -1.4018628  0.1011486   -13.859  &lt; 2e-16 ***
destin_id517   0.2015703  0.0911293     2.212 0.026973 *  
destin_id519   2.3787579  0.0887346    26.808  &lt; 2e-16 ***
destin_id539  -1.0216945  0.1126642    -9.068  &lt; 2e-16 ***
destin_id540  -0.7014177  0.0936614    -7.489 6.95e-14 ***
destin_id541   0.4551432  0.0899001     5.063 4.13e-07 ***
destin_id542   3.3728664  0.0883542    38.174  &lt; 2e-16 ***
destin_id543   2.0584653  0.0889126    23.152  &lt; 2e-16 ***
destin_id564  -0.9457972  0.1177020    -8.036 9.32e-16 ***
destin_id565  -0.2163016  0.0938426    -2.305 0.021170 *  
destin_id566   1.0115101  0.0891700    11.344  &lt; 2e-16 ***
destin_id567   3.2873898  0.0884274    37.176  &lt; 2e-16 ***
destin_id568  -3.0316433  0.2224061   -13.631  &lt; 2e-16 ***
destin_id588   0.7216395  0.0904798     7.976 1.52e-15 ***
destin_id589   1.2053028  0.0889431    13.551  &lt; 2e-16 ***
destin_id590   3.4905169  0.0883007    39.530  &lt; 2e-16 ***
destin_id591  -0.0954172  0.0928310    -1.028 0.304016    
destin_id592   0.3745555  0.0954435     3.924 8.70e-05 ***
destin_id593  -1.3909739  0.1657235    -8.393  &lt; 2e-16 ***
destin_id612  -0.3683080  0.0930989    -3.956 7.62e-05 ***
destin_id613  -1.3785679  0.0979448   -14.075  &lt; 2e-16 ***
destin_id614   3.2926168  0.0883127    37.284  &lt; 2e-16 ***
destin_id615   3.5328737  0.0883115    40.005  &lt; 2e-16 ***
destin_id617   1.2615130  0.0910338    13.858  &lt; 2e-16 ***
destin_id618  -2.1273814  1.0054669    -2.116 0.034361 *  
destin_id619   0.1639855  0.1054467     1.555 0.119910    
destin_id620   2.4858615  0.0940767    26.424  &lt; 2e-16 ***
destin_id636  -0.9596263  0.0948003   -10.123  &lt; 2e-16 ***
destin_id637   0.4270546  0.0916333     4.660 3.15e-06 ***
destin_id638   4.6625091  0.0882723    52.820  &lt; 2e-16 ***
destin_id639   2.6411554  0.0884706    29.853  &lt; 2e-16 ***
destin_id640  -1.3395927  0.1133794   -11.815  &lt; 2e-16 ***
destin_id642  -0.3153705  0.1319850    -2.389 0.016874 *  
destin_id643  -3.3701343  0.7129050    -4.727 2.27e-06 ***
destin_id644  -1.1764018  0.1246216    -9.440  &lt; 2e-16 ***
destin_id661   0.2064978  0.0918490     2.248 0.024561 *  
destin_id662   0.9497238  0.0887669    10.699  &lt; 2e-16 ***
destin_id663   3.4131188  0.0883109    38.649  &lt; 2e-16 ***
destin_id669  -0.3100801  0.1273847    -2.434 0.014925 *  
destin_id670   1.4525493  0.1035774    14.024  &lt; 2e-16 ***
destin_id684  -0.7231681  0.0948652    -7.623 2.48e-14 ***
destin_id685   0.0551191  0.0911791     0.605 0.545502    
destin_id686   1.9965616  0.0884296    22.578  &lt; 2e-16 ***
destin_id688  -2.9553108  0.2516889   -11.742  &lt; 2e-16 ***
destin_id693  -1.0941612  0.1708726    -6.403 1.52e-10 ***
destin_id710  -0.7169210  0.0934000    -7.676 1.64e-14 ***
destin_id711   3.8752086  0.0883068    43.883  &lt; 2e-16 ***
destin_id713   2.2791233  0.0892193    25.545  &lt; 2e-16 ***
destin_id732   0.7642915  0.0903036     8.464  &lt; 2e-16 ***
destin_id733   2.2761032  0.0884972    25.720  &lt; 2e-16 ***
destin_id734   3.4947619  0.0883336    39.563  &lt; 2e-16 ***
destin_id735   3.3594479  0.0885166    37.953  &lt; 2e-16 ***
destin_id756   0.9356336  0.0915426    10.221  &lt; 2e-16 ***
destin_id757  -0.2542073  0.0914063    -2.781 0.005418 ** 
destin_id758   3.5663929  0.0883254    40.378  &lt; 2e-16 ***
destin_id759   3.8618291  0.0883124    43.729  &lt; 2e-16 ***
destin_id761   3.5664894  0.0885496    40.277  &lt; 2e-16 ***
destin_id780  -0.0705468  0.0915937    -0.770 0.441172    
destin_id781   3.1188071  0.0883754    35.290  &lt; 2e-16 ***
destin_id782   1.0856608  0.0890297    12.194  &lt; 2e-16 ***
destin_id783   1.8936263  0.0891133    21.250  &lt; 2e-16 ***
destin_id804   0.0885825  0.0928334     0.954 0.339977    
destin_id807   3.4400777  0.0883430    38.940  &lt; 2e-16 ***
destin_id809  -0.3127217  0.0957404    -3.266 0.001089 ** 
destin_id828   2.4017135  0.0886589    27.089  &lt; 2e-16 ***
destin_id830   3.3167570  0.0883349    37.548  &lt; 2e-16 ***
destin_id831   2.0412421  0.0889040    22.960  &lt; 2e-16 ***
destin_id837  -0.4278079  0.1157844    -3.695 0.000220 ***
destin_id852  -1.0408054  0.1008229   -10.323  &lt; 2e-16 ***
destin_id853   3.4725205  0.0883778    39.292  &lt; 2e-16 ***
destin_id854   3.7731573  0.0883097    42.726  &lt; 2e-16 ***
destin_id855   2.6062117  0.0884393    29.469  &lt; 2e-16 ***
destin_id856   2.5638044  0.0886735    28.913  &lt; 2e-16 ***
destin_id857   4.2916830  0.0883352    48.584  &lt; 2e-16 ***
destin_id858   1.6342385  0.0892499    18.311  &lt; 2e-16 ***
destin_id875  -1.5285111  0.1222432   -12.504  &lt; 2e-16 ***
destin_id877   0.6914604  0.0890454     7.765 8.15e-15 ***
destin_id878   3.1169761  0.0883427    35.283  &lt; 2e-16 ***
destin_id879   3.9802325  0.0883676    45.042  &lt; 2e-16 ***
destin_id880   2.2250076  0.0888581    25.040  &lt; 2e-16 ***
destin_id881   4.5500317  0.0883131    51.522  &lt; 2e-16 ***
destin_id882   3.1319584  0.0885167    35.383  &lt; 2e-16 ***
destin_id885   2.4278165  0.0897099    27.063  &lt; 2e-16 ***
destin_id901   2.6493557  0.0883981    29.971  &lt; 2e-16 ***
destin_id902   2.9199759  0.0883627    33.045  &lt; 2e-16 ***
destin_id903   3.4396343  0.0883310    38.940  &lt; 2e-16 ***
destin_id904   3.3167725  0.0883768    37.530  &lt; 2e-16 ***
destin_id905   3.4597064  0.0883561    39.156  &lt; 2e-16 ***
destin_id906   2.8452182  0.0884649    32.162  &lt; 2e-16 ***
destin_id907   3.8350554  0.0884543    43.356  &lt; 2e-16 ***
destin_id909   0.2273794  0.0961150     2.366 0.017996 *  
destin_id923   1.0196458  0.0908965    11.218  &lt; 2e-16 ***
destin_id924   1.2855436  0.0890649    14.434  &lt; 2e-16 ***
destin_id925   1.3326569  0.0889378    14.984  &lt; 2e-16 ***
destin_id926   1.6326402  0.0887375    18.399  &lt; 2e-16 ***
destin_id927   2.8481286  0.0883784    32.227  &lt; 2e-16 ***
destin_id928   2.5891875  0.0884667    29.267  &lt; 2e-16 ***
destin_id929   3.2063379  0.0883823    36.278  &lt; 2e-16 ***
destin_id930   3.9774574  0.0884308    44.978  &lt; 2e-16 ***
destin_id931  -1.2042275  0.1208474    -9.965  &lt; 2e-16 ***
destin_id932   0.5939510  0.0938643     6.328 2.49e-10 ***
destin_id933   0.1533197  0.0985783     1.555 0.119873    
destin_id948  -2.4011593  0.1259359   -19.067  &lt; 2e-16 ***
destin_id949   2.3404125  0.0885107    26.442  &lt; 2e-16 ***
destin_id950   2.8276122  0.0885065    31.948  &lt; 2e-16 ***
destin_id951   3.9128232  0.0883103    44.308  &lt; 2e-16 ***
destin_id952   3.6530290  0.0884559    41.298  &lt; 2e-16 ***
destin_id953   2.8249342  0.0883982    31.957  &lt; 2e-16 ***
destin_id954   1.2801264  0.0890397    14.377  &lt; 2e-16 ***
destin_id955   3.2425944  0.0884089    36.677  &lt; 2e-16 ***
destin_id956   0.9327562  0.0899890    10.365  &lt; 2e-16 ***
destin_id957   0.2992929  0.0931689     3.212 0.001316 ** 
destin_id972   1.6937535  0.0885230    19.133  &lt; 2e-16 ***
destin_id973   0.3428601  0.0894410     3.833 0.000126 ***
destin_id974   3.0609050  0.0883850    34.632  &lt; 2e-16 ***
destin_id975   1.8927516  0.0886135    21.360  &lt; 2e-16 ***
destin_id976  -3.0244987  0.1866098   -16.208  &lt; 2e-16 ***
destin_id977   3.4292198  0.0883494    38.814  &lt; 2e-16 ***
destin_id978   0.9457743  0.0900082    10.508  &lt; 2e-16 ***
destin_id979   2.8863386  0.0885498    32.596  &lt; 2e-16 ***
destin_id980   2.8535566  0.0885073    32.241  &lt; 2e-16 ***
destin_id981   0.2713361  0.0957361     2.834 0.004594 ** 
destin_id996   2.5958712  0.0883696    29.375  &lt; 2e-16 ***
destin_id997   2.2641785  0.0884123    25.609  &lt; 2e-16 ***
destin_id998   1.3211068  0.0888093    14.876  &lt; 2e-16 ***
destin_id999   2.6772309  0.0883998    30.285  &lt; 2e-16 ***
destin_id1000  1.7598611  0.0888376    19.810  &lt; 2e-16 ***
destin_id1001  3.8729858  0.0883281    43.848  &lt; 2e-16 ***
destin_id1002  3.6569762  0.0884383    41.351  &lt; 2e-16 ***
destin_id1005  1.0214744  0.0898514    11.368  &lt; 2e-16 ***
destin_id1019  3.0425791  0.0883794    34.426  &lt; 2e-16 ***
destin_id1020  4.4395965  0.0882925    50.283  &lt; 2e-16 ***
destin_id1021  0.5659980  0.0908702     6.229 4.70e-10 ***
destin_id1022  1.1063689  0.0890613    12.423  &lt; 2e-16 ***
destin_id1023  2.7080959  0.0884326    30.623  &lt; 2e-16 ***
destin_id1024  1.0992170  0.0890999    12.337  &lt; 2e-16 ***
destin_id1025  3.9399574  0.0883249    44.608  &lt; 2e-16 ***
destin_id1027  0.6103282  0.0930766     6.557 5.48e-11 ***
destin_id1028  4.3203636  0.0884296    48.857  &lt; 2e-16 ***
destin_id1029  0.4652617  0.0910530     5.110 3.23e-07 ***
destin_id1043  2.2511007  0.0884328    25.455  &lt; 2e-16 ***
destin_id1044  2.8621291  0.0883300    32.403  &lt; 2e-16 ***
destin_id1045  2.1619277  0.0884194    24.451  &lt; 2e-16 ***
destin_id1046  1.1745468  0.0894618    13.129  &lt; 2e-16 ***
destin_id1047  1.7595985  0.0886260    19.854  &lt; 2e-16 ***
destin_id1048  2.6374490  0.0884823    29.808  &lt; 2e-16 ***
destin_id1049  3.6228889  0.0883455    41.008  &lt; 2e-16 ***
destin_id1050  4.2645141  0.0883907    48.246  &lt; 2e-16 ***
destin_id1053  2.0200646  0.0887931    22.750  &lt; 2e-16 ***
destin_id1054  5.3388248  0.0883152    60.452  &lt; 2e-16 ***
destin_id1066  1.4650857  0.0887223    16.513  &lt; 2e-16 ***
destin_id1067  1.3310293  0.0886974    15.006  &lt; 2e-16 ***
destin_id1068  1.3986691  0.0885592    15.794  &lt; 2e-16 ***
destin_id1069  2.0821359  0.0885179    23.522  &lt; 2e-16 ***
destin_id1070  3.3507004  0.0883505    37.925  &lt; 2e-16 ***
destin_id1072  2.9759302  0.0885693    33.600  &lt; 2e-16 ***
destin_id1073  3.7285181  0.0884275    42.165  &lt; 2e-16 ***
destin_id1075  0.4408297  0.0932244     4.729 2.26e-06 ***
destin_id1076  1.4593966  0.0899878    16.218  &lt; 2e-16 ***
destin_id1077  2.9918024  0.0884495    33.825  &lt; 2e-16 ***
destin_id1091 -1.5873542  0.1007744   -15.752  &lt; 2e-16 ***
destin_id1092  1.5001547  0.0886239    16.927  &lt; 2e-16 ***
destin_id1093  1.5558182  0.0886279    17.555  &lt; 2e-16 ***
destin_id1094  1.9870161  0.0884698    22.460  &lt; 2e-16 ***
destin_id1097  3.8663745  0.0883678    43.753  &lt; 2e-16 ***
destin_id1101  3.9192544  0.0883541    44.359  &lt; 2e-16 ***
destin_id1102  3.7287763  0.0883677    42.196  &lt; 2e-16 ***
destin_id1114  1.1119355  0.0887776    12.525  &lt; 2e-16 ***
destin_id1115  2.0903736  0.0884464    23.634  &lt; 2e-16 ***
destin_id1116  2.2404138  0.0885722    25.295  &lt; 2e-16 ***
destin_id1117  1.2495306  0.0895089    13.960  &lt; 2e-16 ***
destin_id1118  1.2715317  0.0890664    14.276  &lt; 2e-16 ***
destin_id1123  0.5754598  0.0928595     6.197 5.75e-10 ***
destin_id1125  3.1673837  0.0883673    35.843  &lt; 2e-16 ***
destin_id1126  0.0369235  0.0926901     0.398 0.690369    
destin_id1138  2.7291831  0.0883971    30.874  &lt; 2e-16 ***
destin_id1139  1.8601122  0.0884867    21.021  &lt; 2e-16 ***
destin_id1140  2.4542825  0.0884052    27.762  &lt; 2e-16 ***
destin_id1141  1.0857141  0.0890740    12.189  &lt; 2e-16 ***
destin_id1142  3.0359676  0.0883774    34.352  &lt; 2e-16 ***
destin_id1149  2.2623699  0.0885377    25.553  &lt; 2e-16 ***
destin_id1150  1.0703588  0.0890733    12.017  &lt; 2e-16 ***
destin_id1161  1.6081647  0.0886633    18.138  &lt; 2e-16 ***
destin_id1162 -0.0031485  0.0901613    -0.035 0.972143    
destin_id1163  0.2334100  0.0892349     2.616 0.008905 ** 
destin_id1164  1.2597237  0.0887451    14.195  &lt; 2e-16 ***
destin_id1171 -3.3603262  0.1763244   -19.058  &lt; 2e-16 ***
destin_id1172 -1.8066204  0.1237582   -14.598  &lt; 2e-16 ***
destin_id1173  5.2651191  0.0883069    59.623  &lt; 2e-16 ***
destin_id1174  2.9677479  0.0885137    33.529  &lt; 2e-16 ***
destin_id1187  0.2729554  0.0903141     3.022 0.002509 ** 
destin_id1188  3.1583837  0.0883304    35.756  &lt; 2e-16 ***
destin_id1189  1.3147327  0.0890135    14.770  &lt; 2e-16 ***
destin_id1190  1.1649195  0.0889428    13.097  &lt; 2e-16 ***
destin_id1195  2.0527243  0.0904865    22.685  &lt; 2e-16 ***
destin_id1197  3.0550001  0.0884220    34.550  &lt; 2e-16 ***
destin_id1198  3.2054132  0.0883670    36.274  &lt; 2e-16 ***
destin_id1199  1.1007823  0.0919289    11.974  &lt; 2e-16 ***
destin_id1209  0.5070698  0.0893678     5.674 1.40e-08 ***
destin_id1210 -0.1612928  0.0910503    -1.771 0.076483 .  
destin_id1211  2.8081988  0.0883610    31.781  &lt; 2e-16 ***
destin_id1212  1.7811810  0.0885713    20.110  &lt; 2e-16 ***
destin_id1213  1.9016767  0.0885701    21.471  &lt; 2e-16 ***
destin_id1220 -1.2942820  0.1123768   -11.517  &lt; 2e-16 ***
destin_id1221  3.4721629  0.0883487    39.301  &lt; 2e-16 ***
destin_id1222  2.0735783  0.0886385    23.394  &lt; 2e-16 ***
destin_id1234  0.7318519  0.0888200     8.240  &lt; 2e-16 ***
destin_id1235  1.1715543  0.0886192    13.220  &lt; 2e-16 ***
destin_id1236  1.8126446  0.0884910    20.484  &lt; 2e-16 ***
destin_id1244  0.6591371  0.0936545     7.038 1.95e-12 ***
destin_id1245  3.5363193  0.0884163    39.996  &lt; 2e-16 ***
destin_id1246  4.0950606  0.0883406    46.355  &lt; 2e-16 ***
destin_id1247  1.6052801  0.0889824    18.040  &lt; 2e-16 ***
destin_id1257  1.9448697  0.0884714    21.983  &lt; 2e-16 ***
destin_id1258  2.7377187  0.0883510    30.987  &lt; 2e-16 ***
destin_id1259  1.7640815  0.0884712    19.940  &lt; 2e-16 ***
destin_id1260  1.6744602  0.0886160    18.896  &lt; 2e-16 ***
destin_id1261  1.6623505  0.0886767    18.746  &lt; 2e-16 ***
destin_id1267 -1.7358001  0.1288323   -13.473  &lt; 2e-16 ***
destin_id1269  3.2700565  0.0884298    36.979  &lt; 2e-16 ***
destin_id1270  2.7980164  0.0884506    31.634  &lt; 2e-16 ***
destin_id1271  0.6621841  0.0906333     7.306 2.75e-13 ***
destin_id1282  1.5902250  0.0885113    17.966  &lt; 2e-16 ***
destin_id1283  2.7445383  0.0883556    31.062  &lt; 2e-16 ***
destin_id1284  1.1837212  0.0887931    13.331  &lt; 2e-16 ***
destin_id1285  1.9751558  0.0885217    22.313  &lt; 2e-16 ***
destin_id1291 -1.5045204  0.1190917   -12.633  &lt; 2e-16 ***
destin_id1292 -1.0695342  0.1444353    -7.405 1.31e-13 ***
destin_id1294  3.4035326  0.0883947    38.504  &lt; 2e-16 ***
destin_id1295 -0.0736591  0.0933497    -0.789 0.430073    
destin_id1305  2.4550704  0.0883715    27.781  &lt; 2e-16 ***
destin_id1306  2.1212305  0.0884103    23.993  &lt; 2e-16 ***
destin_id1307  0.7877764  0.0907706     8.679  &lt; 2e-16 ***
destin_id1309  1.5083536  0.0889562    16.956  &lt; 2e-16 ***
destin_id1318  1.8014146  0.0887870    20.289  &lt; 2e-16 ***
destin_id1319  2.2352226  0.0887437    25.187  &lt; 2e-16 ***
destin_id1329  2.1945275  0.0884184    24.820  &lt; 2e-16 ***
destin_id1330  2.2762693  0.0883734    25.757  &lt; 2e-16 ***
destin_id1331  1.3531629  0.0885491    15.281  &lt; 2e-16 ***
destin_id1332  0.8721058  0.0890171     9.797  &lt; 2e-16 ***
destin_id1333  1.5146630  0.0887107    17.074  &lt; 2e-16 ***
destin_id1334 -1.9143860  0.1447654   -13.224  &lt; 2e-16 ***
destin_id1338 -2.2620150  0.1379785   -16.394  &lt; 2e-16 ***
destin_id1339  1.9061099  0.0889714    21.424  &lt; 2e-16 ***
destin_id1342  2.7456281  0.0885051    31.022  &lt; 2e-16 ***
destin_id1343  3.4003369  0.0884326    38.451  &lt; 2e-16 ***
destin_id1353  2.4277654  0.0883874    27.467  &lt; 2e-16 ***
destin_id1354  2.7048294  0.0883407    30.618  &lt; 2e-16 ***
destin_id1355  0.1879053  0.0902226     2.083 0.037280 *  
destin_id1358 -1.1574430  0.1108126   -10.445  &lt; 2e-16 ***
destin_id1361 -2.7015000  0.1732762   -15.591  &lt; 2e-16 ***
destin_id1362  3.2074074  0.0884926    36.245  &lt; 2e-16 ***
destin_id1363  0.7711519  0.0902966     8.540  &lt; 2e-16 ***
destin_id1366  4.2439925  0.0883437    48.040  &lt; 2e-16 ***
destin_id1367  1.7477594  0.0891701    19.600  &lt; 2e-16 ***
destin_id1376  1.0615973  0.0909088    11.678  &lt; 2e-16 ***
destin_id1377  3.2368083  0.0883365    36.642  &lt; 2e-16 ***
destin_id1378  2.6437218  0.0883434    29.926  &lt; 2e-16 ***
destin_id1379  1.4852031  0.0885045    16.781  &lt; 2e-16 ***
destin_id1380  0.6222295  0.0889203     6.998 2.60e-12 ***
destin_id1381  2.4123747  0.0884139    27.285  &lt; 2e-16 ***
destin_id1382 -1.0254523  0.1090586    -9.403  &lt; 2e-16 ***
destin_id1386 -0.8303650  0.1095057    -7.583 3.38e-14 ***
destin_id1387  1.3563805  0.0907240    14.951  &lt; 2e-16 ***
destin_id1388 -0.6775393  0.0941967    -7.193 6.35e-13 ***
destin_id1389  2.4919954  0.0885257    28.150  &lt; 2e-16 ***
destin_id1390  2.7581676  0.0884900    31.169  &lt; 2e-16 ***
destin_id1391  1.9415883  0.0888578    21.851  &lt; 2e-16 ***
destin_id1401  2.4332834  0.0883743    27.534  &lt; 2e-16 ***
destin_id1402  2.9768945  0.0883277    33.703  &lt; 2e-16 ***
destin_id1403  1.1435490  0.0885613    12.913  &lt; 2e-16 ***
destin_id1404  1.4411345  0.0887203    16.244  &lt; 2e-16 ***
destin_id1405 -0.4532896  0.0949825    -4.772 1.82e-06 ***
destin_id1406 -3.0048845  0.2581228   -11.641  &lt; 2e-16 ***
destin_id1407  0.5002150  0.0897463     5.574 2.49e-08 ***
destin_id1408  1.1671587  0.0892294    13.080  &lt; 2e-16 ***
destin_id1409  1.4373823  0.0892944    16.097  &lt; 2e-16 ***
destin_id1410 -0.5122556  0.1060076    -4.832 1.35e-06 ***
destin_id1411 -0.4022244  0.0930480    -4.323 1.54e-05 ***
destin_id1412  2.2215457  0.0885346    25.092  &lt; 2e-16 ***
destin_id1413  2.6375078  0.0884871    29.807  &lt; 2e-16 ***
destin_id1414  3.2829890  0.0884184    37.130  &lt; 2e-16 ***
destin_id1425 -1.6171738  0.0994578   -16.260  &lt; 2e-16 ***
destin_id1426  1.6605507  0.0884556    18.773  &lt; 2e-16 ***
destin_id1427  1.7252727  0.0884190    19.512  &lt; 2e-16 ***
destin_id1428  2.3045665  0.0883804    26.076  &lt; 2e-16 ***
destin_id1429  1.1330675  0.0890336    12.726  &lt; 2e-16 ***
destin_id1432  2.2398197  0.0885067    25.307  &lt; 2e-16 ***
destin_id1433  1.7554571  0.0886841    19.794  &lt; 2e-16 ***
destin_id1434 -0.1742884  0.1065578    -1.636 0.101918    
destin_id1435 -1.4912779  0.1284287   -11.612  &lt; 2e-16 ***
destin_id1436  4.2616710  0.0883303    48.247  &lt; 2e-16 ***
destin_id1437  3.8104623  0.0883523    43.128  &lt; 2e-16 ***
destin_id1438  3.4241712  0.0884427    38.716  &lt; 2e-16 ***
destin_id1439  1.3852150  0.0898093    15.424  &lt; 2e-16 ***
destin_id1449  1.6689984  0.0884671    18.866  &lt; 2e-16 ***
destin_id1450  1.8855436  0.0883980    21.330  &lt; 2e-16 ***
destin_id1451  2.6374475  0.0883453    29.854  &lt; 2e-16 ***
destin_id1452  1.7299570  0.0884667    19.555  &lt; 2e-16 ***
destin_id1453  0.1793952  0.0896808     2.000 0.045460 *  
destin_id1454  1.5238593  0.0886098    17.197  &lt; 2e-16 ***
destin_id1455  2.4971698  0.0884331    28.238  &lt; 2e-16 ***
destin_id1456  2.7833441  0.0884103    31.482  &lt; 2e-16 ***
destin_id1457  2.0616648  0.0885454    23.284  &lt; 2e-16 ***
destin_id1458  1.1816222  0.0895717    13.192  &lt; 2e-16 ***
destin_id1459  1.1036640  0.0896337    12.313  &lt; 2e-16 ***
destin_id1460  3.2076550  0.0883624    36.301  &lt; 2e-16 ***
destin_id1461  3.0863677  0.0884062    34.911  &lt; 2e-16 ***
destin_id1462  3.3111832  0.0886103    37.368  &lt; 2e-16 ***
destin_id1463  2.9487510  0.0900201    32.757  &lt; 2e-16 ***
destin_id1474  2.5143549  0.0883493    28.459  &lt; 2e-16 ***
destin_id1475  1.5211614  0.0885461    17.179  &lt; 2e-16 ***
destin_id1477  1.4069198  0.0885780    15.883  &lt; 2e-16 ***
destin_id1478  0.6735517  0.0889543     7.572 3.68e-14 ***
destin_id1479  1.7289046  0.0885267    19.530  &lt; 2e-16 ***
destin_id1480  1.8422718  0.0885327    20.809  &lt; 2e-16 ***
destin_id1481  2.8858556  0.0883999    32.645  &lt; 2e-16 ***
destin_id1482  1.4380626  0.0888253    16.190  &lt; 2e-16 ***
destin_id1484  3.4465107  0.0883883    38.993  &lt; 2e-16 ***
destin_id1485  4.0216504  0.0883411    45.524  &lt; 2e-16 ***
destin_id1486  1.8312281  0.0893836    20.487  &lt; 2e-16 ***
destin_id1487  2.6940844  0.0905977    29.737  &lt; 2e-16 ***
destin_id1497  2.0915338  0.0884369    23.650  &lt; 2e-16 ***
destin_id1498  2.5374718  0.0883466    28.722  &lt; 2e-16 ***
destin_id1499  2.5485663  0.0883423    28.849  &lt; 2e-16 ***
destin_id1500  1.8132876  0.0884387    20.503  &lt; 2e-16 ***
destin_id1501  2.6399735  0.0883447    29.883  &lt; 2e-16 ***
destin_id1502  1.6907300  0.0885230    19.099  &lt; 2e-16 ***
destin_id1503  2.8517850  0.0883661    32.272  &lt; 2e-16 ***
destin_id1504  3.3051229  0.0883271    37.419  &lt; 2e-16 ***
destin_id1505  3.5418673  0.0883361    40.095  &lt; 2e-16 ***
destin_id1508  3.6833802  0.0883842    41.675  &lt; 2e-16 ***
destin_id1509  2.8768395  0.0886084    32.467  &lt; 2e-16 ***
destin_id1522  1.7965393  0.0884274    20.317  &lt; 2e-16 ***
destin_id1523  1.6570732  0.0884202    18.741  &lt; 2e-16 ***
destin_id1524  2.4231549  0.0883882    27.415  &lt; 2e-16 ***
destin_id1525  1.7169346  0.0885460    19.390  &lt; 2e-16 ***
destin_id1526  3.6536652  0.0883081    41.374  &lt; 2e-16 ***
destin_id1527  3.2399649  0.0883356    36.678  &lt; 2e-16 ***
destin_id1528  2.0487813  0.0884399    23.166  &lt; 2e-16 ***
destin_id1529  1.8675319  0.0884652    21.110  &lt; 2e-16 ***
destin_id1530  1.2536644  0.0890866    14.072  &lt; 2e-16 ***
destin_id1532  2.6995877  0.0886302    30.459  &lt; 2e-16 ***
destin_id1533  3.1193067  0.0884829    35.253  &lt; 2e-16 ***
destin_id1545  0.6640209  0.0890648     7.455 8.95e-14 ***
destin_id1546  1.8575521  0.0884009    21.013  &lt; 2e-16 ***
destin_id1547  2.3721413  0.0883489    26.850  &lt; 2e-16 ***
destin_id1548  1.9561709  0.0885181    22.099  &lt; 2e-16 ***
destin_id1549  2.3734062  0.0883622    26.860  &lt; 2e-16 ***
destin_id1550  2.6576977  0.0883502    30.081  &lt; 2e-16 ***
destin_id1551  1.4402134  0.0885419    16.266  &lt; 2e-16 ***
destin_id1552  3.9421287  0.0883093    44.640  &lt; 2e-16 ***
destin_id1556  2.8644707  0.0885630    32.344  &lt; 2e-16 ***
destin_id1570  1.3448085  0.0885671    15.184  &lt; 2e-16 ***
destin_id1571  2.5638658  0.0883414    29.022  &lt; 2e-16 ***
destin_id1572  2.5675165  0.0883497    29.061  &lt; 2e-16 ***
destin_id1573  2.7645873  0.0883527    31.290  &lt; 2e-16 ***
destin_id1574  3.1446753  0.0883413    35.597  &lt; 2e-16 ***
destin_id1575  2.7031913  0.0884499    30.562  &lt; 2e-16 ***
destin_id1576  2.9499951  0.0883447    33.392  &lt; 2e-16 ***
destin_id1577  2.5516708  0.0884082    28.862  &lt; 2e-16 ***
destin_id1578  1.7288321  0.0887763    19.474  &lt; 2e-16 ***
destin_id1581  1.4154886  0.0898363    15.756  &lt; 2e-16 ***
destin_id1593 -4.5580313  0.3448443   -13.218  &lt; 2e-16 ***
destin_id1594  0.7406540  0.0887915     8.341  &lt; 2e-16 ***
destin_id1595  2.5625361  0.0883442    29.006  &lt; 2e-16 ***
destin_id1596  2.5852879  0.0883486    29.262  &lt; 2e-16 ***
destin_id1597  2.6277717  0.0883465    29.744  &lt; 2e-16 ***
destin_id1598  2.2023607  0.0884193    24.908  &lt; 2e-16 ***
destin_id1599  0.7692246  0.0889010     8.653  &lt; 2e-16 ***
destin_id1600  3.0494555  0.0883428    34.518  &lt; 2e-16 ***
destin_id1603 -2.0478056  0.1453851   -14.085  &lt; 2e-16 ***
destin_id1618  1.8167740  0.0886688    20.489  &lt; 2e-16 ***
destin_id1619  0.4038911  0.0891675     4.530 5.91e-06 ***
destin_id1620  2.3721986  0.0883589    26.847  &lt; 2e-16 ***
destin_id1621  3.0050431  0.0883311    34.020  &lt; 2e-16 ***
destin_id1622  2.9544040  0.0884439    33.404  &lt; 2e-16 ***
destin_id1623  0.6071922  0.0891069     6.814 9.48e-12 ***
destin_id1624  2.2478163  0.0885062    25.397  &lt; 2e-16 ***
destin_id1625  0.4790839  0.0893769     5.360 8.31e-08 ***
destin_id1626  1.2319778  0.0892123    13.810  &lt; 2e-16 ***
destin_id1627 -0.7436632  0.1037207    -7.170 7.51e-13 ***
destin_id1628 -0.6345411  0.1044714    -6.074 1.25e-09 ***
destin_id1641 -1.7693549  0.1459873   -12.120  &lt; 2e-16 ***
destin_id1643  1.5475893  0.0885729    17.472  &lt; 2e-16 ***
destin_id1644  0.4140191  0.0890090     4.651 3.30e-06 ***
destin_id1645  2.5777228  0.0883517    29.176  &lt; 2e-16 ***
destin_id1646  0.4051741  0.0891072     4.547 5.44e-06 ***
destin_id1647  1.9507030  0.0884455    22.055  &lt; 2e-16 ***
destin_id1648  0.8515392  0.0889917     9.569  &lt; 2e-16 ***
destin_id1649  0.9118052  0.0892068    10.221  &lt; 2e-16 ***
destin_id1650 -0.1117696  0.1001587    -1.116 0.264454    
destin_id1651  0.1931594  0.0924213     2.090 0.036619 *  
destin_id1652 -0.9450133  0.1198981    -7.882 3.23e-15 ***
destin_id1666 -0.2020480  0.1053419    -1.918 0.055108 .  
destin_id1667  1.9739518  0.0891434    22.144  &lt; 2e-16 ***
destin_id1668  1.5145035  0.0884917    17.115  &lt; 2e-16 ***
destin_id1669  2.2774206  0.0883866    25.767  &lt; 2e-16 ***
destin_id1670  3.0557070  0.0883474    34.587  &lt; 2e-16 ***
destin_id1671  3.7599513  0.0883152    42.574  &lt; 2e-16 ***
destin_id1672  1.8432991  0.0885100    20.826  &lt; 2e-16 ***
destin_id1673  2.8651806  0.0883733    32.421  &lt; 2e-16 ***
destin_id1674  3.2901718  0.0883721    37.231  &lt; 2e-16 ***
destin_id1675  3.1880683  0.0884470    36.045  &lt; 2e-16 ***
destin_id1676 -0.3666669  0.1117880    -3.280 0.001038 ** 
destin_id1691  1.7243414  0.0895700    19.251  &lt; 2e-16 ***
destin_id1692  2.8985899  0.0883351    32.814  &lt; 2e-16 ***
destin_id1693  1.9028625  0.0884870    21.504  &lt; 2e-16 ***
destin_id1694  0.9156352  0.0886955    10.323  &lt; 2e-16 ***
destin_id1695  2.5941174  0.0883686    29.356  &lt; 2e-16 ***
destin_id1696  3.1036167  0.0883472    35.130  &lt; 2e-16 ***
destin_id1697  1.7179753  0.0885764    19.395  &lt; 2e-16 ***
destin_id1698  3.2656656  0.0884208    36.933  &lt; 2e-16 ***
destin_id1699 -1.0280955  0.1035086    -9.932  &lt; 2e-16 ***
destin_id1715  0.1591748  0.0924953     1.721 0.085270 .  
destin_id1716  2.1736471  0.0884195    24.583  &lt; 2e-16 ***
destin_id1717  1.6256235  0.0884916    18.370  &lt; 2e-16 ***
destin_id1718  2.1792486  0.0884431    24.640  &lt; 2e-16 ***
destin_id1719  2.4212851  0.0883867    27.394  &lt; 2e-16 ***
destin_id1721  3.6813257  0.0883216    41.681  &lt; 2e-16 ***
destin_id1722  3.2421977  0.0884142    36.671  &lt; 2e-16 ***
destin_id1739  2.0806361  0.0885220    23.504  &lt; 2e-16 ***
destin_id1740  2.9277496  0.0883385    33.142  &lt; 2e-16 ***
destin_id1741  2.0849541  0.0883974    23.586  &lt; 2e-16 ***
destin_id1742  1.8766844  0.0884885    21.208  &lt; 2e-16 ***
destin_id1743  2.2693403  0.0884455    25.658  &lt; 2e-16 ***
destin_id1744  2.8475449  0.0883745    32.221  &lt; 2e-16 ***
destin_id1745  2.9990606  0.0883865    33.931  &lt; 2e-16 ***
destin_id1746  2.4830357  0.0886643    28.005  &lt; 2e-16 ***
destin_id1764  2.8525756  0.0883625    32.283  &lt; 2e-16 ***
destin_id1765  2.0178124  0.0884413    22.815  &lt; 2e-16 ***
destin_id1766  2.0729071  0.0884116    23.446  &lt; 2e-16 ***
destin_id1767  1.9494372  0.0885599    22.013  &lt; 2e-16 ***
destin_id1768  2.9185409  0.0883770    33.024  &lt; 2e-16 ***
destin_id1769  3.4966051  0.0883289    39.586  &lt; 2e-16 ***
destin_id1770  2.9676788  0.0884245    33.562  &lt; 2e-16 ***
destin_id1787  1.9663627  0.0886549    22.180  &lt; 2e-16 ***
destin_id1788  2.8918414  0.0883392    32.736  &lt; 2e-16 ***
destin_id1789  2.3711239  0.0883675    26.833  &lt; 2e-16 ***
destin_id1790  0.2189118  0.0893789     2.449 0.014315 *  
destin_id1791  2.9812465  0.0883650    33.738  &lt; 2e-16 ***
destin_id1792  3.6014109  0.0883187    40.777  &lt; 2e-16 ***
destin_id1793  2.9353609  0.0883766    33.214  &lt; 2e-16 ***
destin_id1794  3.3230322  0.0883866    37.597  &lt; 2e-16 ***
destin_id1812  1.9060124  0.0884826    21.541  &lt; 2e-16 ***
destin_id1813  2.2260590  0.0883972    25.182  &lt; 2e-16 ***
destin_id1814  0.9937885  0.0887447    11.198  &lt; 2e-16 ***
destin_id1815  1.7336210  0.0886246    19.561  &lt; 2e-16 ***
destin_id1816  3.1062797  0.0883479    35.160  &lt; 2e-16 ***
destin_id1817  2.8981525  0.0883649    32.798  &lt; 2e-16 ***
destin_id1818  3.8188340  0.0883257    43.236  &lt; 2e-16 ***
destin_id1819  3.7147999  0.0883558    42.044  &lt; 2e-16 ***
destin_id1835  2.4933863  0.0884151    28.201  &lt; 2e-16 ***
destin_id1836  2.4808057  0.0883637    28.075  &lt; 2e-16 ***
destin_id1837  1.8090358  0.0884813    20.445  &lt; 2e-16 ***
destin_id1838 -0.1542081  0.0899298    -1.715 0.086389 .  
destin_id1839 -2.3703379  0.1166056   -20.328  &lt; 2e-16 ***
destin_id1840  2.7932019  0.0883963    31.599  &lt; 2e-16 ***
destin_id1841  2.6493836  0.0884031    29.969  &lt; 2e-16 ***
destin_id1842  3.0766431  0.0883600    34.819  &lt; 2e-16 ***
destin_id1843  2.6147923  0.0885578    29.526  &lt; 2e-16 ***
destin_id1860  2.5309391  0.0884104    28.627  &lt; 2e-16 ***
destin_id1861  2.4196625  0.0883751    27.379  &lt; 2e-16 ***
destin_id1862  1.9762802  0.0884255    22.350  &lt; 2e-16 ***
destin_id1863  0.3553802  0.0926551     3.836 0.000125 ***
destin_id1864 -0.4846202  0.0927047    -5.228 1.72e-07 ***
destin_id1865  3.5200944  0.0883603    39.838  &lt; 2e-16 ***
destin_id1866  3.1903262  0.0883525    36.109  &lt; 2e-16 ***
destin_id1867  3.6765823  0.0883440    41.617  &lt; 2e-16 ***
destin_id1868  2.6396884  0.0893880    29.531  &lt; 2e-16 ***
destin_id1883  2.9875030  0.0883734    33.805  &lt; 2e-16 ***
destin_id1884  1.8576325  0.0884509    21.002  &lt; 2e-16 ***
destin_id1885  2.6964341  0.0883501    30.520  &lt; 2e-16 ***
destin_id1889  2.2520370  0.0887066    25.387  &lt; 2e-16 ***
destin_id1890  4.5033442  0.0883114    50.994  &lt; 2e-16 ***
destin_id1891  1.3366108  0.0896241    14.914  &lt; 2e-16 ***
destin_id1908  2.4711656  0.0883896    27.958  &lt; 2e-16 ***
destin_id1909  2.1821203  0.0883990    24.685  &lt; 2e-16 ***
destin_id1910  2.9335171  0.0883561    33.201  &lt; 2e-16 ***
destin_id1912 -0.9673788  0.1006267    -9.614  &lt; 2e-16 ***
destin_id1913 -1.8746068  0.1565376   -11.975  &lt; 2e-16 ***
destin_id1914  3.0682381  0.0884337    34.695  &lt; 2e-16 ***
destin_id1915  3.2348733  0.0883848    36.600  &lt; 2e-16 ***
destin_id1916  1.9281779  0.0910486    21.177  &lt; 2e-16 ***
destin_id1931  2.3090396  0.0885070    26.089  &lt; 2e-16 ***
destin_id1932  0.7970327  0.0889888     8.957  &lt; 2e-16 ***
destin_id1933  1.9372450  0.0885635    21.874  &lt; 2e-16 ***
destin_id1934 -0.5832821  0.0934898    -6.239 4.40e-10 ***
destin_id1936 -0.0983773  0.0944956    -1.041 0.297839    
destin_id1937 -2.8557699  0.3644258    -7.836 4.64e-15 ***
destin_id1938  3.1519531  0.0884064    35.653  &lt; 2e-16 ***
destin_id1939  3.5129244  0.0887814    39.568  &lt; 2e-16 ***
destin_id1956  2.6813489  0.0883928    30.334  &lt; 2e-16 ***
destin_id1957  2.1893916  0.0884411    24.755  &lt; 2e-16 ***
destin_id1958  2.8315978  0.0883710    32.042  &lt; 2e-16 ***
destin_id1961 -0.3899758  0.0943187    -4.135 3.55e-05 ***
destin_id1963  2.8116496  0.0886881    31.703  &lt; 2e-16 ***
destin_id1980  1.5255316  0.0886175    17.215  &lt; 2e-16 ***
destin_id1981  2.6942161  0.0883850    30.483  &lt; 2e-16 ***
destin_id1984 -2.3663262  0.1214598   -19.482  &lt; 2e-16 ***
destin_id1985 -1.5170766  0.1272946   -11.918  &lt; 2e-16 ***
destin_id1986  2.9767427  0.0887246    33.550  &lt; 2e-16 ***
destin_id2004  2.1828297  0.0884986    24.665  &lt; 2e-16 ***
destin_id2005  2.5461160  0.0883717    28.811  &lt; 2e-16 ***
destin_id2006  2.6564648  0.0883928    30.053  &lt; 2e-16 ***
destin_id2007  2.5690592  0.0884725    29.038  &lt; 2e-16 ***
destin_id2009  0.5505438  0.0943050     5.838 5.29e-09 ***
destin_id2028  1.6577109  0.0886024    18.710  &lt; 2e-16 ***
destin_id2029  3.4451789  0.0883220    39.007  &lt; 2e-16 ***
destin_id2030  1.5345289  0.0887376    17.293  &lt; 2e-16 ***
destin_id2031  2.4565226  0.0884427    27.775  &lt; 2e-16 ***
destin_id2032  1.6856457  0.0886064    19.024  &lt; 2e-16 ***
destin_id2052  1.7772603  0.0886657    20.045  &lt; 2e-16 ***
destin_id2053  3.3654011  0.0883301    38.100  &lt; 2e-16 ***
destin_id2054  2.9361765  0.0883518    33.233  &lt; 2e-16 ***
destin_id2055  3.1458599  0.0883531    35.606  &lt; 2e-16 ***
destin_id2056  2.7110616  0.0883894    30.672  &lt; 2e-16 ***
destin_id2057  2.7826343  0.0884102    31.474  &lt; 2e-16 ***
destin_id2076  1.9248009  0.0884996    21.749  &lt; 2e-16 ***
destin_id2077  2.8402602  0.0883506    32.148  &lt; 2e-16 ***
destin_id2078  1.0164465  0.0887030    11.459  &lt; 2e-16 ***
destin_id2079  2.6925582  0.0883670    30.470  &lt; 2e-16 ***
destin_id2080  0.8779084  0.0891514     9.847  &lt; 2e-16 ***
destin_id2081  3.0848642  0.0883861    34.902  &lt; 2e-16 ***
destin_id2101  2.6090035  0.0883875    29.518  &lt; 2e-16 ***
destin_id2102  2.9695031  0.0884300    33.580  &lt; 2e-16 ***
destin_id2103  2.6681825  0.0883495    30.200  &lt; 2e-16 ***
destin_id2104  2.5693257  0.0883784    29.072  &lt; 2e-16 ***
destin_id2105  3.0803506  0.0883632    34.860  &lt; 2e-16 ***
destin_id2124  2.4966527  0.0884554    28.225  &lt; 2e-16 ***
destin_id2125  3.2269620  0.0883431    36.528  &lt; 2e-16 ***
destin_id2127  4.2157513  0.0883063    47.740  &lt; 2e-16 ***
destin_id2128  2.0230824  0.0885960    22.835  &lt; 2e-16 ***
destin_id2129  1.8580323  0.0886009    20.971  &lt; 2e-16 ***
destin_id2149  2.1665319  0.0886105    24.450  &lt; 2e-16 ***
destin_id2150  1.7415480  0.0885158    19.675  &lt; 2e-16 ***
destin_id2151  2.2041794  0.0883910    24.937  &lt; 2e-16 ***
destin_id2152  1.5932249  0.0885864    17.985  &lt; 2e-16 ***
destin_id2153  3.5975686  0.0883350    40.726  &lt; 2e-16 ***
destin_id2172  0.5840105  0.0897000     6.511 7.48e-11 ***
destin_id2173  1.1078988  0.0887514    12.483  &lt; 2e-16 ***
destin_id2174  2.6311308  0.0883851    29.769  &lt; 2e-16 ***
destin_id2175  3.1122896  0.0883316    35.234  &lt; 2e-16 ***
destin_id2176  2.3719746  0.0884269    26.824  &lt; 2e-16 ***
destin_id2197  1.9945577  0.0888186    22.457  &lt; 2e-16 ***
destin_id2198  0.4097929  0.0891913     4.595 4.34e-06 ***
destin_id2199  2.4876840  0.0883823    28.147  &lt; 2e-16 ***
destin_id2200  2.8462184  0.0883605    32.211  &lt; 2e-16 ***
destin_id2201  2.8368302  0.0883910    32.094  &lt; 2e-16 ***
destin_id2221  0.1448344  0.0904061     1.602 0.109146    
destin_id2222  2.1300669  0.0884523    24.082  &lt; 2e-16 ***
destin_id2223  3.1131489  0.0883436    35.239  &lt; 2e-16 ***
destin_id2224  3.0504566  0.0883589    34.523  &lt; 2e-16 ***
destin_id2246  1.8030514  0.0887496    20.316  &lt; 2e-16 ***
destin_id2247  1.0525029  0.0889188    11.837  &lt; 2e-16 ***
destin_id2248  2.7034803  0.0883799    30.589  &lt; 2e-16 ***
destin_id2249  2.1543493  0.0885258    24.336  &lt; 2e-16 ***
destin_id2269 -1.1051070  0.0982057   -11.253  &lt; 2e-16 ***
destin_id2270 -1.2979033  0.0978386   -13.266  &lt; 2e-16 ***
destin_id2271  2.5637111  0.0884586    28.982  &lt; 2e-16 ***
destin_id2272  2.0520887  0.0885311    23.179  &lt; 2e-16 ***
destin_id2294 -0.6089178  0.0952789    -6.391 1.65e-10 ***
destin_id2295  0.7628735  0.0908201     8.400  &lt; 2e-16 ***
destin_id2296  0.9166159  0.0891991    10.276  &lt; 2e-16 ***
destin_id2297  1.2711633  0.0889759    14.287  &lt; 2e-16 ***
destin_id2319 -0.1020082  0.0928392    -1.099 0.271872    
destin_id2320  1.6591178  0.0891660    18.607  &lt; 2e-16 ***
destin_id2321 -0.5652113  0.0929870    -6.078 1.21e-09 ***
destin_id2345 -0.2034110  0.0908081    -2.240 0.025090 *  
destin_id2346  0.3297057  0.0901581     3.657 0.000255 ***
destin_id2366  2.1409260  0.0887927    24.112  &lt; 2e-16 ***
destin_id2368 -1.0460156  0.1049185    -9.970  &lt; 2e-16 ***
destin_id2391 -0.2755317  0.0912790    -3.019 0.002540 ** 
destin_id2392  2.5854552  0.0885551    29.196  &lt; 2e-16 ***
destin_id2394  2.2032592  0.0886295    24.859  &lt; 2e-16 ***
destin_id2412  3.2557670  0.0895400    36.361  &lt; 2e-16 ***
destin_id2415  2.7469945  0.0885368    31.027  &lt; 2e-16 ***
destin_id2441  1.0614068  0.0895793    11.849  &lt; 2e-16 ***
destin_id2442 -0.9103832  0.0938169    -9.704  &lt; 2e-16 ***
destin_id2460  1.4347007  0.0914317    15.692  &lt; 2e-16 ***
destin_id2465  0.9083612  0.0891861    10.185  &lt; 2e-16 ***
destin_id2489 -0.8971705  0.0937404    -9.571  &lt; 2e-16 ***
destin_id2512 -3.1857892  0.1909109   -16.687  &lt; 2e-16 ***
destin_id2556  0.5564657  0.1067284     5.214 1.85e-07 ***
log(dist)     -1.7233356  0.0003027 -5693.110  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 88281028  on 49889  degrees of freedom
Residual deviance: 19594475  on 48617  degrees of freedom
AIC: 19882665

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calc_Rsquared</span>(dbcSIM<span class="sc">$</span>data<span class="sc">$</span>trips, dbcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6595686</code></pre>
</div>
</div>
<p>From the results above, we can observe that dist is significant at alpha of 0.05. However, it is also observed from this model that some hexagon grids are not statistically significant at alpha of 0.05, unlike that of the previous three models. Furthermore, from the R-squared function, we can see that the model accounts for almost 66% of the variation of flows in the system, and this is the highest R-squared score obtained from all four models.</p>
</section>
<section id="model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison">6.6. Model Comparison</h2>
<p>To validate the observations from the R-squared scores, we use the the <code>compare_performance()</code> function from the <code>performance</code> package to meausre the Root Mean Squared Error (RMSE) of each model. The model with the lowest RMSE is the best performing model based on <code>SIM_data</code>.</p>
<p>Firstly, we will create a list of all models ran previously called <code>model_list</code> by using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">unconstrained =</span> uncSIM,</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">originConstrained =</span> orcSIM,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destinConstrained =</span> decSIM,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doublyConstrained =</span> dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will compute the RMSE of all models in the model_list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name              | Model |     RMSE
------------------------------------
unconstrained     |   glm | 1668.600
originConstrained |   glm | 1429.167
destinConstrained |   glm | 1521.038
doublyConstrained |   glm | 1170.515</code></pre>
</div>
</div>
<p>Based on the results above, the doubly constrained model returned the lowest RMSE score, which confirms the observations based on the R-squared values the doubly constrained model is most suitable to explain the variations of flow in the system.</p>
<p>The results suggest that perhaps distance is a key explanatory variable to commuter flows in Singapore. This could be because the attractiveness and propulsiveness variables can be found across the country due to Singapore’s land use planning strategies.</p>
</section>
<section id="visuslising-fitted-values" class="level2">
<h2 class="anchored" data-anchor-id="visuslising-fitted-values">6.7. Visuslising Fitted Values</h2>
<p>Finally, we will visualise the observed and fitted values. First, we will extract the fitted values from the Unconstrained SIM using the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will join the values to SIM_data dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> <span class="st">"uncSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will repeat the same steps for:</p>
<p>Origin Constrained SIM</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> <span class="st">"orcSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Destination Constrained SIM</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decTRIPS =</span> <span class="st">"decSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Doubly Constrained SIM</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally, we will plot the fitted values from each model:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>unc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> uncTRIPS,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> trips)) <span class="sc">+</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> trips)) <span class="sc">+</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>dec_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> decTRIPS,</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> trips)) <span class="sc">+</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> trips)) <span class="sc">+</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(unc_p, orc_p, dec_p, dbc_p,</span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take_home_Ex02_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the unconstrained graph, we can observe that there is a weak linear relationship as there are many points that are further away and does not follow closely to the linear regression line.</p>
<p>For the single constrained graphs using origin, the linear relationship appears slightly stronger where more points are observed closer to the linear regression line. Most of the observations can be found closely gathered where trips is less than 30000, and the points appear to become more scattered as the trips increase.</p>
<p>For the destination constrained graph, the linear relationship appears to be slightly weaker than that of the origin constrained graph. Most of the observations are closely cluttered where trips are less than 20000, and the points appear to be more scattered as the trips increase beyond 20000.</p>
<p>Lastly, for the doubly constrained graph, the linear relationship appears to be the strongest of all four models. Most of the points follow closely to the linear regression line.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>https://tablebuilder.singstat.gov.sg/table/TS/M810371<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>